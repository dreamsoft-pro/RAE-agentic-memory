🔧 RAE – Path Portability Refactor (Instructions for Gemini)
Goal
Refactor the entire RAE codebase so that it does not contain any hardcoded absolute filesystem paths, especially paths like:
/home/grzegorz-lesniowski/cloud/RAE-agentic-memory
After this refactor, the project must run correctly on any machine, in Docker, and in CI, without modifying the source code.

Core Rule (Non-Negotiable)
No absolute filesystem paths are allowed anywhere in the codebase.
All paths must be:
    • relative to a single PROJECT_ROOT
    • resolved dynamically at runtime
    • configurable via environment variables

Required Architecture
1. Single Source of Truth for Paths
Create a new module:
core/paths.py
with the following responsibilities:
    • Determine PROJECT_ROOT
    • Define all logical directories used by the system
    • Ensure directories exist at runtime
Required implementation pattern (example):
from pathlib import Path
import os

DEFAULT_ROOT = Path(__file__).resolve().parents[2]

PROJECT_ROOT = Path(
    os.getenv("RAE_PROJECT_ROOT", DEFAULT_ROOT)
).resolve()

DATA_DIR = PROJECT_ROOT / "data"
MEMORY_DIR = DATA_DIR / "memory"
CACHE_DIR = DATA_DIR / "cache"
LOGS_DIR = DATA_DIR / "logs"

for directory in (DATA_DIR, MEMORY_DIR, CACHE_DIR, LOGS_DIR):
    directory.mkdir(parents=True, exist_ok=True)
⚠️ Do NOT hardcode parents[n] blindly.
Verify correct project root depth.

2. Mandatory Usage Across Codebase
All filesystem access MUST:
    • import paths from core.paths
    • use pathlib.Path
    • avoid string concatenation for paths
❌ Forbidden:
"/home/username/project/data/file.json"
os.path.join("/home", "user", ...)
✅ Required:
from core.paths import MEMORY_DIR

file_path = MEMORY_DIR / "episodic.json"

3. Environment Variable Support
The following environment variable must be supported everywhere:
RAE_PROJECT_ROOT
This enables:
    • Docker compatibility
    • CI compatibility
    • local overrides without code changes

Refactor Scope
You MUST:
    1. Search the entire repository for:
    1. /home/
       /Users/
       C:\
       cloud/RAE-agentic-memory
    2. Remove or replace every occurrence.
    3. Refactor ALL file operations to use core.paths.
    4. Ensure no regressions in functionality.

Docker Compatibility Requirement
The code MUST work correctly with:
volumes:
  - .:/app
environment:
  - RAE_PROJECT_ROOT=/app
No code changes should be required for Docker execution.

Validation Checklist (Must Pass)
Before finishing, ensure:
    • 
    • No absolute paths exist in the repository
    • Project runs on a clean clone in a different directory
    • Project runs when RAE_PROJECT_ROOT is set
    • Project runs without RAE_PROJECT_ROOT set
    • All directories are auto-created if missing
    • Uses pathlib, not os.path directly

Documentation Update
Add a short section to README.md:
## Filesystem Portability

RAE does not rely on hardcoded filesystem paths.
All paths are resolved relative to PROJECT_ROOT and can be overridden
using the RAE_PROJECT_ROOT environment variable.

Important Constraints
    • Do NOT change business logic.
    • Do NOT rename existing files unless required.
    • Do NOT introduce new dependencies.
    • Prefer minimal, mechanical refactors.

Definition of Done
The refactor is complete when:
A fresh clone of the repository can be run from ANY directory
on ANY machine without modifying the source code.

Final Note
This refactor is critical for:
    • open-source adoption
    • scientific reproducibility
    • CI/CD
    • multi-user environments
Treat this as a blocking architectural fix, not a cosmetic change.

📌 This document is the ONLY instruction Gemini should follow.

