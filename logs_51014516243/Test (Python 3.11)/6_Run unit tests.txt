2025-11-28T17:39:43.2353627Z ##[group]Run pytest -m "not integration" --cov --cov-report=xml --cov-report=term
2025-11-28T17:39:43.2354190Z [36;1mpytest -m "not integration" --cov --cov-report=xml --cov-report=term[0m
2025-11-28T17:39:43.2386840Z shell: /usr/bin/bash -e {0}
2025-11-28T17:39:43.2387072Z env:
2025-11-28T17:39:43.2387309Z   pythonLocation: /opt/hostedtoolcache/Python/3.11.14/x64
2025-11-28T17:39:43.2387727Z   PKG_CONFIG_PATH: /opt/hostedtoolcache/Python/3.11.14/x64/lib/pkgconfig
2025-11-28T17:39:43.2388120Z   Python_ROOT_DIR: /opt/hostedtoolcache/Python/3.11.14/x64
2025-11-28T17:39:43.2388459Z   Python2_ROOT_DIR: /opt/hostedtoolcache/Python/3.11.14/x64
2025-11-28T17:39:43.2388802Z   Python3_ROOT_DIR: /opt/hostedtoolcache/Python/3.11.14/x64
2025-11-28T17:39:43.2389324Z   LD_LIBRARY_PATH: /opt/hostedtoolcache/Python/3.11.14/x64/lib
2025-11-28T17:39:43.2389932Z   DATABASE_URL: ***localhost:5432/test_rae
2025-11-28T17:39:43.2390215Z   REDIS_URL: redis://localhost:6379/0
2025-11-28T17:39:43.2390480Z   QDRANT_URL: http://localhost:6333
2025-11-28T17:39:43.2390747Z   RAE_VECTOR_BACKEND: qdrant
2025-11-28T17:39:43.2390948Z ##[endgroup]
2025-11-28T17:39:52.4927089Z [1m============================= test session starts ==============================[0m
2025-11-28T17:39:52.4928151Z platform linux -- Python 3.11.14, pytest-9.0.1, pluggy-1.6.0 -- /opt/hostedtoolcache/Python/3.11.14/x64/bin/python
2025-11-28T17:39:52.4928963Z cachedir: .pytest_cache
2025-11-28T17:39:52.4929692Z rootdir: /home/runner/work/RAE-agentic-memory/RAE-agentic-memory
2025-11-28T17:39:52.4930275Z configfile: pytest.ini
2025-11-28T17:39:52.4931006Z testpaths: apps/memory_api/tests, integrations/context-watcher/tests, tests, test_enterprise_features.py
2025-11-28T17:39:52.4931944Z plugins: anyio-4.11.0, cov-7.0.0, asyncio-1.3.0, mock-3.15.1
2025-11-28T17:39:52.4932947Z asyncio: mode=Mode.AUTO, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
2025-11-28T17:39:53.7489719Z [1mcollecting ... [0mcollected 276 items / 11 deselected / 7 skipped / 265 selected
2025-11-28T17:39:53.7490423Z 
2025-11-28T17:39:53.7612311Z apps/memory_api/tests/test_analytics.py::test_get_tenant_stats_cached [32mPASSED[0m[33m [  0%][0m
2025-11-28T17:39:53.7788029Z apps/memory_api/tests/test_analytics.py::test_get_tenant_stats_uncached [32mPASSED[0m[33m [  0%][0m
2025-11-28T17:39:53.7866931Z apps/memory_api/tests/test_analytics.py::test_get_memory_stats [32mPASSED[0m[33m    [  1%][0m
2025-11-28T17:39:53.7949895Z apps/memory_api/tests/test_analytics.py::test_get_query_stats [32mPASSED[0m[33m     [  1%][0m
2025-11-28T17:39:53.8043999Z apps/memory_api/tests/test_analytics.py::test_get_graph_stats [32mPASSED[0m[33m     [  1%][0m
2025-11-28T17:39:53.8122311Z apps/memory_api/tests/test_analytics.py::test_get_reflection_stats [32mPASSED[0m[33m [  2%][0m
2025-11-28T17:39:53.8205835Z apps/memory_api/tests/test_analytics.py::test_get_api_usage_stats [32mPASSED[0m[33m [  2%][0m
2025-11-28T17:39:53.8284212Z apps/memory_api/tests/test_analytics.py::test_get_performance_stats [32mPASSED[0m[33m [  3%][0m
2025-11-28T17:39:53.8362712Z apps/memory_api/tests/test_analytics.py::test_get_cost_stats [32mPASSED[0m[33m      [  3%][0m
2025-11-28T17:39:53.8451700Z apps/memory_api/tests/test_analytics.py::test_calculate_graph_density [32mPASSED[0m[33m [  3%][0m
2025-11-28T17:39:53.8539935Z apps/memory_api/tests/test_analytics.py::test_cache_operations [32mPASSED[0m[33m    [  4%][0m
2025-11-28T17:39:53.8627665Z apps/memory_api/tests/test_analytics.py::test_generate_report [32mPASSED[0m[33m     [  4%][0m
2025-11-28T17:39:53.8705849Z apps/memory_api/tests/test_analytics.py::test_get_real_time_metrics [32mPASSED[0m[33m [  4%][0m
2025-11-28T17:39:53.8784730Z apps/memory_api/tests/test_analytics.py::test_get_usage_alerts [32mPASSED[0m[33m    [  5%][0m
2025-11-28T17:39:53.8863905Z apps/memory_api/tests/test_analytics.py::test_mock_db_methods [32mPASSED[0m[33m     [  5%][0m
2025-11-28T17:39:53.8878148Z apps/memory_api/tests/test_api_client.py::test_classify_network_error [32mPASSED[0m[33m [  6%][0m
2025-11-28T17:39:53.8892481Z apps/memory_api/tests/test_api_client.py::test_classify_timeout_error [32mPASSED[0m[33m [  6%][0m
2025-11-28T17:39:53.8906106Z apps/memory_api/tests/test_api_client.py::test_classify_rate_limit [32mPASSED[0m[33m [  6%][0m
2025-11-28T17:39:53.8919983Z apps/memory_api/tests/test_api_client.py::test_classify_authentication_error [32mPASSED[0m[33m [  7%][0m
2025-11-28T17:39:53.8950806Z apps/memory_api/tests/test_api_client.py::test_circuit_breaker_closed_success [32mPASSED[0m[33m [  7%][0m
2025-11-28T17:39:53.8983564Z apps/memory_api/tests/test_api_client.py::test_circuit_breaker_opens_on_failures [32mPASSED[0m[33m [  7%][0m
2025-11-28T17:39:53.9010806Z apps/memory_api/tests/test_api_client.py::test_circuit_breaker_rejects_when_open [32mPASSED[0m[33m [  8%][0m
2025-11-28T17:39:53.9044243Z apps/memory_api/tests/test_api_client.py::test_circuit_breaker_half_open_recovery [32mPASSED[0m[33m [  8%][0m
2025-11-28T17:39:53.9062853Z apps/memory_api/tests/test_api_client.py::test_cache_set_and_get [32mPASSED[0m[33m  [  9%][0m
2025-11-28T17:39:53.9080162Z apps/memory_api/tests/test_api_client.py::test_cache_miss [32mPASSED[0m[33m         [  9%][0m
2025-11-28T17:39:55.1106268Z apps/memory_api/tests/test_api_client.py::test_cache_expiration [32mPASSED[0m[33m   [  9%][0m
2025-11-28T17:39:55.1134193Z apps/memory_api/tests/test_api_client.py::test_cache_invalidation [32mPASSED[0m[33m [ 10%][0m
2025-11-28T17:39:55.1145025Z apps/memory_api/tests/test_api_client.py::test_cache_clear [32mPASSED[0m[33m        [ 10%][0m
2025-11-28T17:39:55.4430153Z apps/memory_api/tests/test_api_client.py::test_retry_on_network_error [32mPASSED[0m[33m [ 10%][0m
2025-11-28T17:39:56.1737422Z apps/memory_api/tests/test_api_client.py::test_retry_exhausted [32mPASSED[0m[33m    [ 11%][0m
2025-11-28T17:39:56.2005059Z apps/memory_api/tests/test_api_client.py::test_no_retry_on_client_error [32mPASSED[0m[33m [ 11%][0m
2025-11-28T17:39:56.2025719Z apps/memory_api/tests/test_api_client.py::test_exponential_backoff [32mPASSED[0m[33m [ 12%][0m
2025-11-28T17:39:56.2299619Z apps/memory_api/tests/test_api_client.py::test_get_request [32mPASSED[0m[33m        [ 12%][0m
2025-11-28T17:39:56.2598914Z apps/memory_api/tests/test_api_client.py::test_post_request [32mPASSED[0m[33m       [ 12%][0m
2025-11-28T17:39:56.2845316Z apps/memory_api/tests/test_api_client.py::test_client_statistics [32mPASSED[0m[33m  [ 13%][0m
2025-11-28T17:39:56.3091970Z apps/memory_api/tests/test_api_client.py::test_reset_statistics [32mPASSED[0m[33m   [ 13%][0m
2025-11-28T17:39:56.3104504Z apps/memory_api/tests/test_api_e2e.py::TestMemoryAPISmoke::test_store_and_query_memory_e2e [33mSKIPPED[0m[33m [ 13%][0m
2025-11-28T17:39:56.3115789Z apps/memory_api/tests/test_api_e2e.py::TestMemoryAPISmoke::test_hybrid_search_e2e [33mSKIPPED[0m[33m [ 14%][0m
2025-11-28T17:39:56.3126459Z apps/memory_api/tests/test_api_e2e.py::TestHealthCheckSmoke::test_health_check [33mSKIPPED[0m[33m [ 14%][0m
2025-11-28T17:39:56.3795392Z apps/memory_api/tests/test_api_e2e.py::TestAPIErrorHandling::test_missing_tenant_header [32mPASSED[0m[33m [ 15%][0m
2025-11-28T17:39:56.3848006Z apps/memory_api/tests/test_api_e2e.py::TestAPIErrorHandling::test_invalid_json [32mPASSED[0m[33m [ 15%][0m
2025-11-28T17:39:57.7248586Z apps/memory_api/tests/test_background_tasks.py::TestExtractGraphLazy::test_extract_graph_success [32mPASSED[0m[33m [ 15%][0m
2025-11-28T17:39:58.3423781Z apps/memory_api/tests/test_background_tasks.py::TestExtractGraphLazy::test_extract_graph_with_mini_model [32mPASSED[0m[33m [ 16%][0m
2025-11-28T17:39:58.3509362Z apps/memory_api/tests/test_background_tasks.py::TestExtractGraphLazy::test_extract_graph_exception_handling [32mPASSED[0m[33m [ 16%][0m
2025-11-28T17:40:00.3230459Z apps/memory_api/tests/test_background_tasks.py::TestExtractGraphLazy::test_extract_graph_pool_cleanup [32mPASSED[0m[33m [ 16%][0m
2025-11-28T17:40:00.3305210Z apps/memory_api/tests/test_background_tasks.py::TestProcessGraphExtractionQueue::test_queue_processor_schedules_tasks [32mPASSED[0m[33m [ 17%][0m
2025-11-28T17:40:00.3370347Z apps/memory_api/tests/test_background_tasks.py::TestProcessGraphExtractionQueue::test_queue_processor_no_pending_memories [32mPASSED[0m[33m [ 17%][0m
2025-11-28T17:40:00.3445397Z apps/memory_api/tests/test_background_tasks.py::TestGenerateReflection::test_generate_reflection_calls_engine [32mPASSED[0m[33m [ 18%][0m
2025-11-28T17:40:00.3537267Z apps/memory_api/tests/test_background_tasks.py::TestMemoryDecay::test_apply_decay_updates_strength [32mPASSED[0m[33m [ 18%][0m
2025-11-28T17:40:00.3613975Z apps/memory_api/tests/test_background_tasks.py::TestPruneOldMemories::test_prune_respects_retention_days [32mPASSED[0m[33m [ 18%][0m
2025-11-28T17:40:00.3644096Z apps/memory_api/tests/test_background_tasks.py::TestPruneOldMemories::test_prune_disabled_when_retention_zero [32mPASSED[0m[33m [ 19%][0m
2025-11-28T17:40:00.3721816Z apps/memory_api/tests/test_dashboard_websocket.py::test_websocket_connect [32mPASSED[0m[33m [ 19%][0m
2025-11-28T17:40:00.3799015Z apps/memory_api/tests/test_dashboard_websocket.py::test_websocket_disconnect [32mPASSED[0m[33m [ 20%][0m
2025-11-28T17:40:00.3874678Z apps/memory_api/tests/test_dashboard_websocket.py::test_subscription_filtering [32mPASSED[0m[33m [ 20%][0m
2025-11-28T17:40:00.3950585Z apps/memory_api/tests/test_dashboard_websocket.py::test_broadcast_to_tenant [32mPASSED[0m[33m [ 20%][0m
2025-11-28T17:40:00.4074911Z apps/memory_api/tests/test_dashboard_websocket.py::test_broadcast_all [32mPASSED[0m[33m [ 21%][0m
2025-11-28T17:40:00.4124325Z apps/memory_api/tests/test_dashboard_websocket.py::test_collect_system_metrics [32mPASSED[0m[33m [ 21%][0m
2025-11-28T17:40:00.4160394Z apps/memory_api/tests/test_dashboard_websocket.py::test_metrics_changed_significantly [32mPASSED[0m[33m [ 21%][0m
2025-11-28T17:40:00.4204622Z apps/memory_api/tests/test_dashboard_websocket.py::test_check_system_health [32mPASSED[0m[33m [ 22%][0m
2025-11-28T17:40:00.4256049Z apps/memory_api/tests/test_dashboard_websocket.py::test_health_monitoring_failure [32mPASSED[0m[33m [ 22%][0m
2025-11-28T17:40:00.4345850Z apps/memory_api/tests/test_dashboard_websocket.py::test_broadcast_memory_created [32mPASSED[0m[33m [ 23%][0m
2025-11-28T17:40:00.4448318Z apps/memory_api/tests/test_dashboard_websocket.py::test_broadcast_quality_alert [32mPASSED[0m[33m [ 23%][0m
2025-11-28T17:40:00.4472104Z apps/memory_api/tests/test_evaluation_suite.py::test_mrr_calculation [32mPASSED[0m[33m [ 23%][0m
2025-11-28T17:40:00.4495257Z apps/memory_api/tests/test_evaluation_suite.py::test_ndcg_calculation [32mPASSED[0m[33m [ 24%][0m
2025-11-28T17:40:00.4518048Z apps/memory_api/tests/test_evaluation_suite.py::test_precision_recall [32mPASSED[0m[33m [ 24%][0m
2025-11-28T17:40:00.4560651Z apps/memory_api/tests/test_evaluation_suite.py::test_kolmogorov_smirnov_test [32mPASSED[0m[33m [ 24%][0m
2025-11-28T17:40:00.6129651Z apps/memory_api/tests/test_evaluation_suite.py::test_psi_calculation [32mPASSED[0m[33m [ 25%][0m
2025-11-28T17:40:00.6162599Z apps/memory_api/tests/test_evaluation_suite.py::test_drift_severity_classification [32mPASSED[0m[33m [ 25%][0m
2025-11-28T17:40:00.6257760Z apps/memory_api/tests/test_evaluation_suite.py::test_drift_detection_no_data [32mPASSED[0m[33m [ 26%][0m
2025-11-28T17:40:00.6279626Z apps/memory_api/tests/test_evaluation_suite.py::test_ab_test_traffic_validation [32mPASSED[0m[33m [ 26%][0m
2025-11-28T17:40:00.6326030Z apps/memory_api/tests/test_event_triggers.py::test_process_event [32mPASSED[0m[33m  [ 26%][0m
2025-11-28T17:40:00.6358021Z apps/memory_api/tests/test_event_triggers.py::test_evaluate_simple_condition [32mPASSED[0m[33m [ 27%][0m
2025-11-28T17:40:00.6394448Z apps/memory_api/tests/test_event_triggers.py::test_evaluate_condition_group_and [32mPASSED[0m[33m [ 27%][0m
2025-11-28T17:40:00.6426621Z apps/memory_api/tests/test_event_triggers.py::test_evaluate_condition_group_or [32mPASSED[0m[33m [ 27%][0m
2025-11-28T17:40:00.6458578Z apps/memory_api/tests/test_event_triggers.py::test_nested_condition_groups [32mPASSED[0m[33m [ 28%][0m
2025-11-28T17:40:00.6492092Z apps/memory_api/tests/test_event_triggers.py::test_condition_operators [32mPASSED[0m[33m [ 28%][0m
2025-11-28T17:40:00.6524412Z apps/memory_api/tests/test_event_triggers.py::test_rate_limiting [32mPASSED[0m[33m  [ 29%][0m
2025-11-28T17:40:00.6561086Z apps/memory_api/tests/test_event_triggers.py::test_cooldown_period [32mPASSED[0m[33m [ 29%][0m
2025-11-28T17:40:00.6608971Z apps/memory_api/tests/test_event_triggers.py::test_execute_action [32mPASSED[0m[33m [ 29%][0m
2025-11-28T17:40:00.6642590Z apps/memory_api/tests/test_event_triggers.py::test_workflow_execution [32mPASSED[0m[33m [ 30%][0m
2025-11-28T17:40:00.6663480Z apps/memory_api/tests/test_graph_algorithms.py::test_graph_node [32mPASSED[0m[33m   [ 30%][0m
2025-11-28T17:40:00.6683761Z apps/memory_api/tests/test_graph_algorithms.py::test_graph_edge [32mPASSED[0m[33m   [ 30%][0m
2025-11-28T17:40:00.6704458Z apps/memory_api/tests/test_graph_algorithms.py::test_knowledge_graph [32mPASSED[0m[33m [ 31%][0m
2025-11-28T17:40:00.6782616Z apps/memory_api/tests/test_graph_algorithms.py::test_service_load_tenant_graph [32mPASSED[0m[33m [ 31%][0m
2025-11-28T17:40:00.6862497Z apps/memory_api/tests/test_graph_algorithms.py::test_pagerank [32mPASSED[0m[33m     [ 32%][0m
2025-11-28T17:40:00.6943002Z apps/memory_api/tests/test_graph_algorithms.py::test_shortest_path [32mPASSED[0m[33m [ 32%][0m
2025-11-28T17:40:00.7026941Z apps/memory_api/tests/test_graph_algorithms.py::test_find_all_paths [32mPASSED[0m[33m [ 32%][0m
2025-11-28T17:40:00.7103663Z apps/memory_api/tests/test_graph_algorithms.py::test_find_related_entities [32mPASSED[0m[33m [ 33%][0m
2025-11-28T17:40:00.7185157Z apps/memory_api/tests/test_graph_algorithms.py::test_graph_summary [32mPASSED[0m[33m [ 33%][0m
2025-11-28T17:40:00.7288345Z apps/memory_api/tests/test_graph_algorithms.py::test_community_detection [32mPASSED[0m[33m [ 33%][0m
2025-11-28T17:40:00.7394880Z apps/memory_api/tests/test_graph_algorithms.py::test_calculate_centrality [32mPASSED[0m[33m [ 34%][0m
2025-11-28T17:40:00.7482564Z apps/memory_api/tests/test_graph_algorithms.py::test_graph_density [32mPASSED[0m[33m [ 34%][0m
2025-11-28T17:40:00.7565969Z apps/memory_api/tests/test_graph_algorithms.py::test_subgraph_extraction [32mPASSED[0m[33m [ 35%][0m
2025-11-28T17:40:01.1522632Z apps/memory_api/tests/test_openapi.py::test_openapi_schema [32mPASSED[0m[33m        [ 35%][0m
2025-11-28T17:40:01.1536654Z apps/memory_api/tests/test_phase2_models.py::TestTenantModels::test_tenant_tier_enum [32mPASSED[0m[33m [ 35%][0m
2025-11-28T17:40:01.1550775Z apps/memory_api/tests/test_phase2_models.py::TestTenantModels::test_tenant_config_defaults [32mPASSED[0m[33m [ 36%][0m
2025-11-28T17:40:01.1564757Z apps/memory_api/tests/test_phase2_models.py::TestTenantModels::test_tenant_creation [32mPASSED[0m[33m [ 36%][0m
2025-11-28T17:40:01.1578608Z apps/memory_api/tests/test_phase2_models.py::TestTenantModels::test_get_default_config_for_free_tier [32mPASSED[0m[33m [ 36%][0m
2025-11-28T17:40:01.1592502Z apps/memory_api/tests/test_phase2_models.py::TestTenantModels::test_get_default_config_for_pro_tier [32mPASSED[0m[33m [ 37%][0m
2025-11-28T17:40:01.1606095Z apps/memory_api/tests/test_phase2_models.py::TestTenantModels::test_get_default_config_for_enterprise_tier [32mPASSED[0m[33m [ 37%][0m
2025-11-28T17:40:01.1620352Z apps/memory_api/tests/test_phase2_models.py::TestTenantModels::test_has_quota_available_memories [32mPASSED[0m[33m [ 38%][0m
2025-11-28T17:40:01.1634089Z apps/memory_api/tests/test_phase2_models.py::TestTenantModels::test_has_quota_available_unlimited [32mPASSED[0m[33m [ 38%][0m
2025-11-28T17:40:01.1648067Z apps/memory_api/tests/test_phase2_models.py::TestTenantModels::test_increment_usage [32mPASSED[0m[33m [ 38%][0m
2025-11-28T17:40:01.1662344Z apps/memory_api/tests/test_phase2_models.py::TestTenantModels::test_is_feature_enabled [32mPASSED[0m[33m [ 39%][0m
2025-11-28T17:40:01.1675767Z apps/memory_api/tests/test_phase2_models.py::TestRBACModels::test_role_enum_values [32mPASSED[0m[33m [ 39%][0m
2025-11-28T17:40:01.1689306Z apps/memory_api/tests/test_phase2_models.py::TestRBACModels::test_role_levels [32mPASSED[0m[33m [ 40%][0m
2025-11-28T17:40:01.1702762Z apps/memory_api/tests/test_phase2_models.py::TestRBACModels::test_role_can_perform_owner [32mPASSED[0m[33m [ 40%][0m
2025-11-28T17:40:01.1716426Z apps/memory_api/tests/test_phase2_models.py::TestRBACModels::test_role_can_perform_admin [32mPASSED[0m[33m [ 40%][0m
2025-11-28T17:40:01.1730319Z apps/memory_api/tests/test_phase2_models.py::TestRBACModels::test_role_can_perform_developer [32mPASSED[0m[33m [ 41%][0m
2025-11-28T17:40:01.1744237Z apps/memory_api/tests/test_phase2_models.py::TestRBACModels::test_role_can_perform_analyst [32mPASSED[0m[33m [ 41%][0m
2025-11-28T17:40:01.1757762Z apps/memory_api/tests/test_phase2_models.py::TestRBACModels::test_role_can_perform_viewer [32mPASSED[0m[33m [ 41%][0m
2025-11-28T17:40:01.1771503Z apps/memory_api/tests/test_phase2_models.py::TestRBACModels::test_permission_model [32mPASSED[0m[33m [ 42%][0m
2025-11-28T17:40:01.1785404Z apps/memory_api/tests/test_phase2_models.py::TestRBACModels::test_user_role_creation [32mPASSED[0m[33m [ 42%][0m
2025-11-28T17:40:01.1799807Z apps/memory_api/tests/test_phase2_models.py::TestRBACModels::test_user_role_expiration [32mPASSED[0m[33m [ 43%][0m
2025-11-28T17:40:01.1813736Z apps/memory_api/tests/test_phase2_models.py::TestRBACModels::test_user_role_project_access [32mPASSED[0m[33m [ 43%][0m
2025-11-28T17:40:01.1827521Z apps/memory_api/tests/test_phase2_models.py::TestRBACModels::test_user_role_can_perform [32mPASSED[0m[33m [ 43%][0m
2025-11-28T17:40:01.1841613Z apps/memory_api/tests/test_phase2_models.py::TestRBACModels::test_user_role_can_perform_with_project [32mPASSED[0m[33m [ 44%][0m
2025-11-28T17:40:01.1855196Z apps/memory_api/tests/test_phase2_models.py::TestRBACModels::test_role_hierarchy_comparison [32mPASSED[0m[33m [ 44%][0m
2025-11-28T17:40:01.1868720Z apps/memory_api/tests/test_phase2_models.py::TestRBACModels::test_can_assign_role [32mPASSED[0m[33m [ 44%][0m
2025-11-28T17:40:01.1883203Z apps/memory_api/tests/test_phase2_models.py::TestRBACModels::test_can_modify_user [32mPASSED[0m[33m [ 45%][0m
2025-11-28T17:40:01.1896773Z apps/memory_api/tests/test_phase2_plugins.py::TestPluginMetadata::test_metadata_creation [32mPASSED[0m[33m [ 45%][0m
2025-11-28T17:40:01.1910328Z apps/memory_api/tests/test_phase2_plugins.py::TestPluginMetadata::test_metadata_to_dict [32mPASSED[0m[33m [ 46%][0m
2025-11-28T17:40:01.1934356Z apps/memory_api/tests/test_phase2_plugins.py::TestPluginBase::test_plugin_initialization [32mPASSED[0m[33m [ 46%][0m
2025-11-28T17:40:01.1956402Z apps/memory_api/tests/test_phase2_plugins.py::TestPluginBase::test_plugin_shutdown [32mPASSED[0m[33m [ 46%][0m
2025-11-28T17:40:01.1977582Z apps/memory_api/tests/test_phase2_plugins.py::TestPluginBase::test_plugin_health_check [32mPASSED[0m[33m [ 47%][0m
2025-11-28T17:40:01.1998651Z apps/memory_api/tests/test_phase2_plugins.py::TestPluginBase::test_hook_execution [32mPASSED[0m[33m [ 47%][0m
2025-11-28T17:40:01.2020000Z apps/memory_api/tests/test_phase2_plugins.py::TestPluginBase::test_transform_hook [32mPASSED[0m[33m [ 47%][0m
2025-11-28T17:40:01.2033956Z apps/memory_api/tests/test_phase2_plugins.py::TestPluginRegistry::test_registry_creation [32mPASSED[0m[33m [ 48%][0m
2025-11-28T17:40:01.2051322Z apps/memory_api/tests/test_phase2_plugins.py::TestPluginRegistry::test_register_plugin [32mPASSED[0m[33m [ 48%][0m
2025-11-28T17:40:01.2069332Z apps/memory_api/tests/test_phase2_plugins.py::TestPluginRegistry::test_unregister_plugin [32mPASSED[0m[33m [ 49%][0m
2025-11-28T17:40:01.2085546Z apps/memory_api/tests/test_phase2_plugins.py::TestPluginRegistry::test_list_plugins [32mPASSED[0m[33m [ 49%][0m
2025-11-28T17:40:01.2102341Z apps/memory_api/tests/test_phase2_plugins.py::TestPluginRegistry::test_get_plugins_for_hook [32mPASSED[0m[33m [ 49%][0m
2025-11-28T17:40:01.2132705Z apps/memory_api/tests/test_phase2_plugins.py::TestPluginRegistry::test_initialize_all [32mPASSED[0m[33m [ 50%][0m
2025-11-28T17:40:01.2158266Z apps/memory_api/tests/test_phase2_plugins.py::TestPluginRegistry::test_shutdown_all [32mPASSED[0m[33m [ 50%][0m
2025-11-28T17:40:01.2182614Z apps/memory_api/tests/test_phase2_plugins.py::TestPluginRegistry::test_execute_hook [32mPASSED[0m[33m [ 50%][0m
2025-11-28T17:40:01.2206910Z apps/memory_api/tests/test_phase2_plugins.py::TestPluginRegistry::test_execute_transform_hook [32mPASSED[0m[33m [ 51%][0m
2025-11-28T17:40:01.2230941Z apps/memory_api/tests/test_phase2_plugins.py::TestPluginRegistry::test_health_check_all [32mPASSED[0m[33m [ 51%][0m
2025-11-28T17:40:01.2244893Z apps/memory_api/tests/test_phase2_plugins.py::TestPluginRegistry::test_get_global_registry [32mPASSED[0m[33m [ 52%][0m
2025-11-28T17:40:01.2258464Z apps/memory_api/tests/test_phase2_plugins.py::TestPluginHooks::test_hook_values [32mPASSED[0m[33m [ 52%][0m
2025-11-28T17:40:01.2272728Z apps/memory_api/tests/test_phase2_plugins.py::TestPluginHooks::test_all_hooks_defined [32mPASSED[0m[33m [ 52%][0m
2025-11-28T17:40:01.2289351Z apps/memory_api/tests/test_phase2_plugins.py::TestPluginDisabling::test_disabled_plugin_not_executed [32mPASSED[0m[33m [ 53%][0m
2025-11-28T17:40:01.2314916Z apps/memory_api/tests/test_phase2_plugins.py::TestPluginDisabling::test_disabled_plugin_not_initialized [32mPASSED[0m[33m [ 53%][0m
2025-11-28T17:40:01.2342619Z apps/memory_api/tests/test_phase2_plugins.py::TestMultiplePlugins::test_multiple_plugins_same_hook [32mPASSED[0m[33m [ 53%][0m
2025-11-28T17:40:01.2370103Z apps/memory_api/tests/test_phase2_plugins.py::TestMultiplePlugins::test_plugin_chaining [32mPASSED[0m[33m [ 54%][0m
2025-11-28T17:40:01.6072213Z apps/memory_api/tests/test_reflective_flags.py::TestReflectiveMemoryFlags::test_reflective_memory_disabled_no_reflections [31mFAILED[0m[31m [ 54%][0m
2025-11-28T17:40:01.6146231Z apps/memory_api/tests/test_reflective_flags.py::TestReflectiveMemoryFlags::test_reflective_memory_enabled_retrieves_reflections [32mPASSED[0m[31m [ 55%][0m
2025-11-28T17:40:01.6207243Z apps/memory_api/tests/test_reflective_flags.py::TestReflectiveMemoryMode::test_lite_mode_uses_lower_limits [32mPASSED[0m[31m [ 55%][0m
2025-11-28T17:40:01.6267103Z apps/memory_api/tests/test_reflective_flags.py::TestReflectiveMemoryMode::test_full_mode_uses_higher_limits [32mPASSED[0m[31m [ 55%][0m
2025-11-28T17:40:01.6303156Z apps/memory_api/tests/test_reflective_flags.py::TestDreamingEnabled::test_dreaming_disabled_no_dreaming [32mPASSED[0m[31m [ 56%][0m
2025-11-28T17:40:01.7340509Z apps/memory_api/tests/test_reflective_flags.py::TestDreamingEnabled::test_dreaming_enabled_runs_dreaming [31mFAILED[0m[31m [ 56%][0m
2025-11-28T17:40:01.7376128Z apps/memory_api/tests/test_reflective_flags.py::TestSummarizationEnabled::test_summarization_disabled_no_summary [32mPASSED[0m[31m [ 56%][0m
2025-11-28T17:40:01.7446854Z apps/memory_api/tests/test_reflective_flags.py::TestSummarizationEnabled::test_summarization_enabled_creates_summary [32mPASSED[0m[31m [ 57%][0m
2025-11-28T17:40:01.7520091Z apps/memory_api/tests/test_reflective_flags.py::TestMaintenanceScheduler::test_maintenance_with_all_flags_disabled [32mPASSED[0m[31m [ 57%][0m
2025-11-28T17:40:01.7646125Z apps/memory_api/tests/test_reflective_flags.py::TestMaintenanceScheduler::test_maintenance_with_all_flags_enabled [32mPASSED[0m[31m [ 58%][0m
2025-11-28T17:40:01.7724512Z apps/memory_api/tests/test_temporal_graph.py::test_create_snapshot [32mPASSED[0m[31m [ 58%][0m
2025-11-28T17:40:01.7800198Z apps/memory_api/tests/test_temporal_graph.py::test_get_snapshot_at_time [32mPASSED[0m[31m [ 58%][0m
2025-11-28T17:40:01.7875278Z apps/memory_api/tests/test_temporal_graph.py::test_get_latest_snapshot [32mPASSED[0m[31m [ 59%][0m
2025-11-28T17:40:01.7950852Z apps/memory_api/tests/test_temporal_graph.py::test_record_change [32mPASSED[0m[31m  [ 59%][0m
2025-11-28T17:40:01.8024154Z apps/memory_api/tests/test_temporal_graph.py::test_get_changes_filters [32mPASSED[0m[31m [ 60%][0m
2025-11-28T17:40:01.8097412Z apps/memory_api/tests/test_temporal_graph.py::test_get_entity_history [32mPASSED[0m[31m [ 60%][0m
2025-11-28T17:40:01.8172694Z apps/memory_api/tests/test_temporal_graph.py::test_reconstruct_graph_at_time [32mPASSED[0m[31m [ 60%][0m
2025-11-28T17:40:01.8245434Z apps/memory_api/tests/test_temporal_graph.py::test_apply_change_logic [32mPASSED[0m[31m [ 61%][0m
2025-11-28T17:40:01.8330496Z apps/memory_api/tests/test_temporal_graph.py::test_compare_graphs [32mPASSED[0m[31m [ 61%][0m
2025-11-28T17:40:01.8406095Z apps/memory_api/tests/test_temporal_graph.py::test_get_evolution_timeline [32mPASSED[0m[31m [ 61%][0m
2025-11-28T17:40:01.8490376Z apps/memory_api/tests/test_temporal_graph.py::test_get_growth_metrics [32mPASSED[0m[31m [ 62%][0m
2025-11-28T17:40:01.8567320Z apps/memory_api/tests/test_temporal_graph.py::test_find_emerging_patterns [32mPASSED[0m[31m [ 62%][0m
2025-11-28T17:40:01.8646726Z apps/memory_api/tests/test_temporal_graph.py::test_cleanup_old_snapshots [32mPASSED[0m[31m [ 63%][0m
2025-11-28T17:40:01.9777327Z tests/api/v1/test_agent.py::test_agent_execute_direct [31mFAILED[0m[31m             [ 63%][0m
2025-11-28T17:40:02.0866800Z tests/api/v1/test_agent.py::test_agent_execute_with_context [31mFAILED[0m[31m       [ 63%][0m
2025-11-28T17:40:02.1943564Z tests/api/v1/test_agent.py::test_agent_execute_with_empty_prompt [31mFAILED[0m[31m  [ 64%][0m
2025-11-28T17:40:02.4688933Z tests/api/v1/test_agent.py::test_agent_execute_with_llm_error [31mFAILED[0m[31m     [ 64%][0m
2025-11-28T17:40:02.4760206Z tests/api/v1/test_cache.py::test_rebuild_cache [32mPASSED[0m[31m                    [ 64%][0m
2025-11-28T17:40:02.5043228Z tests/api/v1/test_governance.py::test_governance_overview_success [31mFAILED[0m[31m [ 65%][0m
2025-11-28T17:40:02.5313283Z tests/api/v1/test_governance.py::test_governance_overview_with_custom_days [31mFAILED[0m[31m [ 65%][0m
2025-11-28T17:40:02.5583211Z tests/api/v1/test_governance.py::test_governance_overview_error [31mFAILED[0m[31m   [ 66%][0m
2025-11-28T17:40:02.5881677Z tests/api/v1/test_governance.py::test_tenant_governance_stats_success [31mFAILED[0m[31m [ 66%][0m
2025-11-28T17:40:02.6163939Z tests/api/v1/test_governance.py::test_tenant_governance_stats_no_data [31mFAILED[0m[31m [ 66%][0m
2025-11-28T17:40:02.6439742Z tests/api/v1/test_governance.py::test_tenant_governance_stats_with_custom_period [31mFAILED[0m[31m [ 67%][0m
2025-11-28T17:40:02.6721288Z tests/api/v1/test_governance.py::test_tenant_budget_status_success [31mFAILED[0m[31m [ 67%][0m
2025-11-28T17:40:02.6994211Z tests/api/v1/test_governance.py::test_tenant_budget_status_with_alerts [31mFAILED[0m[31m [ 67%][0m
2025-11-28T17:40:02.7276544Z tests/api/v1/test_governance.py::test_tenant_budget_status_zero_usage [31mFAILED[0m[31m [ 68%][0m
2025-11-28T17:40:02.7550013Z tests/api/v1/test_governance.py::test_tenant_budget_status_error [31mFAILED[0m[31m  [ 68%][0m
2025-11-28T17:40:02.7826047Z tests/api/v1/test_governance.py::test_governance_overview_invalid_days [31mFAILED[0m[31m [ 69%][0m
2025-11-28T17:40:02.8099915Z tests/api/v1/test_governance.py::test_tenant_governance_stats_invalid_days [31mFAILED[0m[31m [ 69%][0m
2025-11-28T17:40:02.8376781Z tests/api/v1/test_governance.py::test_governance_overview_empty_results [31mFAILED[0m[31m [ 69%][0m
2025-11-28T17:40:02.8685041Z tests/api/v1/test_memory.py::test_store_memory_success [31mFAILED[0m[31m            [ 70%][0m
2025-11-28T17:40:02.8996626Z tests/api/v1/test_memory.py::test_query_memory_success [31mFAILED[0m[31m            [ 70%][0m
2025-11-28T17:40:02.9286902Z tests/api/v1/test_memory.py::test_delete_memory_success [31mFAILED[0m[31m           [ 70%][0m
2025-11-28T17:40:02.9513112Z tests/api/v1/test_memory.py::test_rebuild_reflections_success [32mPASSED[0m[31m     [ 71%][0m
2025-11-28T17:40:02.9765875Z tests/api/v1/test_memory.py::test_reflection_stats_success [31mFAILED[0m[31m        [ 71%][0m
2025-11-28T17:40:03.0074693Z tests/api/v1/test_memory.py::test_store_memory_missing_tenant_header [31mFAILED[0m[31m [ 72%][0m
2025-11-28T17:40:03.0378689Z tests/api/v1/test_memory.py::test_query_memory_with_filters [31mFAILED[0m[31m       [ 72%][0m
2025-11-28T17:40:03.0715234Z tests/api/v1/test_memory.py::test_query_memory_with_graph_traversal [31mFAILED[0m[31m [ 72%][0m
2025-11-28T17:40:03.1010550Z tests/api/v1/test_memory.py::test_delete_memory_not_found [31mFAILED[0m[31m         [ 73%][0m
2025-11-28T17:40:03.1393618Z tests/api/v1/test_search_hybrid.py::test_hybrid_search_success [31mFAILED[0m[31m    [ 73%][0m
2025-11-28T17:40:03.1701777Z tests/api/v1/test_search_hybrid.py::test_hybrid_search_with_reranking [31mFAILED[0m[31m [ 73%][0m
2025-11-28T17:40:03.2000290Z tests/api/v1/test_search_hybrid.py::test_hybrid_search_with_filters [31mFAILED[0m[31m [ 74%][0m
2025-11-28T17:40:03.2303933Z tests/api/v1/test_search_hybrid.py::test_hybrid_search_with_manual_weights [31mFAILED[0m[31m [ 74%][0m
2025-11-28T17:40:03.2609314Z tests/api/v1/test_search_hybrid.py::test_hybrid_search_with_graph_depth [31mFAILED[0m[31m [ 75%][0m
2025-11-28T17:40:03.2909008Z tests/api/v1/test_search_hybrid.py::test_hybrid_search_with_conversation_history [31mFAILED[0m[31m [ 75%][0m
2025-11-28T17:40:03.3215496Z tests/api/v1/test_search_hybrid.py::test_hybrid_search_empty_query [31mFAILED[0m[31m [ 75%][0m
2025-11-28T17:40:03.3428122Z tests/api/v1/test_search_hybrid.py::test_hybrid_search_service_error [32mPASSED[0m[31m [ 76%][0m
2025-11-28T17:40:03.3736935Z tests/api/v1/test_search_hybrid.py::test_hybrid_search_all_strategies_disabled [31mFAILED[0m[31m [ 76%][0m
2025-11-28T17:40:03.5653279Z tests/integration/test_graphrag.py::test_graph_extraction_basic [31mERROR[0m[31m    [ 76%][0m
2025-11-28T17:40:03.7292198Z tests/integration/test_graphrag.py::test_graph_storage [31mERROR[0m[31m             [ 77%][0m
2025-11-28T17:40:04.0717790Z tests/integration/test_graphrag.py::test_hybrid_search [31mERROR[0m[31m             [ 77%][0m
2025-11-28T17:40:04.2355486Z tests/integration/test_graphrag.py::test_graph_traversal_depth [31mERROR[0m[31m     [ 78%][0m
2025-11-28T17:40:04.3981041Z tests/integration/test_graphrag.py::test_hierarchical_reflection [31mERROR[0m[31m   [ 78%][0m
2025-11-28T17:40:04.4039947Z tests/integration/test_reflection_flow.py::test_generate_reflection_from_failure [31mERROR[0m[31m [ 78%][0m
2025-11-28T17:40:04.4083475Z tests/integration/test_reflection_flow.py::test_generate_reflection_from_success [31mERROR[0m[31m [ 79%][0m
2025-11-28T17:40:04.4126191Z tests/integration/test_reflection_flow.py::test_reflection_retrieval_in_context [31mERROR[0m[31m [ 79%][0m
2025-11-28T17:40:04.4161440Z tests/integration/test_reflection_flow.py::test_memory_scoring_v2 [32mPASSED[0m[31m [ 80%][0m
2025-11-28T17:40:04.4201622Z tests/integration/test_reflection_flow.py::test_inject_reflections_into_prompt [31mERROR[0m[31m [ 80%][0m
2025-11-28T17:40:04.4253056Z tests/integration/test_reflection_flow.py::test_end_to_end_reflection_flow [31mERROR[0m[31m [ 80%][0m
2025-11-28T17:40:13.2041269Z tests/llm/test_llm_provider_contract.py::test_basic_completion [31mFAILED[0m[31m    [ 81%][0m
2025-11-28T17:40:21.6109731Z tests/llm/test_llm_provider_contract.py::test_json_mode [31mFAILED[0m[31m           [ 81%][0m
2025-11-28T17:40:21.7813804Z tests/llm/test_llm_provider_contract.py::test_streaming [31mFAILED[0m[31m           [ 81%][0m
2025-11-28T17:40:30.1746324Z tests/llm/test_llm_provider_contract.py::test_token_usage [31mFAILED[0m[31m         [ 82%][0m
2025-11-28T17:40:38.7485202Z tests/llm/test_llm_provider_contract.py::test_temperature_control [31mFAILED[0m[31m [ 82%][0m
2025-11-28T17:40:47.1504832Z tests/llm/test_llm_provider_contract.py::test_max_tokens [31mFAILED[0m[31m          [ 83%][0m
2025-11-28T17:40:55.5341279Z tests/llm/test_llm_provider_contract.py::test_provider_contract_hello_world[openai-gpt-3.5-turbo] [31mFAILED[0m[31m [ 83%][0m
2025-11-28T17:40:55.5380975Z tests/llm/test_llm_provider_contract.py::test_provider_contract_hello_world[anthropic-claude-3-haiku-20240307] [33mSKIPPED[0m[31m [ 83%][0m
2025-11-28T17:40:55.5421122Z tests/llm/test_llm_provider_contract.py::test_provider_contract_hello_world[gemini-gemini-1.5-flash] [33mSKIPPED[0m[31m [ 84%][0m
2025-11-28T17:40:55.5504495Z tests/repositories/test_graph_repository.py::test_get_all_nodes [32mPASSED[0m[31m   [ 84%][0m
2025-11-28T17:40:55.5585919Z tests/repositories/test_graph_repository.py::test_get_all_edges [32mPASSED[0m[31m   [ 84%][0m
2025-11-28T17:40:55.5672461Z tests/repositories/test_graph_repository.py::test_update_node_label [32mPASSED[0m[31m [ 85%][0m
2025-11-28T17:40:55.5897117Z tests/repositories/test_graph_repository.py::test_merge_node_edges [31mFAILED[0m[31m [ 85%][0m
2025-11-28T17:40:55.5986900Z tests/repositories/test_graph_repository.py::test_delete_node_edges [32mPASSED[0m[31m [ 86%][0m
2025-11-28T17:40:55.6070425Z tests/repositories/test_graph_repository.py::test_delete_node [32mPASSED[0m[31m     [ 86%][0m
2025-11-28T17:40:55.6165241Z tests/repositories/test_graph_repository.py::test_delete_node_not_found [32mPASSED[0m[31m [ 86%][0m
2025-11-28T17:40:55.6249761Z tests/repositories/test_graph_repository.py::test_upsert_node_insert [32mPASSED[0m[31m [ 87%][0m
2025-11-28T17:40:55.6333235Z tests/repositories/test_graph_repository.py::test_upsert_node_update [32mPASSED[0m[31m [ 87%][0m
2025-11-28T17:40:55.6418522Z tests/repositories/test_graph_repository.py::test_create_node [32mPASSED[0m[31m     [ 87%][0m
2025-11-28T17:40:55.6500856Z tests/repositories/test_graph_repository.py::test_create_edge [32mPASSED[0m[31m     [ 88%][0m
2025-11-28T17:40:55.6586667Z tests/repositories/test_graph_repository.py::test_get_node_internal_id [32mPASSED[0m[31m [ 88%][0m
2025-11-28T17:40:55.6668031Z tests/repositories/test_graph_repository.py::test_get_node_internal_id_not_found [32mPASSED[0m[31m [ 89%][0m
2025-11-28T17:40:55.6942807Z tests/repositories/test_graph_repository.py::test_store_graph_triples [31mFAILED[0m[31m [ 89%][0m
2025-11-28T17:40:55.7040992Z tests/services/llm/test_providers.py::test_openai_generate [32mPASSED[0m[31m        [ 89%][0m
2025-11-28T17:40:55.7107149Z tests/services/test_budget_service.py::test_check_budget [31mFAILED[0m[31m          [ 90%][0m
2025-11-28T17:40:55.7172459Z tests/services/test_budget_service.py::test_check_budget_fail [31mFAILED[0m[31m     [ 90%][0m
2025-11-28T17:40:55.7250253Z tests/services/test_community_detection.py::test_load_graph_uses_repository [32mPASSED[0m[31m [ 90%][0m
2025-11-28T17:40:55.7319613Z tests/services/test_community_detection.py::test_load_graph_with_disconnected_edges [32mPASSED[0m[31m [ 91%][0m
2025-11-28T17:40:55.7378621Z tests/services/test_community_detection.py::test_store_super_node_uses_repository [32mPASSED[0m[31m [ 91%][0m
2025-11-28T17:40:55.7456846Z tests/services/test_community_detection.py::test_run_community_detection_insufficient_nodes [32mPASSED[0m[31m [ 92%][0m
2025-11-28T17:40:55.7515178Z tests/services/test_community_detection.py::test_generate_summary_llm_integration [32mPASSED[0m[31m [ 92%][0m
2025-11-28T17:40:55.7575628Z tests/services/test_community_detection.py::test_generate_summary_llm_failure [32mPASSED[0m[31m [ 92%][0m
2025-11-28T17:40:55.7646394Z tests/services/test_community_detection.py::test_process_community_workflow [32mPASSED[0m[31m [ 93%][0m
2025-11-28T17:40:55.7715146Z tests/services/test_community_detection.py::test_empty_graph_handling [32mPASSED[0m[31m [ 93%][0m
2025-11-28T17:40:55.7751456Z tests/services/test_context_cache.py::test_context_cache_flow [32mPASSED[0m[31m     [ 93%][0m
2025-11-28T17:40:55.7821355Z tests/services/test_entity_resolution.py::test_fetch_nodes_uses_repository [32mPASSED[0m[31m [ 94%][0m
2025-11-28T17:40:55.7914616Z tests/services/test_entity_resolution.py::test_merge_nodes_with_canonical_name [32mPASSED[0m[31m [ 94%][0m
2025-11-28T17:40:55.8018930Z tests/services/test_entity_resolution.py::test_merge_nodes_without_canonical_name [32mPASSED[0m[31m [ 95%][0m
2025-11-28T17:40:55.8093128Z tests/services/test_entity_resolution.py::test_merge_nodes_empty_list [32mPASSED[0m[31m [ 95%][0m
2025-11-28T17:40:55.8172574Z tests/services/test_entity_resolution.py::test_run_clustering_with_insufficient_nodes [32mPASSED[0m[31m [ 95%][0m
2025-11-28T17:40:55.8264587Z tests/services/test_entity_resolution.py::test_process_group_with_merge_approval [32mPASSED[0m[31m [ 96%][0m
2025-11-28T17:40:55.8346488Z tests/services/test_entity_resolution.py::test_process_group_with_merge_rejection [32mPASSED[0m[31m [ 96%][0m
2025-11-28T17:40:55.8504864Z tests/services/test_reflection_engine.py::test_reflection_flow [31mFAILED[0m[31m    [ 96%][0m
2025-11-28T17:40:55.8702082Z test_enterprise_features.py::test_decorator_import [32mPASSED[0m[31m                [ 97%][0m
2025-11-28T17:40:55.9176981Z test_enterprise_features.py::test_decorator_basic_usage [32mPASSED[0m[31m           [ 97%][0m
2025-11-28T17:40:55.9190465Z test_enterprise_features.py::test_reflection_engine_import [32mPASSED[0m[31m        [ 98%][0m
2025-11-28T17:40:55.9204302Z test_enterprise_features.py::test_hierarchical_reflection_methods [32mPASSED[0m[31m [ 98%][0m
2025-11-28T17:40:55.9217962Z test_enterprise_features.py::test_llm_structured_outputs [32mPASSED[0m[31m          [ 98%][0m
2025-11-28T17:40:55.9317670Z test_enterprise_features.py::test_pydantic_models [31mFAILED[0m[31m                 [ 99%][0m
2025-11-28T17:40:55.9776454Z test_enterprise_features.py::test_memory_client_async_methods [32mPASSED[0m[31m     [ 99%][0m
2025-11-28T17:41:05.4383317Z test_enterprise_features.py::test_api_endpoint_exists [32mPASSED[0m[31m             [100%][0m
2025-11-28T17:41:05.4384072Z 
2025-11-28T17:41:05.4384269Z ==================================== ERRORS ====================================
2025-11-28T17:41:05.4385106Z [31m[1m________________ ERROR at setup of test_graph_extraction_basic _________________[0m
2025-11-28T17:41:05.4385957Z [1m[31mtests/integration/test_graphrag.py[0m:35: in db_pool
2025-11-28T17:41:05.4386758Z     [0mpool = [94mawait[39;49;00m asyncpg.create_pool([90m[39;49;00m
2025-11-28T17:41:05.4387958Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/asyncpg/pool.py[0m:418: in _async__init__
2025-11-28T17:41:05.4389409Z     [0m[94mawait[39;49;00m [96mself[39;49;00m._initialize()[90m[39;49;00m
2025-11-28T17:41:05.4391067Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/asyncpg/pool.py[0m:445: in _initialize
2025-11-28T17:41:05.4392161Z     [0m[94mawait[39;49;00m first_ch.connect()[90m[39;49;00m
2025-11-28T17:41:05.4393244Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/asyncpg/pool.py[0m:132: in connect
2025-11-28T17:41:05.4394554Z     [0m[96mself[39;49;00m._con = [94mawait[39;49;00m [96mself[39;49;00m._pool._get_new_connection()[90m[39;49;00m
2025-11-28T17:41:05.4395426Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.4396555Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/asyncpg/pool.py[0m:517: in _get_new_connection
2025-11-28T17:41:05.4397775Z     [0mcon = [94mawait[39;49;00m [96mself[39;49;00m._connect([90m[39;49;00m
2025-11-28T17:41:05.4398992Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/asyncpg/connection.py[0m:2421: in connect
2025-11-28T17:41:05.4400404Z     [0m[94mreturn[39;49;00m [94mawait[39;49;00m connect_utils._connect([90m[39;49;00m
2025-11-28T17:41:05.4401658Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/asyncpg/connect_utils.py[0m:1049: in _connect
2025-11-28T17:41:05.4403031Z     [0mconn = [94mawait[39;49;00m _connect_addr([90m[39;49;00m
2025-11-28T17:41:05.4404222Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/asyncpg/connect_utils.py[0m:886: in _connect_addr
2025-11-28T17:41:05.4405610Z     [0m[94mreturn[39;49;00m [94mawait[39;49;00m __connect_addr(params, [94mTrue[39;49;00m, *args)[90m[39;49;00m
2025-11-28T17:41:05.4406472Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.4407613Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/asyncpg/connect_utils.py[0m:934: in __connect_addr
2025-11-28T17:41:05.4408706Z     [0m[94mawait[39;49;00m connected[90m[39;49;00m
2025-11-28T17:41:05.4409902Z [1m[31mE   asyncpg.exceptions.InvalidPasswordError: password authentication failed for user "memory"[0m
2025-11-28T17:41:05.4411064Z [31m[1m_____________________ ERROR at setup of test_graph_storage _____________________[0m
2025-11-28T17:41:05.4411903Z [1m[31mtests/integration/test_graphrag.py[0m:35: in db_pool
2025-11-28T17:41:05.4412710Z     [0mpool = [94mawait[39;49;00m asyncpg.create_pool([90m[39;49;00m
2025-11-28T17:41:05.4413883Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/asyncpg/pool.py[0m:418: in _async__init__
2025-11-28T17:41:05.4415017Z     [0m[94mawait[39;49;00m [96mself[39;49;00m._initialize()[90m[39;49;00m
2025-11-28T17:41:05.4416159Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/asyncpg/pool.py[0m:445: in _initialize
2025-11-28T17:41:05.4417193Z     [0m[94mawait[39;49;00m first_ch.connect()[90m[39;49;00m
2025-11-28T17:41:05.4418247Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/asyncpg/pool.py[0m:132: in connect
2025-11-28T17:41:05.4419723Z     [0m[96mself[39;49;00m._con = [94mawait[39;49;00m [96mself[39;49;00m._pool._get_new_connection()[90m[39;49;00m
2025-11-28T17:41:05.4420568Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.4421698Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/asyncpg/pool.py[0m:517: in _get_new_connection
2025-11-28T17:41:05.4422887Z     [0mcon = [94mawait[39;49;00m [96mself[39;49;00m._connect([90m[39;49;00m
2025-11-28T17:41:05.4424071Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/asyncpg/connection.py[0m:2421: in connect
2025-11-28T17:41:05.4425252Z     [0m[94mreturn[39;49;00m [94mawait[39;49;00m connect_utils._connect([90m[39;49;00m
2025-11-28T17:41:05.4426480Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/asyncpg/connect_utils.py[0m:1049: in _connect
2025-11-28T17:41:05.4427882Z     [0mconn = [94mawait[39;49;00m _connect_addr([90m[39;49;00m
2025-11-28T17:41:05.4429247Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/asyncpg/connect_utils.py[0m:886: in _connect_addr
2025-11-28T17:41:05.4430678Z     [0m[94mreturn[39;49;00m [94mawait[39;49;00m __connect_addr(params, [94mTrue[39;49;00m, *args)[90m[39;49;00m
2025-11-28T17:41:05.4431536Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.4432647Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/asyncpg/connect_utils.py[0m:934: in __connect_addr
2025-11-28T17:41:05.4433722Z     [0m[94mawait[39;49;00m connected[90m[39;49;00m
2025-11-28T17:41:05.4434730Z [1m[31mE   asyncpg.exceptions.InvalidPasswordError: password authentication failed for user "memory"[0m
2025-11-28T17:41:05.4435863Z [31m[1m_____________________ ERROR at setup of test_hybrid_search _____________________[0m
2025-11-28T17:41:05.4436701Z [1m[31mtests/integration/test_graphrag.py[0m:35: in db_pool
2025-11-28T17:41:05.4437470Z     [0mpool = [94mawait[39;49;00m asyncpg.create_pool([90m[39;49;00m
2025-11-28T17:41:05.4438626Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/asyncpg/pool.py[0m:418: in _async__init__
2025-11-28T17:41:05.4440164Z     [0m[94mawait[39;49;00m [96mself[39;49;00m._initialize()[90m[39;49;00m
2025-11-28T17:41:05.4441297Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/asyncpg/pool.py[0m:445: in _initialize
2025-11-28T17:41:05.4442372Z     [0m[94mawait[39;49;00m first_ch.connect()[90m[39;49;00m
2025-11-28T17:41:05.4443453Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/asyncpg/pool.py[0m:132: in connect
2025-11-28T17:41:05.4444739Z     [0m[96mself[39;49;00m._con = [94mawait[39;49;00m [96mself[39;49;00m._pool._get_new_connection()[90m[39;49;00m
2025-11-28T17:41:05.4445580Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.4446669Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/asyncpg/pool.py[0m:517: in _get_new_connection
2025-11-28T17:41:05.4447835Z     [0mcon = [94mawait[39;49;00m [96mself[39;49;00m._connect([90m[39;49;00m
2025-11-28T17:41:05.4448996Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/asyncpg/connection.py[0m:2421: in connect
2025-11-28T17:41:05.4450358Z     [0m[94mreturn[39;49;00m [94mawait[39;49;00m connect_utils._connect([90m[39;49;00m
2025-11-28T17:41:05.4451601Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/asyncpg/connect_utils.py[0m:1049: in _connect
2025-11-28T17:41:05.4452692Z     [0mconn = [94mawait[39;49;00m _connect_addr([90m[39;49;00m
2025-11-28T17:41:05.4453864Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/asyncpg/connect_utils.py[0m:886: in _connect_addr
2025-11-28T17:41:05.4455105Z     [0m[94mreturn[39;49;00m [94mawait[39;49;00m __connect_addr(params, [94mTrue[39;49;00m, *args)[90m[39;49;00m
2025-11-28T17:41:05.4455819Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.4456913Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/asyncpg/connect_utils.py[0m:934: in __connect_addr
2025-11-28T17:41:05.4458078Z     [0m[94mawait[39;49;00m connected[90m[39;49;00m
2025-11-28T17:41:05.4459244Z [1m[31mE   asyncpg.exceptions.InvalidPasswordError: password authentication failed for user "memory"[0m
2025-11-28T17:41:05.4460414Z [31m[1m_________________ ERROR at setup of test_graph_traversal_depth _________________[0m
2025-11-28T17:41:05.4461252Z [1m[31mtests/integration/test_graphrag.py[0m:35: in db_pool
2025-11-28T17:41:05.4462030Z     [0mpool = [94mawait[39;49;00m asyncpg.create_pool([90m[39;49;00m
2025-11-28T17:41:05.4463464Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/asyncpg/pool.py[0m:418: in _async__init__
2025-11-28T17:41:05.4464571Z     [0m[94mawait[39;49;00m [96mself[39;49;00m._initialize()[90m[39;49;00m
2025-11-28T17:41:05.4465741Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/asyncpg/pool.py[0m:445: in _initialize
2025-11-28T17:41:05.4466814Z     [0m[94mawait[39;49;00m first_ch.connect()[90m[39;49;00m
2025-11-28T17:41:05.4467863Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/asyncpg/pool.py[0m:132: in connect
2025-11-28T17:41:05.4469328Z     [0m[96mself[39;49;00m._con = [94mawait[39;49;00m [96mself[39;49;00m._pool._get_new_connection()[90m[39;49;00m
2025-11-28T17:41:05.4470196Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.4471258Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/asyncpg/pool.py[0m:517: in _get_new_connection
2025-11-28T17:41:05.4472431Z     [0mcon = [94mawait[39;49;00m [96mself[39;49;00m._connect([90m[39;49;00m
2025-11-28T17:41:05.4473608Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/asyncpg/connection.py[0m:2421: in connect
2025-11-28T17:41:05.4474796Z     [0m[94mreturn[39;49;00m [94mawait[39;49;00m connect_utils._connect([90m[39;49;00m
2025-11-28T17:41:05.4476273Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/asyncpg/connect_utils.py[0m:1049: in _connect
2025-11-28T17:41:05.4477398Z     [0mconn = [94mawait[39;49;00m _connect_addr([90m[39;49;00m
2025-11-28T17:41:05.4478722Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/asyncpg/connect_utils.py[0m:886: in _connect_addr
2025-11-28T17:41:05.4480283Z     [0m[94mreturn[39;49;00m [94mawait[39;49;00m __connect_addr(params, [94mTrue[39;49;00m, *args)[90m[39;49;00m
2025-11-28T17:41:05.4481137Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.4482275Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/asyncpg/connect_utils.py[0m:934: in __connect_addr
2025-11-28T17:41:05.4483358Z     [0m[94mawait[39;49;00m connected[90m[39;49;00m
2025-11-28T17:41:05.4484334Z [1m[31mE   asyncpg.exceptions.InvalidPasswordError: password authentication failed for user "memory"[0m
2025-11-28T17:41:05.4485503Z [31m[1m________________ ERROR at setup of test_hierarchical_reflection ________________[0m
2025-11-28T17:41:05.4486342Z [1m[31mtests/integration/test_graphrag.py[0m:35: in db_pool
2025-11-28T17:41:05.4487112Z     [0mpool = [94mawait[39;49;00m asyncpg.create_pool([90m[39;49;00m
2025-11-28T17:41:05.4488309Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/asyncpg/pool.py[0m:418: in _async__init__
2025-11-28T17:41:05.4489629Z     [0m[94mawait[39;49;00m [96mself[39;49;00m._initialize()[90m[39;49;00m
2025-11-28T17:41:05.4490779Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/asyncpg/pool.py[0m:445: in _initialize
2025-11-28T17:41:05.4491823Z     [0m[94mawait[39;49;00m first_ch.connect()[90m[39;49;00m
2025-11-28T17:41:05.4492874Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/asyncpg/pool.py[0m:132: in connect
2025-11-28T17:41:05.4494172Z     [0m[96mself[39;49;00m._con = [94mawait[39;49;00m [96mself[39;49;00m._pool._get_new_connection()[90m[39;49;00m
2025-11-28T17:41:05.4494987Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.4496072Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/asyncpg/pool.py[0m:517: in _get_new_connection
2025-11-28T17:41:05.4497294Z     [0mcon = [94mawait[39;49;00m [96mself[39;49;00m._connect([90m[39;49;00m
2025-11-28T17:41:05.4498474Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/asyncpg/connection.py[0m:2421: in connect
2025-11-28T17:41:05.4500138Z     [0m[94mreturn[39;49;00m [94mawait[39;49;00m connect_utils._connect([90m[39;49;00m
2025-11-28T17:41:05.4501403Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/asyncpg/connect_utils.py[0m:1049: in _connect
2025-11-28T17:41:05.4502513Z     [0mconn = [94mawait[39;49;00m _connect_addr([90m[39;49;00m
2025-11-28T17:41:05.4503700Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/asyncpg/connect_utils.py[0m:886: in _connect_addr
2025-11-28T17:41:05.4505092Z     [0m[94mreturn[39;49;00m [94mawait[39;49;00m __connect_addr(params, [94mTrue[39;49;00m, *args)[90m[39;49;00m
2025-11-28T17:41:05.4505937Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.4507060Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/asyncpg/connect_utils.py[0m:934: in __connect_addr
2025-11-28T17:41:05.4508153Z     [0m[94mawait[39;49;00m connected[90m[39;49;00m
2025-11-28T17:41:05.4509336Z [1m[31mE   asyncpg.exceptions.InvalidPasswordError: password authentication failed for user "memory"[0m
2025-11-28T17:41:05.4510509Z [31m[1m___________ ERROR at setup of test_generate_reflection_from_failure ____________[0m
2025-11-28T17:41:05.4511606Z file /home/runner/work/RAE-agentic-memory/RAE-agentic-memory/tests/integration/test_reflection_flow.py, line 81
2025-11-28T17:41:05.4512692Z   @pytest.mark.asyncio
2025-11-28T17:41:05.4513113Z   async def test_generate_reflection_from_failure(
2025-11-28T17:41:05.4513685Z       reflection_engine, memory_repo, tenant_id, project_id
2025-11-28T17:41:05.4514162Z   ):
2025-11-28T17:41:05.4514418Z       """
2025-11-28T17:41:05.4514812Z       Test reflection generation from a failed task execution.
2025-11-28T17:41:05.4515201Z 
2025-11-28T17:41:05.4515329Z       Scenario:
2025-11-28T17:41:05.4515669Z       1. Task fails with SQL timeout error
2025-11-28T17:41:05.4516159Z       2. Reflection engine generates lesson learned
2025-11-28T17:41:05.4516730Z       3. Reflection is stored with proper importance/confidence
2025-11-28T17:41:05.4517215Z       """
2025-11-28T17:41:05.4517501Z       # 1. Create failure context
2025-11-28T17:41:05.4517866Z       events = [
2025-11-28T17:41:05.4518151Z           Event(
2025-11-28T17:41:05.4518466Z               event_id="evt_1",
2025-11-28T17:41:05.4518915Z               event_type=EventType.TOOL_CALL,
2025-11-28T17:41:05.4519589Z               timestamp=datetime.now(timezone.utc),
2025-11-28T17:41:05.4520169Z               content="Executing SQL query: SELECT * FROM large_table",
2025-11-28T17:41:05.4520731Z               metadata={"tool": "sql_executor"},
2025-11-28T17:41:05.4521190Z               tool_name="sql_executor",
2025-11-28T17:41:05.4521580Z           ),
2025-11-28T17:41:05.4521843Z           Event(
2025-11-28T17:41:05.4522140Z               event_id="evt_2",
2025-11-28T17:41:05.4522544Z               event_type=EventType.ERROR_EVENT,
2025-11-28T17:41:05.4523026Z               timestamp=datetime.now(timezone.utc),
2025-11-28T17:41:05.4523531Z               content="Query timeout after 30 seconds",
2025-11-28T17:41:05.4524017Z               metadata={"error_code": "TIMEOUT"},
2025-11-28T17:41:05.4524547Z               error={"type": "TimeoutError", "code": "QUERY_TIMEOUT"},
2025-11-28T17:41:05.4525032Z           ),
2025-11-28T17:41:05.4525325Z       ]
2025-11-28T17:41:05.4525491Z 
2025-11-28T17:41:05.4525649Z       error_info = ErrorInfo(
2025-11-28T17:41:05.4526047Z           error_code="QUERY_TIMEOUT",
2025-11-28T17:41:05.4526499Z           error_category=ErrorCategory.TIMEOUT_ERROR,
2025-11-28T17:41:05.4527032Z           error_message="SQL query timeout after 30 seconds",
2025-11-28T17:41:05.4527528Z           tool_name="sql_executor",
2025-11-28T17:41:05.4528080Z           context={"query": "SELECT * FROM large_table", "timeout_seconds": 30},
2025-11-28T17:41:05.4528638Z       )
2025-11-28T17:41:05.4528789Z 
2025-11-28T17:41:05.4528945Z       context = ReflectionContext(
2025-11-28T17:41:05.4529511Z           events=events,
2025-11-28T17:41:05.4530123Z           outcome=OutcomeType.FAILURE,
2025-11-28T17:41:05.4530558Z           error=error_info,
2025-11-28T17:41:05.4530957Z           task_description="Fetch data from large table",
2025-11-28T17:41:05.4531462Z           task_goal="Retrieve user analytics data",
2025-11-28T17:41:05.4531916Z           tenant_id=tenant_id,
2025-11-28T17:41:05.4532321Z           project_id=project_id,
2025-11-28T17:41:05.4532693Z       )
2025-11-28T17:41:05.4532852Z 
2025-11-28T17:41:05.4532990Z       # 2. Generate reflection
2025-11-28T17:41:05.4533495Z       result = await reflection_engine.generate_reflection(context)
2025-11-28T17:41:05.4533907Z 
2025-11-28T17:41:05.4534064Z       # 3. Assertions on reflection result
2025-11-28T17:41:05.4534511Z       assert result is not None
2025-11-28T17:41:05.4535095Z       assert len(result.reflection_text) > 0, "Reflection text should not be empty"
2025-11-28T17:41:05.4535956Z       assert result.importance > 0.3, "Failure reflection should have reasonable importance"
2025-11-28T17:41:05.4536775Z       assert result.confidence > 0.0, "Confidence should be non-zero"
2025-11-28T17:41:05.4537471Z       assert result.error_category == ErrorCategory.TIMEOUT_ERROR
2025-11-28T17:41:05.4538082Z       assert len(result.source_event_ids) == len(events)
2025-11-28T17:41:05.4538428Z 
2025-11-28T17:41:05.4538795Z       # Check for relevant tags
2025-11-28T17:41:05.4539342Z       assert any(
2025-11-28T17:41:05.4539749Z           tag.lower() in ["sql", "timeout", "performance", "query"]
2025-11-28T17:41:05.4540267Z           for tag in result.tags
2025-11-28T17:41:05.4540687Z       ), "Reflection should have relevant tags"
2025-11-28T17:41:05.4541015Z 
2025-11-28T17:41:05.4541154Z       # 4. Store reflection
2025-11-28T17:41:05.4541612Z       stored_ids = await reflection_engine.store_reflection(
2025-11-28T17:41:05.4542111Z           result=result,
2025-11-28T17:41:05.4542460Z           tenant_id=tenant_id,
2025-11-28T17:41:05.4542854Z           project_id=project_id,
2025-11-28T17:41:05.4543230Z       )
2025-11-28T17:41:05.4543399Z 
2025-11-28T17:41:05.4543558Z       assert "reflection_id" in stored_ids
2025-11-28T17:41:05.4544023Z       assert stored_ids["reflection_id"] is not None
2025-11-28T17:41:05.4544358Z 
2025-11-28T17:41:05.4544503Z       # 5. Verify stored in database
2025-11-28T17:41:05.4545013Z       reflections = await memory_repo.get_reflective_memories(
2025-11-28T17:41:05.4545595Z           tenant_id=tenant_id, project=project_id
2025-11-28T17:41:05.4546030Z       )
2025-11-28T17:41:05.4546479Z       assert len(reflections) >= 1, "Reflection should be stored in database"
2025-11-28T17:41:05.4546948Z 
2025-11-28T17:41:05.4547084Z       # Find our reflection
2025-11-28T17:41:05.4547463Z       our_reflection = next(
2025-11-28T17:41:05.4547995Z           (r for r in reflections if r["id"] == stored_ids["reflection_id"]), None
2025-11-28T17:41:05.4548522Z       )
2025-11-28T17:41:05.4548816Z       assert our_reflection is not None
2025-11-28T17:41:05.4549581Z       assert our_reflection["content"] == result.reflection_text
2025-11-28T17:41:05.4550226Z       assert our_reflection["importance"] == result.importance
2025-11-28T17:41:05.4551209Z file /home/runner/work/RAE-agentic-memory/RAE-agentic-memory/tests/integration/test_reflection_flow.py, line 47
2025-11-28T17:41:05.4552079Z   @pytest.fixture
2025-11-28T17:41:05.4552503Z   async def reflection_engine(db_pool, memory_repo):
2025-11-28T17:41:05.4552980Z       """Reflection engine v2"""
2025-11-28T17:41:05.4553422Z       return ReflectionEngineV2(db_pool, memory_repo)
2025-11-28T17:41:05.4554351Z file /home/runner/work/RAE-agentic-memory/RAE-agentic-memory/tests/integration/test_reflection_flow.py, line 35
2025-11-28T17:41:05.4555227Z   @pytest.fixture
2025-11-28T17:41:05.4555575Z   async def db_pool(postgresql_pool):
2025-11-28T17:41:05.4556021Z       """Database connection pool"""
2025-11-28T17:41:05.4556442Z       return postgresql_pool
2025-11-28T17:41:05.4557049Z [31mE       fixture 'postgresql_pool' not found[0m
2025-11-28T17:41:05.4563171Z [31m>       available fixtures: _class_scoped_runner, _function_scoped_runner, _module_scoped_runner, _package_scoped_runner, _session_scoped_runner, anyio_backend, anyio_backend_name, anyio_backend_options, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, capteesys, class_mocker, context_builder, cov, db_pool, doctest_namespace, event_loop_policy, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, memory_repo, mock_app_state_pool, mock_env_and_settings, mocker, module_mocker, monkeypatch, no_cover, override_auth, package_mocker, project_id, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, reflection_engine, session_mocker, subtests, tenant_id, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory[0m
2025-11-28T17:41:05.4568160Z [31m>       use 'pytest --fixtures [testpath]' for help on them.[0m
2025-11-28T17:41:05.4568590Z 
2025-11-28T17:41:05.4569295Z /home/runner/work/RAE-agentic-memory/RAE-agentic-memory/tests/integration/test_reflection_flow.py:35
2025-11-28T17:41:05.4570459Z [31m[1m___________ ERROR at setup of test_generate_reflection_from_success ____________[0m
2025-11-28T17:41:05.4571546Z file /home/runner/work/RAE-agentic-memory/RAE-agentic-memory/tests/integration/test_reflection_flow.py, line 178
2025-11-28T17:41:05.4572681Z   @pytest.mark.asyncio
2025-11-28T17:41:05.4573099Z   async def test_generate_reflection_from_success(
2025-11-28T17:41:05.4573689Z       reflection_engine, memory_repo, tenant_id, project_id
2025-11-28T17:41:05.4574151Z   ):
2025-11-28T17:41:05.4574405Z       """
2025-11-28T17:41:05.4574809Z       Test reflection generation from a successful task execution.
2025-11-28T17:41:05.4575216Z 
2025-11-28T17:41:05.4575346Z       Scenario:
2025-11-28T17:41:05.4575681Z       1. Task succeeds with optimization
2025-11-28T17:41:05.4576188Z       2. Reflection engine generates positive pattern
2025-11-28T17:41:05.4576713Z       3. Reflection stored as reusable strategy
2025-11-28T17:41:05.4577133Z       """
2025-11-28T17:41:05.4577409Z       events = [
2025-11-28T17:41:05.4577709Z           Event(
2025-11-28T17:41:05.4578018Z               event_id="evt_1",
2025-11-28T17:41:05.4578431Z               event_type=EventType.TOOL_CALL,
2025-11-28T17:41:05.4578901Z               timestamp=datetime.now(timezone.utc),
2025-11-28T17:41:05.4579726Z               content="Executing optimized SQL query: SELECT id, name FROM users LIMIT 100",
2025-11-28T17:41:05.4580529Z               metadata={"tool": "sql_executor", "optimization": "added_limit"},
2025-11-28T17:41:05.4581108Z               tool_name="sql_executor",
2025-11-28T17:41:05.4581501Z           ),
2025-11-28T17:41:05.4581771Z           Event(
2025-11-28T17:41:05.4582081Z               event_id="evt_2",
2025-11-28T17:41:05.4582503Z               event_type=EventType.TOOL_RESPONSE,
2025-11-28T17:41:05.4582975Z               timestamp=datetime.now(timezone.utc),
2025-11-28T17:41:05.4583511Z               content="Query completed successfully in 0.5 seconds",
2025-11-28T17:41:05.4584047Z               metadata={"execution_time_ms": 500},
2025-11-28T17:41:05.4584465Z           ),
2025-11-28T17:41:05.4584743Z       ]
2025-11-28T17:41:05.4584906Z 
2025-11-28T17:41:05.4585056Z       context = ReflectionContext(
2025-11-28T17:41:05.4585461Z           events=events,
2025-11-28T17:41:05.4585827Z           outcome=OutcomeType.SUCCESS,
2025-11-28T17:41:05.4586326Z           task_description="Fetch user data efficiently",
2025-11-28T17:41:05.4586845Z           task_goal="Retrieve first 100 users",
2025-11-28T17:41:05.4587264Z           tenant_id=tenant_id,
2025-11-28T17:41:05.4587639Z           project_id=project_id,
2025-11-28T17:41:05.4587999Z       )
2025-11-28T17:41:05.4588147Z 
2025-11-28T17:41:05.4588283Z       # Generate reflection
2025-11-28T17:41:05.4588782Z       result = await reflection_engine.generate_reflection(context)
2025-11-28T17:41:05.4589586Z 
2025-11-28T17:41:05.4589733Z       assert result is not None
2025-11-28T17:41:05.4590149Z       assert len(result.reflection_text) > 0
2025-11-28T17:41:05.4590814Z       assert result.importance >= 0.0, "Success reflection should have some importance"
2025-11-28T17:41:05.4591346Z 
2025-11-28T17:41:05.4591517Z       # Success reflections might have strategy
2025-11-28T17:41:05.4591963Z       if result.strategy_text:
2025-11-28T17:41:05.4592368Z           assert len(result.strategy_text) > 0
2025-11-28T17:41:05.4592870Z           # Store should create both reflection and strategy
2025-11-28T17:41:05.4593462Z           stored_ids = await reflection_engine.store_reflection(
2025-11-28T17:41:05.4594104Z               result=result, tenant_id=tenant_id, project_id=project_id
2025-11-28T17:41:05.4594606Z           )
2025-11-28T17:41:05.4594926Z           assert "strategy_id" in stored_ids
2025-11-28T17:41:05.4595808Z file /home/runner/work/RAE-agentic-memory/RAE-agentic-memory/tests/integration/test_reflection_flow.py, line 47
2025-11-28T17:41:05.4596674Z   @pytest.fixture
2025-11-28T17:41:05.4597069Z   async def reflection_engine(db_pool, memory_repo):
2025-11-28T17:41:05.4597566Z       """Reflection engine v2"""
2025-11-28T17:41:05.4598020Z       return ReflectionEngineV2(db_pool, memory_repo)
2025-11-28T17:41:05.4598946Z file /home/runner/work/RAE-agentic-memory/RAE-agentic-memory/tests/integration/test_reflection_flow.py, line 35
2025-11-28T17:41:05.4600259Z   @pytest.fixture
2025-11-28T17:41:05.4600632Z   async def db_pool(postgresql_pool):
2025-11-28T17:41:05.4601051Z       """Database connection pool"""
2025-11-28T17:41:05.4601454Z       return postgresql_pool
2025-11-28T17:41:05.4601999Z [31mE       fixture 'postgresql_pool' not found[0m
2025-11-28T17:41:05.4607774Z [31m>       available fixtures: _class_scoped_runner, _function_scoped_runner, _module_scoped_runner, _package_scoped_runner, _session_scoped_runner, anyio_backend, anyio_backend_name, anyio_backend_options, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, capteesys, class_mocker, context_builder, cov, db_pool, doctest_namespace, event_loop_policy, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, memory_repo, mock_app_state_pool, mock_env_and_settings, mocker, module_mocker, monkeypatch, no_cover, override_auth, package_mocker, project_id, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, reflection_engine, session_mocker, subtests, tenant_id, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory[0m
2025-11-28T17:41:05.4612978Z [31m>       use 'pytest --fixtures [testpath]' for help on them.[0m
2025-11-28T17:41:05.4613409Z 
2025-11-28T17:41:05.4613916Z /home/runner/work/RAE-agentic-memory/RAE-agentic-memory/tests/integration/test_reflection_flow.py:35
2025-11-28T17:41:05.4615069Z [31m[1m____________ ERROR at setup of test_reflection_retrieval_in_context ____________[0m
2025-11-28T17:41:05.4616191Z file /home/runner/work/RAE-agentic-memory/RAE-agentic-memory/tests/integration/test_reflection_flow.py, line 239
2025-11-28T17:41:05.4617079Z   @pytest.mark.asyncio
2025-11-28T17:41:05.4617501Z   async def test_reflection_retrieval_in_context(
2025-11-28T17:41:05.4617967Z       reflection_engine,
2025-11-28T17:41:05.4618302Z       context_builder,
2025-11-28T17:41:05.4618625Z       memory_repo,
2025-11-28T17:41:05.4618917Z       tenant_id,
2025-11-28T17:41:05.4619430Z       project_id,
2025-11-28T17:41:05.4619736Z   ):
2025-11-28T17:41:05.4619993Z       """
2025-11-28T17:41:05.4620431Z       Test that reflections are retrieved and injected into context.
2025-11-28T17:41:05.4620861Z 
2025-11-28T17:41:05.4620984Z       Scenario:
2025-11-28T17:41:05.4621321Z       1. Store a reflection about SQL timeouts
2025-11-28T17:41:05.4621813Z       2. Build context for a new SQL query task
2025-11-28T17:41:05.4622296Z       3. Verify reflection is included in context
2025-11-28T17:41:05.4622701Z       """
2025-11-28T17:41:05.4623194Z       # 1. Store a reflection manually
2025-11-28T17:41:05.4623619Z       reflection_content = (
2025-11-28T17:41:05.4624137Z           "SQL queries on large tables should always include LIMIT clause "
2025-11-28T17:41:05.4624815Z           "to prevent timeout errors. Default timeout is 30 seconds."
2025-11-28T17:41:05.4625328Z       )
2025-11-28T17:41:05.4625477Z 
2025-11-28T17:41:05.4625710Z       reflection_record = await memory_repo.insert_memory(
2025-11-28T17:41:05.4626224Z           tenant_id=tenant_id,
2025-11-28T17:41:05.4626608Z           content=reflection_content,
2025-11-28T17:41:05.4626997Z           source="test",
2025-11-28T17:41:05.4627330Z           importance=0.8,
2025-11-28T17:41:05.4627671Z           layer="rm",
2025-11-28T17:41:05.4628055Z           tags=["sql", "timeout", "best-practice"],
2025-11-28T17:41:05.4628555Z           timestamp=datetime.now(timezone.utc),
2025-11-28T17:41:05.4629005Z           project=project_id,
2025-11-28T17:41:05.4629564Z       )
2025-11-28T17:41:05.4629731Z 
2025-11-28T17:41:05.4629901Z       # 2. Build context with query about SQL
2025-11-28T17:41:05.4630437Z       query = "I need to fetch all user data from the users table"
2025-11-28T17:41:05.4630844Z 
2025-11-28T17:41:05.4631072Z       working_memory = await context_builder.build_context(
2025-11-28T17:41:05.4631803Z           tenant_id=tenant_id,
2025-11-28T17:41:05.4632162Z           project_id=project_id,
2025-11-28T17:41:05.4632531Z           query=query,
2025-11-28T17:41:05.4632876Z           recent_messages=[],
2025-11-28T17:41:05.4633228Z       )
2025-11-28T17:41:05.4633385Z 
2025-11-28T17:41:05.4633535Z       # 3. Verify reflection is in context
2025-11-28T17:41:05.4634171Z       assert len(working_memory.reflections) >= 1, "Should retrieve reflections"
2025-11-28T17:41:05.4634661Z 
2025-11-28T17:41:05.4634887Z       # Check our reflection is included (by content or ID)
2025-11-28T17:41:05.4635384Z       reflection_found = any(
2025-11-28T17:41:05.4635826Z           refl.metadata.get("id") == reflection_record["id"]
2025-11-28T17:41:05.4636344Z           for refl in working_memory.reflections
2025-11-28T17:41:05.4636759Z       )
2025-11-28T17:41:05.4637206Z       assert reflection_found, "Our test reflection should be in context"
2025-11-28T17:41:05.4637671Z 
2025-11-28T17:41:05.4637884Z       # 4. Verify formatted context includes lessons learned
2025-11-28T17:41:05.4638812Z       assert "Lessons Learned" in working_memory.context_text or "lessons learned" in working_memory.context_text.lower(), \
2025-11-28T17:41:05.4639939Z           "Context should include lessons learned section"
2025-11-28T17:41:05.4640296Z 
2025-11-28T17:41:05.4640490Z       # 5. Verify reflection content is in formatted text
2025-11-28T17:41:05.4641006Z       # (It should be in the Lessons Learned section)
2025-11-28T17:41:05.4641454Z       assert any(
2025-11-28T17:41:05.4641807Z           reflection_content in refl.content
2025-11-28T17:41:05.4642284Z           for refl in working_memory.reflections
2025-11-28T17:41:05.4642785Z       ), "Reflection content should be accessible"
2025-11-28T17:41:05.4643690Z file /home/runner/work/RAE-agentic-memory/RAE-agentic-memory/tests/integration/test_reflection_flow.py, line 47
2025-11-28T17:41:05.4644557Z   @pytest.fixture
2025-11-28T17:41:05.4644965Z   async def reflection_engine(db_pool, memory_repo):
2025-11-28T17:41:05.4645451Z       """Reflection engine v2"""
2025-11-28T17:41:05.4645891Z       return ReflectionEngineV2(db_pool, memory_repo)
2025-11-28T17:41:05.4646808Z file /home/runner/work/RAE-agentic-memory/RAE-agentic-memory/tests/integration/test_reflection_flow.py, line 35
2025-11-28T17:41:05.4647676Z   @pytest.fixture
2025-11-28T17:41:05.4648016Z   async def db_pool(postgresql_pool):
2025-11-28T17:41:05.4648459Z       """Database connection pool"""
2025-11-28T17:41:05.4648892Z       return postgresql_pool
2025-11-28T17:41:05.4649627Z [31mE       fixture 'postgresql_pool' not found[0m
2025-11-28T17:41:05.4655378Z [31m>       available fixtures: _class_scoped_runner, _function_scoped_runner, _module_scoped_runner, _package_scoped_runner, _session_scoped_runner, anyio_backend, anyio_backend_name, anyio_backend_options, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, capteesys, class_mocker, context_builder, cov, db_pool, doctest_namespace, event_loop_policy, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, memory_repo, mock_app_state_pool, mock_env_and_settings, mocker, module_mocker, monkeypatch, no_cover, override_auth, package_mocker, project_id, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, reflection_engine, session_mocker, subtests, tenant_id, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory[0m
2025-11-28T17:41:05.4660849Z [31m>       use 'pytest --fixtures [testpath]' for help on them.[0m
2025-11-28T17:41:05.4661265Z 
2025-11-28T17:41:05.4661781Z /home/runner/work/RAE-agentic-memory/RAE-agentic-memory/tests/integration/test_reflection_flow.py:35
2025-11-28T17:41:05.4662952Z [31m[1m____________ ERROR at setup of test_inject_reflections_into_prompt _____________[0m
2025-11-28T17:41:05.4664062Z file /home/runner/work/RAE-agentic-memory/RAE-agentic-memory/tests/integration/test_reflection_flow.py, line 353
2025-11-28T17:41:05.4665159Z   @pytest.mark.asyncio
2025-11-28T17:41:05.4665576Z   async def test_inject_reflections_into_prompt(
2025-11-28T17:41:05.4666126Z       context_builder, memory_repo, tenant_id, project_id
2025-11-28T17:41:05.4666596Z   ):
2025-11-28T17:41:05.4666845Z       """
2025-11-28T17:41:05.4667305Z       Test the helper method for injecting reflections into existing prompts.
2025-11-28T17:41:05.4667876Z       """
2025-11-28T17:41:05.4668156Z       # 1. Store a reflection
2025-11-28T17:41:05.4668551Z       await memory_repo.insert_memory(
2025-11-28T17:41:05.4668972Z           tenant_id=tenant_id,
2025-11-28T17:41:05.4669610Z           content="Always validate user input before processing",
2025-11-28T17:41:05.4670139Z           source="test",
2025-11-28T17:41:05.4670480Z           importance=0.9,
2025-11-28T17:41:05.4670808Z           layer="rm",
2025-11-28T17:41:05.4671157Z           tags=["security", "validation"],
2025-11-28T17:41:05.4671620Z           timestamp=datetime.now(timezone.utc),
2025-11-28T17:41:05.4672073Z           project=project_id,
2025-11-28T17:41:05.4672416Z       )
2025-11-28T17:41:05.4672573Z 
2025-11-28T17:41:05.4672708Z       # 2. Inject into prompt
2025-11-28T17:41:05.4673129Z       base_prompt = "You are a helpful assistant."
2025-11-28T17:41:05.4673772Z       enhanced_prompt = await context_builder.inject_reflections_into_prompt(
2025-11-28T17:41:05.4674392Z           base_prompt=base_prompt,
2025-11-28T17:41:05.4674790Z           tenant_id=tenant_id,
2025-11-28T17:41:05.4675164Z           project_id=project_id,
2025-11-28T17:41:05.4675584Z           query="How should I handle user input?",
2025-11-28T17:41:05.4676006Z       )
2025-11-28T17:41:05.4676162Z 
2025-11-28T17:41:05.4676296Z       # 3. Verify injection
2025-11-28T17:41:05.4676841Z       assert len(enhanced_prompt) > len(base_prompt), "Prompt should be enhanced"
2025-11-28T17:41:05.4677757Z       assert "Lessons Learned" in enhanced_prompt or "lessons learned" in enhanced_prompt.lower(), \
2025-11-28T17:41:05.4678510Z           "Should include lessons learned section"
2025-11-28T17:41:05.4679418Z       assert "validate user input" in enhanced_prompt.lower(), "Should include reflection content"
2025-11-28T17:41:05.4680605Z file /home/runner/work/RAE-agentic-memory/RAE-agentic-memory/tests/integration/test_reflection_flow.py, line 53
2025-11-28T17:41:05.4681469Z   @pytest.fixture
2025-11-28T17:41:05.4681964Z   async def context_builder(db_pool, memory_repo, reflection_engine):
2025-11-28T17:41:05.4682542Z       """Context builder"""
2025-11-28T17:41:05.4682920Z       config = ContextConfig(
2025-11-28T17:41:05.4683306Z           max_reflection_items=5,
2025-11-28T17:41:05.4683710Z           min_reflection_importance=0.5,
2025-11-28T17:41:05.4684358Z           enable_enhanced_scoring=True,
2025-11-28T17:41:05.4684785Z       )
2025-11-28T17:41:05.4685248Z       return ContextBuilder(db_pool, memory_repo, reflection_engine, config)
2025-11-28T17:41:05.4686300Z file /home/runner/work/RAE-agentic-memory/RAE-agentic-memory/tests/integration/test_reflection_flow.py, line 35
2025-11-28T17:41:05.4687165Z   @pytest.fixture
2025-11-28T17:41:05.4687509Z   async def db_pool(postgresql_pool):
2025-11-28T17:41:05.4687935Z       """Database connection pool"""
2025-11-28T17:41:05.4688350Z       return postgresql_pool
2025-11-28T17:41:05.4688890Z [31mE       fixture 'postgresql_pool' not found[0m
2025-11-28T17:41:05.4694837Z [31m>       available fixtures: _class_scoped_runner, _function_scoped_runner, _module_scoped_runner, _package_scoped_runner, _session_scoped_runner, anyio_backend, anyio_backend_name, anyio_backend_options, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, capteesys, class_mocker, context_builder, cov, db_pool, doctest_namespace, event_loop_policy, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, memory_repo, mock_app_state_pool, mock_env_and_settings, mocker, module_mocker, monkeypatch, no_cover, override_auth, package_mocker, project_id, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, reflection_engine, session_mocker, subtests, tenant_id, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory[0m
2025-11-28T17:41:05.4700222Z [31m>       use 'pytest --fixtures [testpath]' for help on them.[0m
2025-11-28T17:41:05.4700635Z 
2025-11-28T17:41:05.4701151Z /home/runner/work/RAE-agentic-memory/RAE-agentic-memory/tests/integration/test_reflection_flow.py:35
2025-11-28T17:41:05.4702289Z [31m[1m______________ ERROR at setup of test_end_to_end_reflection_flow _______________[0m
2025-11-28T17:41:05.4703357Z file /home/runner/work/RAE-agentic-memory/RAE-agentic-memory/tests/integration/test_reflection_flow.py, line 393
2025-11-28T17:41:05.4704237Z   @pytest.mark.asyncio
2025-11-28T17:41:05.4704617Z   async def test_end_to_end_reflection_flow(
2025-11-28T17:41:05.4705066Z       reflection_engine,
2025-11-28T17:41:05.4705408Z       context_builder,
2025-11-28T17:41:05.4705726Z       memory_repo,
2025-11-28T17:41:05.4706032Z       tenant_id,
2025-11-28T17:41:05.4706331Z       project_id,
2025-11-28T17:41:05.4706613Z   ):
2025-11-28T17:41:05.4706870Z       """
2025-11-28T17:41:05.4707172Z       Test complete end-to-end flow:
2025-11-28T17:41:05.4707593Z       1. Task fails with error
2025-11-28T17:41:05.4708006Z       2. Reflection generated and stored
2025-11-28T17:41:05.4708458Z       3. Next task retrieves reflection
2025-11-28T17:41:05.4708894Z       4. Reflection influences behavior
2025-11-28T17:41:05.4709441Z       """
2025-11-28T17:41:05.4709764Z       # === Phase 1: First execution fails ===
2025-11-28T17:41:05.4710078Z 
2025-11-28T17:41:05.4710219Z       # Simulate tool error
2025-11-28T17:41:05.4710578Z       events_fail = [
2025-11-28T17:41:05.4710889Z           Event(
2025-11-28T17:41:05.4711194Z               event_id="evt_1",
2025-11-28T17:41:05.4711589Z               event_type=EventType.TOOL_CALL,
2025-11-28T17:41:05.4712060Z               timestamp=datetime.now(timezone.utc),
2025-11-28T17:41:05.4712612Z               content="Calling API without authentication header",
2025-11-28T17:41:05.4713146Z               metadata={"tool": "http_client"},
2025-11-28T17:41:05.4713587Z               tool_name="http_client",
2025-11-28T17:41:05.4713982Z           ),
2025-11-28T17:41:05.4714261Z           Event(
2025-11-28T17:41:05.4714562Z               event_id="evt_2",
2025-11-28T17:41:05.4714961Z               event_type=EventType.ERROR_EVENT,
2025-11-28T17:41:05.4715440Z               timestamp=datetime.now(timezone.utc),
2025-11-28T17:41:05.4715896Z               content="401 Unauthorized",
2025-11-28T17:41:05.4716354Z               metadata={"error_code": "UNAUTHORIZED"},
2025-11-28T17:41:05.4717046Z               error={"type": "AuthError", "code": "401"},
2025-11-28T17:41:05.4717473Z           ),
2025-11-28T17:41:05.4717744Z       ]
2025-11-28T17:41:05.4717897Z 
2025-11-28T17:41:05.4718026Z       error = ErrorInfo(
2025-11-28T17:41:05.4718370Z           error_code="401",
2025-11-28T17:41:05.4718814Z           error_category=ErrorCategory.PERMISSION_ERROR,
2025-11-28T17:41:05.4719779Z           error_message="API call failed: 401 Unauthorized",
2025-11-28T17:41:05.4720444Z           tool_name="http_client",
2025-11-28T17:41:05.4721037Z       )
2025-11-28T17:41:05.4721265Z 
2025-11-28T17:41:05.4721579Z       context_fail = ReflectionContext(
2025-11-28T17:41:05.4722097Z           events=events_fail,
2025-11-28T17:41:05.4722681Z           outcome=OutcomeType.FAILURE,
2025-11-28T17:41:05.4723261Z           error=error,
2025-11-28T17:41:05.4723712Z           task_description="Call external API",
2025-11-28T17:41:05.4724405Z           task_goal="Fetch data from API",
2025-11-28T17:41:05.4725096Z           tenant_id=tenant_id,
2025-11-28T17:41:05.4782875Z           project_id=project_id,
2025-11-28T17:41:05.4783178Z       )
2025-11-28T17:41:05.4783280Z 
2025-11-28T17:41:05.4783380Z       # Generate and store reflection
2025-11-28T17:41:05.4783725Z       result = await reflection_engine.generate_reflection(context_fail)
2025-11-28T17:41:05.4784300Z       stored_ids = await reflection_engine.store_reflection(
2025-11-28T17:41:05.4784665Z           result=result, tenant_id=tenant_id, project_id=project_id
2025-11-28T17:41:05.4784952Z       )
2025-11-28T17:41:05.4785039Z 
2025-11-28T17:41:05.4785147Z       reflection_id = stored_ids["reflection_id"]
2025-11-28T17:41:05.4785408Z       assert reflection_id is not None
2025-11-28T17:41:05.4785570Z 
2025-11-28T17:41:05.4785686Z       # === Phase 2: Second execution retrieves lesson ===
2025-11-28T17:41:05.4785928Z 
2025-11-28T17:41:05.4786018Z       # Build context for similar task
2025-11-28T17:41:05.4786288Z       query = "I need to call the external API again"
2025-11-28T17:41:05.4786605Z       working_memory = await context_builder.build_context(
2025-11-28T17:41:05.4786959Z           tenant_id=tenant_id, project_id=project_id, query=query
2025-11-28T17:41:05.4787236Z       )
2025-11-28T17:41:05.4787322Z 
2025-11-28T17:41:05.4787412Z       # Verify reflection is available
2025-11-28T17:41:05.4787787Z       assert len(working_memory.reflections) >= 1, "Should retrieve previous reflection"
2025-11-28T17:41:05.4788084Z 
2025-11-28T17:41:05.4788169Z       # Check if our reflection is there
2025-11-28T17:41:05.4788406Z       our_refl = next(
2025-11-28T17:41:05.4788713Z           (r for r in working_memory.reflections if r.metadata.get("id") == reflection_id),
2025-11-28T17:41:05.4789053Z           None,
2025-11-28T17:41:05.4789434Z       )
2025-11-28T17:41:05.4789671Z       assert our_refl is not None, "Our reflection should be retrieved"
2025-11-28T17:41:05.4789911Z 
2025-11-28T17:41:05.4790024Z       # === Phase 3: Verify reflection is actionable ===
2025-11-28T17:41:05.4790222Z 
2025-11-28T17:41:05.4790367Z       # The reflection should mention authentication or auth header
2025-11-28T17:41:05.4790658Z       assert any(
2025-11-28T17:41:05.4790854Z           keyword in our_refl.content.lower()
2025-11-28T17:41:05.4791168Z           for keyword in ["auth", "unauthorized", "401", "header", "token"]
2025-11-28T17:41:05.4791508Z       ), "Reflection should mention authentication issue"
2025-11-28T17:41:05.4791698Z 
2025-11-28T17:41:05.4791818Z       # If strategy was generated, it should be actionable
2025-11-28T17:41:05.4792081Z       if result.strategy_text:
2025-11-28T17:41:05.4792382Z           assert len(result.strategy_text) > 10, "Strategy should be meaningful"
2025-11-28T17:41:05.4792950Z file /home/runner/work/RAE-agentic-memory/RAE-agentic-memory/tests/integration/test_reflection_flow.py, line 47
2025-11-28T17:41:05.4793409Z   @pytest.fixture
2025-11-28T17:41:05.4793628Z   async def reflection_engine(db_pool, memory_repo):
2025-11-28T17:41:05.4794041Z       """Reflection engine v2"""
2025-11-28T17:41:05.4794286Z       return ReflectionEngineV2(db_pool, memory_repo)
2025-11-28T17:41:05.4794782Z file /home/runner/work/RAE-agentic-memory/RAE-agentic-memory/tests/integration/test_reflection_flow.py, line 35
2025-11-28T17:41:05.4795240Z   @pytest.fixture
2025-11-28T17:41:05.4795436Z   async def db_pool(postgresql_pool):
2025-11-28T17:41:05.4795679Z       """Database connection pool"""
2025-11-28T17:41:05.4795908Z       return postgresql_pool
2025-11-28T17:41:05.4796245Z [31mE       fixture 'postgresql_pool' not found[0m
2025-11-28T17:41:05.4799381Z [31m>       available fixtures: _class_scoped_runner, _function_scoped_runner, _module_scoped_runner, _package_scoped_runner, _session_scoped_runner, anyio_backend, anyio_backend_name, anyio_backend_options, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, capteesys, class_mocker, context_builder, cov, db_pool, doctest_namespace, event_loop_policy, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, memory_repo, mock_app_state_pool, mock_env_and_settings, mocker, module_mocker, monkeypatch, no_cover, override_auth, package_mocker, project_id, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, reflection_engine, session_mocker, subtests, tenant_id, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory[0m
2025-11-28T17:41:05.4802161Z [31m>       use 'pytest --fixtures [testpath]' for help on them.[0m
2025-11-28T17:41:05.4802382Z 
2025-11-28T17:41:05.4802666Z /home/runner/work/RAE-agentic-memory/RAE-agentic-memory/tests/integration/test_reflection_flow.py:35
2025-11-28T17:41:05.4803138Z =================================== FAILURES ===================================
2025-11-28T17:41:05.4803622Z [31m[1m___ TestReflectiveMemoryFlags.test_reflective_memory_disabled_no_reflections ___[0m
2025-11-28T17:41:05.4804285Z [1m[31mapps/memory_api/tests/test_reflective_flags.py[0m:40: in test_reflective_memory_disabled_no_reflections
2025-11-28T17:41:05.4805145Z     [0mcontext_builder.reflection_engine.query_reflections.assert_not_called()[90m[39;49;00m
2025-11-28T17:41:05.4805994Z     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.4806450Z [1m[31mE   AttributeError: 'function' object has no attribute 'assert_not_called'[0m
2025-11-28T17:41:05.4806879Z ----------------------------- Captured stdout call -----------------------------
2025-11-28T17:41:05.4807726Z {"tenant_id": "test_tenant", "reason": "reflective_memory_disabled", "event": "reflections_retrieval_skipped", "level": "info", "logger": "apps.memory_api.services.context_builder", "timestamp": "2025-11-28T17:40:01.261066Z"}
2025-11-28T17:41:05.4808499Z ------------------------------ Captured log call -------------------------------
2025-11-28T17:41:05.4809840Z [32mINFO    [0m apps.memory_api.services.context_builder:context_builder.py:351 {'tenant_id': 'test_tenant', 'reason': 'reflective_memory_disabled', 'event': 'reflections_retrieval_skipped', 'level': 'info', 'logger': 'apps.memory_api.services.context_builder', 'timestamp': '2025-11-28T17:40:01.261066Z'}
2025-11-28T17:41:05.4810984Z [31m[1m___________ TestDreamingEnabled.test_dreaming_enabled_runs_dreaming ____________[0m
2025-11-28T17:41:05.4811609Z [1m[31mapps/memory_api/tests/test_reflective_flags.py[0m:192: in test_dreaming_enabled_runs_dreaming
2025-11-28T17:41:05.4812194Z     [0mresults = [94mawait[39;49;00m dreaming_worker.run_dreaming_cycle([90m[39;49;00m
2025-11-28T17:41:05.4812721Z [1m[31mapps/memory_api/workers/memory_maintenance.py[0m:369: in run_dreaming_cycle
2025-11-28T17:41:05.4813335Z     [0m[94masync[39;49;00m [94mwith[39;49;00m [96mself[39;49;00m.pool.acquire() [94mas[39;49;00m conn:[90m[39;49;00m
2025-11-28T17:41:05.4813976Z [1m[31mE   TypeError: 'coroutine' object does not support the asynchronous context manager protocol[0m
2025-11-28T17:41:05.4814590Z ----------------------------- Captured stdout call -----------------------------
2025-11-28T17:41:05.4815583Z {"tenant_id": "test_tenant", "project_id": "test_project", "lookback_hours": 24, "mode": "<MagicMock name='settings.REFLECTIVE_MEMORY_MODE' id='139635317750672'>", "event": "dreaming_cycle_started", "level": "info", "logger": "apps.memory_api.workers.memory_maintenance", "timestamp": "2025-11-28T17:40:01.637602Z"}
2025-11-28T17:41:05.4816568Z ------------------------------ Captured log call -------------------------------
2025-11-28T17:41:05.4818025Z [32mINFO    [0m apps.memory_api.workers.memory_maintenance:memory_maintenance.py:358 {'tenant_id': 'test_tenant', 'project_id': 'test_project', 'lookback_hours': 24, 'mode': <MagicMock name='settings.REFLECTIVE_MEMORY_MODE' id='139635317750672'>, 'event': 'dreaming_cycle_started', 'level': 'info', 'logger': 'apps.memory_api.workers.memory_maintenance', 'timestamp': '2025-11-28T17:40:01.637602Z'}
2025-11-28T17:41:05.4819545Z [31m[1m__________________________ test_agent_execute_direct ___________________________[0m
2025-11-28T17:41:05.4820031Z [1m[31mtests/api/v1/test_agent.py[0m:10: in test_agent_execute_direct
2025-11-28T17:41:05.4822543Z     [0m[94mwith[39;49;00m patch([33m"[39;49;00m[33mapps.memory_api.api.v1.agent.get_context_cache[39;49;00m[33m"[39;49;00m) [94mas[39;49;00m mock_get_cache,          patch([33m"[39;49;00m[33mapps.memory_api.api.v1.agent.get_embedding_service[39;49;00m[33m"[39;49;00m) [94mas[39;49;00m mock_embed,          patch([33m"[39;49;00m[33mapps.memory_api.api.v1.agent.get_vector_store[39;49;00m[33m"[39;49;00m) [94mas[39;49;00m mock_vec,          patch([33m"[39;49;00m[33mapps.memory_api.api.v1.agent.get_llm_provider[39;49;00m[33m"[39;49;00m) [94mas[39;49;00m mock_llm,          patch([33m"[39;49;00m[33mapps.memory_api.api.v1.agent._update_memory_access_stats[39;49;00m[33m"[39;49;00m, new=AsyncMock()),          patch([33m"[39;49;00m[33mhttpx.AsyncClient[39;49;00m[33m"[39;49;00m) [94mas[39;49;00m mock_httpx:[90m[39;49;00m
2025-11-28T17:41:05.4824813Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/unittest/mock.py[0m:1446: in __enter__
2025-11-28T17:41:05.4825377Z     [0moriginal, local = [96mself[39;49;00m.get_original()[90m[39;49;00m
2025-11-28T17:41:05.4825752Z                       ^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.4826262Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/unittest/mock.py[0m:1419: in get_original
2025-11-28T17:41:05.4826806Z     [0m[94mraise[39;49;00m [96mAttributeError[39;49;00m([90m[39;49;00m
2025-11-28T17:41:05.4827752Z [1m[31mE   AttributeError: <module 'apps.memory_api.api.v1.agent' from '/home/runner/work/RAE-agentic-memory/RAE-agentic-memory/apps/memory_api/api/v1/agent.py'> does not have the attribute 'get_context_cache'[0m
2025-11-28T17:41:05.4828658Z [31m[1m_______________________ test_agent_execute_with_context ________________________[0m
2025-11-28T17:41:05.4829259Z [1m[31mtests/api/v1/test_agent.py[0m:58: in test_agent_execute_with_context
2025-11-28T17:41:05.4829985Z     [0m[94mwith[39;49;00m patch([33m"[39;49;00m[33mapps.memory_api.api.v1.agent.get_context_cache[39;49;00m[33m"[39;49;00m) [94mas[39;49;00m mock_get_cache, \
2025-11-28T17:41:05.4830742Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/unittest/mock.py[0m:1446: in __enter__
2025-11-28T17:41:05.4831289Z     [0moriginal, local = [96mself[39;49;00m.get_original()[90m[39;49;00m
2025-11-28T17:41:05.4831652Z                       ^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.4832145Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/unittest/mock.py[0m:1419: in get_original
2025-11-28T17:41:05.4832683Z     [0m[94mraise[39;49;00m [96mAttributeError[39;49;00m([90m[39;49;00m
2025-11-28T17:41:05.4833613Z [1m[31mE   AttributeError: <module 'apps.memory_api.api.v1.agent' from '/home/runner/work/RAE-agentic-memory/RAE-agentic-memory/apps/memory_api/api/v1/agent.py'> does not have the attribute 'get_context_cache'[0m
2025-11-28T17:41:05.4834632Z [31m[1m_____________________ test_agent_execute_with_empty_prompt _____________________[0m
2025-11-28T17:41:05.4835133Z [1m[31mtests/api/v1/test_agent.py[0m:111: in test_agent_execute_with_empty_prompt
2025-11-28T17:41:05.4835870Z     [0m[94mwith[39;49;00m patch([33m"[39;49;00m[33mapps.memory_api.api.v1.agent.get_context_cache[39;49;00m[33m"[39;49;00m) [94mas[39;49;00m mock_get_cache, \
2025-11-28T17:41:05.4836623Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/unittest/mock.py[0m:1446: in __enter__
2025-11-28T17:41:05.4837167Z     [0moriginal, local = [96mself[39;49;00m.get_original()[90m[39;49;00m
2025-11-28T17:41:05.4837528Z                       ^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.4838020Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/unittest/mock.py[0m:1419: in get_original
2025-11-28T17:41:05.4838561Z     [0m[94mraise[39;49;00m [96mAttributeError[39;49;00m([90m[39;49;00m
2025-11-28T17:41:05.4839609Z [1m[31mE   AttributeError: <module 'apps.memory_api.api.v1.agent' from '/home/runner/work/RAE-agentic-memory/RAE-agentic-memory/apps/memory_api/api/v1/agent.py'> does not have the attribute 'get_context_cache'[0m
2025-11-28T17:41:05.4840502Z [31m[1m______________________ test_agent_execute_with_llm_error _______________________[0m
2025-11-28T17:41:05.4841115Z [1m[31mtests/api/v1/test_agent.py[0m:163: in test_agent_execute_with_llm_error
2025-11-28T17:41:05.4841838Z     [0m[94mwith[39;49;00m patch([33m"[39;49;00m[33mapps.memory_api.api.v1.agent.get_context_cache[39;49;00m[33m"[39;49;00m) [94mas[39;49;00m mock_get_cache, \
2025-11-28T17:41:05.4842588Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/unittest/mock.py[0m:1446: in __enter__
2025-11-28T17:41:05.4843125Z     [0moriginal, local = [96mself[39;49;00m.get_original()[90m[39;49;00m
2025-11-28T17:41:05.4843485Z                       ^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.4843988Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/unittest/mock.py[0m:1419: in get_original
2025-11-28T17:41:05.4844531Z     [0m[94mraise[39;49;00m [96mAttributeError[39;49;00m([90m[39;49;00m
2025-11-28T17:41:05.4845457Z [1m[31mE   AttributeError: <module 'apps.memory_api.api.v1.agent' from '/home/runner/work/RAE-agentic-memory/RAE-agentic-memory/apps/memory_api/api/v1/agent.py'> does not have the attribute 'get_context_cache'[0m
2025-11-28T17:41:05.4846357Z [31m[1m_______________________ test_governance_overview_success _______________________[0m
2025-11-28T17:41:05.4846865Z [1m[31mtests/api/v1/test_governance.py[0m:40: in test_governance_overview_success
2025-11-28T17:41:05.4847392Z     [0m[94massert[39;49;00m response.status_code == [94m200[39;49;00m[90m[39;49;00m
2025-11-28T17:41:05.4847761Z [1m[31mE   assert 401 == 200[0m
2025-11-28T17:41:05.4848105Z [1m[31mE    +  where 401 = <Response [401 Unauthorized]>.status_code[0m
2025-11-28T17:41:05.4848478Z ----------------------------- Captured stdout call -----------------------------
2025-11-28T17:41:05.4849430Z {"status_code": 401, "detail": "Authentication required for admin access", "path": "/v1/governance/overview", "method": "GET", "event": "http_exception", "level": "warning", "logger": "apps.memory_api.main", "timestamp": "2025-11-28T17:40:02.493860Z"}
2025-11-28T17:41:05.4850265Z ------------------------------ Captured log call -------------------------------
2025-11-28T17:41:05.4851398Z [33mWARNING [0m apps.memory_api.main:main.py:194 {'status_code': 401, 'detail': 'Authentication required for admin access', 'path': '/v1/governance/overview', 'method': 'GET', 'event': 'http_exception', 'level': 'warning', 'logger': 'apps.memory_api.main', 'timestamp': '2025-11-28T17:40:02.493860Z'}
2025-11-28T17:41:05.4852442Z [31m[1m__________________ test_governance_overview_with_custom_days ___________________[0m
2025-11-28T17:41:05.4852978Z [1m[31mtests/api/v1/test_governance.py[0m:72: in test_governance_overview_with_custom_days
2025-11-28T17:41:05.4853631Z     [0m[94massert[39;49;00m response.status_code == [94m200[39;49;00m[90m[39;49;00m
2025-11-28T17:41:05.4853996Z [1m[31mE   assert 401 == 200[0m
2025-11-28T17:41:05.4854324Z [1m[31mE    +  where 401 = <Response [401 Unauthorized]>.status_code[0m
2025-11-28T17:41:05.4854710Z ----------------------------- Captured stdout call -----------------------------
2025-11-28T17:41:05.4855544Z {"status_code": 401, "detail": "Authentication required for admin access", "path": "/v1/governance/overview", "method": "GET", "event": "http_exception", "level": "warning", "logger": "apps.memory_api.main", "timestamp": "2025-11-28T17:40:02.521654Z"}
2025-11-28T17:41:05.4856359Z ------------------------------ Captured log call -------------------------------
2025-11-28T17:41:05.4857514Z [33mWARNING [0m apps.memory_api.main:main.py:194 {'status_code': 401, 'detail': 'Authentication required for admin access', 'path': '/v1/governance/overview', 'method': 'GET', 'event': 'http_exception', 'level': 'warning', 'logger': 'apps.memory_api.main', 'timestamp': '2025-11-28T17:40:02.521654Z'}
2025-11-28T17:41:05.4858561Z [31m[1m________________________ test_governance_overview_error ________________________[0m
2025-11-28T17:41:05.4859065Z [1m[31mtests/api/v1/test_governance.py[0m:88: in test_governance_overview_error
2025-11-28T17:41:05.4859942Z     [0m[94massert[39;49;00m response.status_code == [94m500[39;49;00m[90m[39;49;00m
2025-11-28T17:41:05.4860315Z [1m[31mE   assert 401 == 500[0m
2025-11-28T17:41:05.4860663Z [1m[31mE    +  where 401 = <Response [401 Unauthorized]>.status_code[0m
2025-11-28T17:41:05.4861030Z ----------------------------- Captured stdout call -----------------------------
2025-11-28T17:41:05.4861868Z {"status_code": 401, "detail": "Authentication required for admin access", "path": "/v1/governance/overview", "method": "GET", "event": "http_exception", "level": "warning", "logger": "apps.memory_api.main", "timestamp": "2025-11-28T17:40:02.548358Z"}
2025-11-28T17:41:05.4862694Z ------------------------------ Captured log call -------------------------------
2025-11-28T17:41:05.4863821Z [33mWARNING [0m apps.memory_api.main:main.py:194 {'status_code': 401, 'detail': 'Authentication required for admin access', 'path': '/v1/governance/overview', 'method': 'GET', 'event': 'http_exception', 'level': 'warning', 'logger': 'apps.memory_api.main', 'timestamp': '2025-11-28T17:40:02.548358Z'}
2025-11-28T17:41:05.4864879Z [31m[1m_____________________ test_tenant_governance_stats_success _____________________[0m
2025-11-28T17:41:05.4865410Z [1m[31mtests/api/v1/test_governance.py[0m:131: in test_tenant_governance_stats_success
2025-11-28T17:41:05.4865936Z     [0m[94massert[39;49;00m response.status_code == [94m200[39;49;00m[90m[39;49;00m
2025-11-28T17:41:05.4866302Z [1m[31mE   assert 401 == 200[0m
2025-11-28T17:41:05.4866635Z [1m[31mE    +  where 401 = <Response [401 Unauthorized]>.status_code[0m
2025-11-28T17:41:05.4867006Z ----------------------------- Captured stdout call -----------------------------
2025-11-28T17:41:05.4867637Z {"tenant_id": "test-tenant", "event": "check_tenant_access_no_user_id", "level": "warning", "logger": "apps.memory_api.security.auth", "timestamp": "2025-11-28T17:40:02.578123Z"}
2025-11-28T17:41:05.4868762Z {"status_code": 401, "detail": "Authentication required to access tenant", "path": "/v1/governance/tenant/test-tenant", "method": "GET", "event": "http_exception", "level": "warning", "logger": "apps.memory_api.main", "timestamp": "2025-11-28T17:40:02.578369Z"}
2025-11-28T17:41:05.4869731Z ------------------------------ Captured log call -------------------------------
2025-11-28T17:41:05.4870667Z [33mWARNING [0m apps.memory_api.security.auth:auth.py:218 {'tenant_id': 'test-tenant', 'event': 'check_tenant_access_no_user_id', 'level': 'warning', 'logger': 'apps.memory_api.security.auth', 'timestamp': '2025-11-28T17:40:02.578123Z'}
2025-11-28T17:41:05.4872393Z [33mWARNING [0m apps.memory_api.main:main.py:194 {'status_code': 401, 'detail': 'Authentication required to access tenant', 'path': '/v1/governance/tenant/test-tenant', 'method': 'GET', 'event': 'http_exception', 'level': 'warning', 'logger': 'apps.memory_api.main', 'timestamp': '2025-11-28T17:40:02.578369Z'}
2025-11-28T17:41:05.4873468Z [31m[1m_____________________ test_tenant_governance_stats_no_data _____________________[0m
2025-11-28T17:41:05.4873991Z [1m[31mtests/api/v1/test_governance.py[0m:161: in test_tenant_governance_stats_no_data
2025-11-28T17:41:05.4874518Z     [0m[94massert[39;49;00m response.status_code == [94m404[39;49;00m[90m[39;49;00m
2025-11-28T17:41:05.4874880Z [1m[31mE   assert 401 == 404[0m
2025-11-28T17:41:05.4875209Z [1m[31mE    +  where 401 = <Response [401 Unauthorized]>.status_code[0m
2025-11-28T17:41:05.4875565Z ----------------------------- Captured stdout call -----------------------------
2025-11-28T17:41:05.4876229Z {"tenant_id": "nonexistent-tenant", "event": "check_tenant_access_no_user_id", "level": "warning", "logger": "apps.memory_api.security.auth", "timestamp": "2025-11-28T17:40:02.605477Z"}
2025-11-28T17:41:05.4877416Z {"status_code": 401, "detail": "Authentication required to access tenant", "path": "/v1/governance/tenant/nonexistent-tenant", "method": "GET", "event": "http_exception", "level": "warning", "logger": "apps.memory_api.main", "timestamp": "2025-11-28T17:40:02.605715Z"}
2025-11-28T17:41:05.4878412Z ------------------------------ Captured log call -------------------------------
2025-11-28T17:41:05.4879479Z [33mWARNING [0m apps.memory_api.security.auth:auth.py:218 {'tenant_id': 'nonexistent-tenant', 'event': 'check_tenant_access_no_user_id', 'level': 'warning', 'logger': 'apps.memory_api.security.auth', 'timestamp': '2025-11-28T17:40:02.605477Z'}
2025-11-28T17:41:05.4881135Z [33mWARNING [0m apps.memory_api.main:main.py:194 {'status_code': 401, 'detail': 'Authentication required to access tenant', 'path': '/v1/governance/tenant/nonexistent-tenant', 'method': 'GET', 'event': 'http_exception', 'level': 'warning', 'logger': 'apps.memory_api.main', 'timestamp': '2025-11-28T17:40:02.605715Z'}
2025-11-28T17:41:05.4882262Z [31m[1m_______________ test_tenant_governance_stats_with_custom_period ________________[0m
2025-11-28T17:41:05.4882837Z [1m[31mtests/api/v1/test_governance.py[0m:194: in test_tenant_governance_stats_with_custom_period
2025-11-28T17:41:05.4883394Z     [0m[94massert[39;49;00m response.status_code == [94m200[39;49;00m[90m[39;49;00m
2025-11-28T17:41:05.4883761Z [1m[31mE   assert 401 == 200[0m
2025-11-28T17:41:05.4884103Z [1m[31mE    +  where 401 = <Response [401 Unauthorized]>.status_code[0m
2025-11-28T17:41:05.4884471Z ----------------------------- Captured stdout call -----------------------------
2025-11-28T17:41:05.4885106Z {"tenant_id": "test-tenant", "event": "check_tenant_access_no_user_id", "level": "warning", "logger": "apps.memory_api.security.auth", "timestamp": "2025-11-28T17:40:02.633933Z"}
2025-11-28T17:41:05.4886224Z {"status_code": 401, "detail": "Authentication required to access tenant", "path": "/v1/governance/tenant/test-tenant", "method": "GET", "event": "http_exception", "level": "warning", "logger": "apps.memory_api.main", "timestamp": "2025-11-28T17:40:02.634183Z"}
2025-11-28T17:41:05.4887075Z ------------------------------ Captured log call -------------------------------
2025-11-28T17:41:05.4888009Z [33mWARNING [0m apps.memory_api.security.auth:auth.py:218 {'tenant_id': 'test-tenant', 'event': 'check_tenant_access_no_user_id', 'level': 'warning', 'logger': 'apps.memory_api.security.auth', 'timestamp': '2025-11-28T17:40:02.633933Z'}
2025-11-28T17:41:05.4889780Z [33mWARNING [0m apps.memory_api.main:main.py:194 {'status_code': 401, 'detail': 'Authentication required to access tenant', 'path': '/v1/governance/tenant/test-tenant', 'method': 'GET', 'event': 'http_exception', 'level': 'warning', 'logger': 'apps.memory_api.main', 'timestamp': '2025-11-28T17:40:02.634183Z'}
2025-11-28T17:41:05.4890996Z [31m[1m______________________ test_tenant_budget_status_success _______________________[0m
2025-11-28T17:41:05.4891513Z [1m[31mtests/api/v1/test_governance.py[0m:214: in test_tenant_budget_status_success
2025-11-28T17:41:05.4892039Z     [0m[94massert[39;49;00m response.status_code == [94m200[39;49;00m[90m[39;49;00m
2025-11-28T17:41:05.4892411Z [1m[31mE   assert 401 == 200[0m
2025-11-28T17:41:05.4892816Z [1m[31mE    +  where 401 = <Response [401 Unauthorized]>.status_code[0m
2025-11-28T17:41:05.4893473Z ----------------------------- Captured stdout call -----------------------------
2025-11-28T17:41:05.4894589Z {"tenant_id": "test-tenant", "event": "check_tenant_access_no_user_id", "level": "warning", "logger": "apps.memory_api.security.auth", "timestamp": "2025-11-28T17:40:02.661405Z"}
2025-11-28T17:41:05.4896408Z {"status_code": 401, "detail": "Authentication required to access tenant", "path": "/v1/governance/tenant/test-tenant/budget", "method": "GET", "event": "http_exception", "level": "warning", "logger": "apps.memory_api.main", "timestamp": "2025-11-28T17:40:02.661647Z"}
2025-11-28T17:41:05.4897296Z ------------------------------ Captured log call -------------------------------
2025-11-28T17:41:05.4898253Z [33mWARNING [0m apps.memory_api.security.auth:auth.py:218 {'tenant_id': 'test-tenant', 'event': 'check_tenant_access_no_user_id', 'level': 'warning', 'logger': 'apps.memory_api.security.auth', 'timestamp': '2025-11-28T17:40:02.661405Z'}
2025-11-28T17:41:05.4900285Z [33mWARNING [0m apps.memory_api.main:main.py:194 {'status_code': 401, 'detail': 'Authentication required to access tenant', 'path': '/v1/governance/tenant/test-tenant/budget', 'method': 'GET', 'event': 'http_exception', 'level': 'warning', 'logger': 'apps.memory_api.main', 'timestamp': '2025-11-28T17:40:02.661647Z'}
2025-11-28T17:41:05.4901401Z [31m[1m____________________ test_tenant_budget_status_with_alerts _____________________[0m
2025-11-28T17:41:05.4901941Z [1m[31mtests/api/v1/test_governance.py[0m:240: in test_tenant_budget_status_with_alerts
2025-11-28T17:41:05.4902477Z     [0m[94massert[39;49;00m response.status_code == [94m200[39;49;00m[90m[39;49;00m
2025-11-28T17:41:05.4902854Z [1m[31mE   assert 401 == 200[0m
2025-11-28T17:41:05.4903199Z [1m[31mE    +  where 401 = <Response [401 Unauthorized]>.status_code[0m
2025-11-28T17:41:05.4903569Z ----------------------------- Captured stdout call -----------------------------
2025-11-28T17:41:05.4904216Z {"tenant_id": "test-tenant", "event": "check_tenant_access_no_user_id", "level": "warning", "logger": "apps.memory_api.security.auth", "timestamp": "2025-11-28T17:40:02.689466Z"}
2025-11-28T17:41:05.4905361Z {"status_code": 401, "detail": "Authentication required to access tenant", "path": "/v1/governance/tenant/test-tenant/budget", "method": "GET", "event": "http_exception", "level": "warning", "logger": "apps.memory_api.main", "timestamp": "2025-11-28T17:40:02.689696Z"}
2025-11-28T17:41:05.4906238Z ------------------------------ Captured log call -------------------------------
2025-11-28T17:41:05.4907176Z [33mWARNING [0m apps.memory_api.security.auth:auth.py:218 {'tenant_id': 'test-tenant', 'event': 'check_tenant_access_no_user_id', 'level': 'warning', 'logger': 'apps.memory_api.security.auth', 'timestamp': '2025-11-28T17:40:02.689466Z'}
2025-11-28T17:41:05.4908790Z [33mWARNING [0m apps.memory_api.main:main.py:194 {'status_code': 401, 'detail': 'Authentication required to access tenant', 'path': '/v1/governance/tenant/test-tenant/budget', 'method': 'GET', 'event': 'http_exception', 'level': 'warning', 'logger': 'apps.memory_api.main', 'timestamp': '2025-11-28T17:40:02.689696Z'}
2025-11-28T17:41:05.4910010Z [31m[1m_____________________ test_tenant_budget_status_zero_usage _____________________[0m
2025-11-28T17:41:05.4910538Z [1m[31mtests/api/v1/test_governance.py[0m:261: in test_tenant_budget_status_zero_usage
2025-11-28T17:41:05.4911071Z     [0m[94massert[39;49;00m response.status_code == [94m200[39;49;00m[90m[39;49;00m
2025-11-28T17:41:05.4911588Z [1m[31mE   assert 401 == 200[0m
2025-11-28T17:41:05.4911924Z [1m[31mE    +  where 401 = <Response [401 Unauthorized]>.status_code[0m
2025-11-28T17:41:05.4912292Z ----------------------------- Captured stdout call -----------------------------
2025-11-28T17:41:05.4912938Z {"tenant_id": "new-tenant", "event": "check_tenant_access_no_user_id", "level": "warning", "logger": "apps.memory_api.security.auth", "timestamp": "2025-11-28T17:40:02.716807Z"}
2025-11-28T17:41:05.4914248Z {"status_code": 401, "detail": "Authentication required to access tenant", "path": "/v1/governance/tenant/new-tenant/budget", "method": "GET", "event": "http_exception", "level": "warning", "logger": "apps.memory_api.main", "timestamp": "2025-11-28T17:40:02.717072Z"}
2025-11-28T17:41:05.4915786Z ------------------------------ Captured log call -------------------------------
2025-11-28T17:41:05.4917349Z [33mWARNING [0m apps.memory_api.security.auth:auth.py:218 {'tenant_id': 'new-tenant', 'event': 'check_tenant_access_no_user_id', 'level': 'warning', 'logger': 'apps.memory_api.security.auth', 'timestamp': '2025-11-28T17:40:02.716807Z'}
2025-11-28T17:41:05.4920667Z [33mWARNING [0m apps.memory_api.main:main.py:194 {'status_code': 401, 'detail': 'Authentication required to access tenant', 'path': '/v1/governance/tenant/new-tenant/budget', 'method': 'GET', 'event': 'http_exception', 'level': 'warning', 'logger': 'apps.memory_api.main', 'timestamp': '2025-11-28T17:40:02.717072Z'}
2025-11-28T17:41:05.4923438Z [31m[1m_______________________ test_tenant_budget_status_error ________________________[0m
2025-11-28T17:41:05.4924383Z [1m[31mtests/api/v1/test_governance.py[0m:279: in test_tenant_budget_status_error
2025-11-28T17:41:05.4925148Z     [0m[94massert[39;49;00m response.status_code == [94m500[39;49;00m[90m[39;49;00m
2025-11-28T17:41:05.4925547Z [1m[31mE   assert 401 == 500[0m
2025-11-28T17:41:05.4925915Z [1m[31mE    +  where 401 = <Response [401 Unauthorized]>.status_code[0m
2025-11-28T17:41:05.4926309Z ----------------------------- Captured stdout call -----------------------------
2025-11-28T17:41:05.4926975Z {"tenant_id": "test-tenant", "event": "check_tenant_access_no_user_id", "level": "warning", "logger": "apps.memory_api.security.auth", "timestamp": "2025-11-28T17:40:02.745098Z"}
2025-11-28T17:41:05.4928139Z {"status_code": 401, "detail": "Authentication required to access tenant", "path": "/v1/governance/tenant/test-tenant/budget", "method": "GET", "event": "http_exception", "level": "warning", "logger": "apps.memory_api.main", "timestamp": "2025-11-28T17:40:02.745323Z"}
2025-11-28T17:41:05.4929032Z ------------------------------ Captured log call -------------------------------
2025-11-28T17:41:05.4930212Z [33mWARNING [0m apps.memory_api.security.auth:auth.py:218 {'tenant_id': 'test-tenant', 'event': 'check_tenant_access_no_user_id', 'level': 'warning', 'logger': 'apps.memory_api.security.auth', 'timestamp': '2025-11-28T17:40:02.745098Z'}
2025-11-28T17:41:05.4931877Z [33mWARNING [0m apps.memory_api.main:main.py:194 {'status_code': 401, 'detail': 'Authentication required to access tenant', 'path': '/v1/governance/tenant/test-tenant/budget', 'method': 'GET', 'event': 'http_exception', 'level': 'warning', 'logger': 'apps.memory_api.main', 'timestamp': '2025-11-28T17:40:02.745323Z'}
2025-11-28T17:41:05.4933025Z [31m[1m____________________ test_governance_overview_invalid_days _____________________[0m
2025-11-28T17:41:05.4933580Z [1m[31mtests/api/v1/test_governance.py[0m:296: in test_governance_overview_invalid_days
2025-11-28T17:41:05.4934133Z     [0m[94massert[39;49;00m response.status_code == [94m422[39;49;00m[90m[39;49;00m
2025-11-28T17:41:05.4934520Z [1m[31mE   assert 401 == 422[0m
2025-11-28T17:41:05.4934878Z [1m[31mE    +  where 401 = <Response [401 Unauthorized]>.status_code[0m
2025-11-28T17:41:05.4935246Z ----------------------------- Captured stdout call -----------------------------
2025-11-28T17:41:05.4936099Z {"status_code": 401, "detail": "Authentication required for admin access", "path": "/v1/governance/overview", "method": "GET", "event": "http_exception", "level": "warning", "logger": "apps.memory_api.main", "timestamp": "2025-11-28T17:40:02.771881Z"}
2025-11-28T17:41:05.4937116Z ------------------------------ Captured log call -------------------------------
2025-11-28T17:41:05.4938258Z [33mWARNING [0m apps.memory_api.main:main.py:194 {'status_code': 401, 'detail': 'Authentication required for admin access', 'path': '/v1/governance/overview', 'method': 'GET', 'event': 'http_exception', 'level': 'warning', 'logger': 'apps.memory_api.main', 'timestamp': '2025-11-28T17:40:02.771881Z'}
2025-11-28T17:41:05.4939530Z [31m[1m__________________ test_tenant_governance_stats_invalid_days ___________________[0m
2025-11-28T17:41:05.4940090Z [1m[31mtests/api/v1/test_governance.py[0m:308: in test_tenant_governance_stats_invalid_days
2025-11-28T17:41:05.4940634Z     [0m[94massert[39;49;00m response.status_code == [94m422[39;49;00m[90m[39;49;00m
2025-11-28T17:41:05.4941015Z [1m[31mE   assert 401 == 422[0m
2025-11-28T17:41:05.4941354Z [1m[31mE    +  where 401 = <Response [401 Unauthorized]>.status_code[0m
2025-11-28T17:41:05.4941720Z ----------------------------- Captured stdout call -----------------------------
2025-11-28T17:41:05.4942366Z {"tenant_id": "test-tenant", "event": "check_tenant_access_no_user_id", "level": "warning", "logger": "apps.memory_api.security.auth", "timestamp": "2025-11-28T17:40:02.800039Z"}
2025-11-28T17:41:05.4943622Z {"status_code": 401, "detail": "Authentication required to access tenant", "path": "/v1/governance/tenant/test-tenant", "method": "GET", "event": "http_exception", "level": "warning", "logger": "apps.memory_api.main", "timestamp": "2025-11-28T17:40:02.800284Z"}
2025-11-28T17:41:05.4944485Z ------------------------------ Captured log call -------------------------------
2025-11-28T17:41:05.4945425Z [33mWARNING [0m apps.memory_api.security.auth:auth.py:218 {'tenant_id': 'test-tenant', 'event': 'check_tenant_access_no_user_id', 'level': 'warning', 'logger': 'apps.memory_api.security.auth', 'timestamp': '2025-11-28T17:40:02.800039Z'}
2025-11-28T17:41:05.4947029Z [33mWARNING [0m apps.memory_api.main:main.py:194 {'status_code': 401, 'detail': 'Authentication required to access tenant', 'path': '/v1/governance/tenant/test-tenant', 'method': 'GET', 'event': 'http_exception', 'level': 'warning', 'logger': 'apps.memory_api.main', 'timestamp': '2025-11-28T17:40:02.800284Z'}
2025-11-28T17:41:05.4948118Z [31m[1m____________________ test_governance_overview_empty_results ____________________[0m
2025-11-28T17:41:05.4948668Z [1m[31mtests/api/v1/test_governance.py[0m:330: in test_governance_overview_empty_results
2025-11-28T17:41:05.4949317Z     [0m[94massert[39;49;00m response.status_code == [94m200[39;49;00m[90m[39;49;00m
2025-11-28T17:41:05.4949696Z [1m[31mE   assert 401 == 200[0m
2025-11-28T17:41:05.4950038Z [1m[31mE    +  where 401 = <Response [401 Unauthorized]>.status_code[0m
2025-11-28T17:41:05.4950405Z ----------------------------- Captured stdout call -----------------------------
2025-11-28T17:41:05.4951246Z {"status_code": 401, "detail": "Authentication required for admin access", "path": "/v1/governance/overview", "method": "GET", "event": "http_exception", "level": "warning", "logger": "apps.memory_api.main", "timestamp": "2025-11-28T17:40:02.826972Z"}
2025-11-28T17:41:05.4952071Z ------------------------------ Captured log call -------------------------------
2025-11-28T17:41:05.4953206Z [33mWARNING [0m apps.memory_api.main:main.py:194 {'status_code': 401, 'detail': 'Authentication required for admin access', 'path': '/v1/governance/overview', 'method': 'GET', 'event': 'http_exception', 'level': 'warning', 'logger': 'apps.memory_api.main', 'timestamp': '2025-11-28T17:40:02.826972Z'}
2025-11-28T17:41:05.4954243Z [31m[1m__________________________ test_store_memory_success ___________________________[0m
2025-11-28T17:41:05.4954711Z [1m[31mtests/api/v1/test_memory.py[0m:59: in test_store_memory_success
2025-11-28T17:41:05.4955321Z     [0m[94massert[39;49;00m response.status_code == [94m200[39;49;00m[90m[39;49;00m
2025-11-28T17:41:05.4955690Z [1m[31mE   assert 401 == 200[0m
2025-11-28T17:41:05.4956031Z [1m[31mE    +  where 401 = <Response [401 Unauthorized]>.status_code[0m
2025-11-28T17:41:05.4956390Z ----------------------------- Captured stdout call -----------------------------
2025-11-28T17:41:05.4957066Z {"tenant_id": "test-tenant", "event": "check_tenant_access_no_user_id", "level": "warning", "logger": "apps.memory_api.security.auth", "timestamp": "2025-11-28T17:40:02.859754Z"}
2025-11-28T17:41:05.4958134Z {"status_code": 401, "detail": "Authentication required to access tenant", "path": "/v1/memory/store", "method": "POST", "event": "http_exception", "level": "warning", "logger": "apps.memory_api.main", "timestamp": "2025-11-28T17:40:02.860019Z"}
2025-11-28T17:41:05.4959000Z STORE ERROR: {'error': {'code': '401', 'message': 'Authentication required to access tenant'}}
2025-11-28T17:41:05.4959532Z ------------------------------ Captured log call -------------------------------
2025-11-28T17:41:05.4960474Z [33mWARNING [0m apps.memory_api.security.auth:auth.py:218 {'tenant_id': 'test-tenant', 'event': 'check_tenant_access_no_user_id', 'level': 'warning', 'logger': 'apps.memory_api.security.auth', 'timestamp': '2025-11-28T17:40:02.859754Z'}
2025-11-28T17:41:05.4962133Z [33mWARNING [0m apps.memory_api.main:main.py:194 {'status_code': 401, 'detail': 'Authentication required to access tenant', 'path': '/v1/memory/store', 'method': 'POST', 'event': 'http_exception', 'level': 'warning', 'logger': 'apps.memory_api.main', 'timestamp': '2025-11-28T17:40:02.860019Z'}
2025-11-28T17:41:05.4963145Z [31m[1m__________________________ test_query_memory_success ___________________________[0m
2025-11-28T17:41:05.4963621Z [1m[31mtests/api/v1/test_memory.py[0m:88: in test_query_memory_success
2025-11-28T17:41:05.4964106Z     [0m[94massert[39;49;00m response.status_code == [94m200[39;49;00m[90m[39;49;00m
2025-11-28T17:41:05.4964481Z [1m[31mE   assert 401 == 200[0m
2025-11-28T17:41:05.4964821Z [1m[31mE    +  where 401 = <Response [401 Unauthorized]>.status_code[0m
2025-11-28T17:41:05.4965186Z ----------------------------- Captured stdout call -----------------------------
2025-11-28T17:41:05.4965819Z {"tenant_id": "test-tenant", "event": "check_tenant_access_no_user_id", "level": "warning", "logger": "apps.memory_api.security.auth", "timestamp": "2025-11-28T17:40:02.891025Z"}
2025-11-28T17:41:05.4966896Z {"status_code": 401, "detail": "Authentication required to access tenant", "path": "/v1/memory/query", "method": "POST", "event": "http_exception", "level": "warning", "logger": "apps.memory_api.main", "timestamp": "2025-11-28T17:40:02.891275Z"}
2025-11-28T17:41:05.4967697Z ------------------------------ Captured log call -------------------------------
2025-11-28T17:41:05.4968632Z [33mWARNING [0m apps.memory_api.security.auth:auth.py:218 {'tenant_id': 'test-tenant', 'event': 'check_tenant_access_no_user_id', 'level': 'warning', 'logger': 'apps.memory_api.security.auth', 'timestamp': '2025-11-28T17:40:02.891025Z'}
2025-11-28T17:41:05.4970269Z [33mWARNING [0m apps.memory_api.main:main.py:194 {'status_code': 401, 'detail': 'Authentication required to access tenant', 'path': '/v1/memory/query', 'method': 'POST', 'event': 'http_exception', 'level': 'warning', 'logger': 'apps.memory_api.main', 'timestamp': '2025-11-28T17:40:02.891275Z'}
2025-11-28T17:41:05.4971279Z [31m[1m__________________________ test_delete_memory_success __________________________[0m
2025-11-28T17:41:05.4971767Z [1m[31mtests/api/v1/test_memory.py[0m:101: in test_delete_memory_success
2025-11-28T17:41:05.4972286Z     [0m[94massert[39;49;00m response.status_code == [94m200[39;49;00m[90m[39;49;00m
2025-11-28T17:41:05.4972658Z [1m[31mE   assert 401 == 200[0m
2025-11-28T17:41:05.4972993Z [1m[31mE    +  where 401 = <Response [401 Unauthorized]>.status_code[0m
2025-11-28T17:41:05.4973357Z ----------------------------- Captured stdout call -----------------------------
2025-11-28T17:41:05.4974141Z {"tenant_id": "test-tenant", "event": "check_tenant_access_no_user_id", "level": "warning", "logger": "apps.memory_api.security.auth", "timestamp": "2025-11-28T17:40:02.920103Z"}
2025-11-28T17:41:05.4975237Z {"status_code": 401, "detail": "Authentication required to access tenant", "path": "/v1/memory/delete", "method": "DELETE", "event": "http_exception", "level": "warning", "logger": "apps.memory_api.main", "timestamp": "2025-11-28T17:40:02.920352Z"}
2025-11-28T17:41:05.4976055Z ------------------------------ Captured log call -------------------------------
2025-11-28T17:41:05.4977003Z [33mWARNING [0m apps.memory_api.security.auth:auth.py:218 {'tenant_id': 'test-tenant', 'event': 'check_tenant_access_no_user_id', 'level': 'warning', 'logger': 'apps.memory_api.security.auth', 'timestamp': '2025-11-28T17:40:02.920103Z'}
2025-11-28T17:41:05.4978547Z [33mWARNING [0m apps.memory_api.main:main.py:194 {'status_code': 401, 'detail': 'Authentication required to access tenant', 'path': '/v1/memory/delete', 'method': 'DELETE', 'event': 'http_exception', 'level': 'warning', 'logger': 'apps.memory_api.main', 'timestamp': '2025-11-28T17:40:02.920352Z'}
2025-11-28T17:41:05.4979798Z [31m[1m________________________ test_reflection_stats_success _________________________[0m
2025-11-28T17:41:05.4980430Z [1m[31mtests/api/v1/test_memory.py[0m:139: in test_reflection_stats_success
2025-11-28T17:41:05.4980936Z     [0m[94massert[39;49;00m response.status_code == [94m200[39;49;00m[90m[39;49;00m
2025-11-28T17:41:05.4981307Z [1m[31mE   assert 401 == 200[0m
2025-11-28T17:41:05.4981656Z [1m[31mE    +  where 401 = <Response [401 Unauthorized]>.status_code[0m
2025-11-28T17:41:05.4982017Z ----------------------------- Captured stdout call -----------------------------
2025-11-28T17:41:05.4982663Z {"tenant_id": "test-tenant", "event": "check_tenant_access_no_user_id", "level": "warning", "logger": "apps.memory_api.security.auth", "timestamp": "2025-11-28T17:40:02.967955Z"}
2025-11-28T17:41:05.4983779Z {"status_code": 401, "detail": "Authentication required to access tenant", "path": "/v1/memory/reflection-stats", "method": "GET", "event": "http_exception", "level": "warning", "logger": "apps.memory_api.main", "timestamp": "2025-11-28T17:40:02.968208Z"}
2025-11-28T17:41:05.4984619Z ------------------------------ Captured log call -------------------------------
2025-11-28T17:41:05.4985556Z [33mWARNING [0m apps.memory_api.security.auth:auth.py:218 {'tenant_id': 'test-tenant', 'event': 'check_tenant_access_no_user_id', 'level': 'warning', 'logger': 'apps.memory_api.security.auth', 'timestamp': '2025-11-28T17:40:02.967955Z'}
2025-11-28T17:41:05.4987122Z [33mWARNING [0m apps.memory_api.main:main.py:194 {'status_code': 401, 'detail': 'Authentication required to access tenant', 'path': '/v1/memory/reflection-stats', 'method': 'GET', 'event': 'http_exception', 'level': 'warning', 'logger': 'apps.memory_api.main', 'timestamp': '2025-11-28T17:40:02.968208Z'}
2025-11-28T17:41:05.4988185Z [31m[1m___________________ test_store_memory_missing_tenant_header ____________________[0m
2025-11-28T17:41:05.4988714Z [1m[31mtests/api/v1/test_memory.py[0m:157: in test_store_memory_missing_tenant_header
2025-11-28T17:41:05.4989633Z     [0m[94massert[39;49;00m [33m"[39;49;00m[33mX-Tenant-Id[39;49;00m[33m"[39;49;00m [95min[39;49;00m response.json()[[33m"[39;49;00m[33mdetail[39;49;00m[33m"[39;49;00m][90m[39;49;00m
2025-11-28T17:41:05.4990238Z                             ^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.4990526Z [1m[31mE   KeyError: 'detail'[0m
2025-11-28T17:41:05.4990827Z ----------------------------- Captured stdout call -----------------------------
2025-11-28T17:41:05.4991608Z {"status_code": 400, "detail": "X-Tenant-Id header is required", "path": "/v1/memory/store", "method": "POST", "event": "http_exception", "level": "warning", "logger": "apps.memory_api.main", "timestamp": "2025-11-28T17:40:02.998283Z"}
2025-11-28T17:41:05.4992908Z ------------------------------ Captured log call -------------------------------
2025-11-28T17:41:05.4994131Z [33mWARNING [0m apps.memory_api.main:main.py:194 {'status_code': 400, 'detail': 'X-Tenant-Id header is required', 'path': '/v1/memory/store', 'method': 'POST', 'event': 'http_exception', 'level': 'warning', 'logger': 'apps.memory_api.main', 'timestamp': '2025-11-28T17:40:02.998283Z'}
2025-11-28T17:41:05.4995120Z [31m[1m________________________ test_query_memory_with_filters ________________________[0m
2025-11-28T17:41:05.4995611Z [1m[31mtests/api/v1/test_memory.py[0m:190: in test_query_memory_with_filters
2025-11-28T17:41:05.4996119Z     [0m[94massert[39;49;00m response.status_code == [94m200[39;49;00m[90m[39;49;00m
2025-11-28T17:41:05.4996488Z [1m[31mE   assert 401 == 200[0m
2025-11-28T17:41:05.4996829Z [1m[31mE    +  where 401 = <Response [401 Unauthorized]>.status_code[0m
2025-11-28T17:41:05.4997203Z ----------------------------- Captured stdout call -----------------------------
2025-11-28T17:41:05.4997854Z {"tenant_id": "test-tenant", "event": "check_tenant_access_no_user_id", "level": "warning", "logger": "apps.memory_api.security.auth", "timestamp": "2025-11-28T17:40:03.029247Z"}
2025-11-28T17:41:05.4998929Z {"status_code": 401, "detail": "Authentication required to access tenant", "path": "/v1/memory/query", "method": "POST", "event": "http_exception", "level": "warning", "logger": "apps.memory_api.main", "timestamp": "2025-11-28T17:40:03.029487Z"}
2025-11-28T17:41:05.4999996Z ------------------------------ Captured log call -------------------------------
2025-11-28T17:41:05.5000944Z [33mWARNING [0m apps.memory_api.security.auth:auth.py:218 {'tenant_id': 'test-tenant', 'event': 'check_tenant_access_no_user_id', 'level': 'warning', 'logger': 'apps.memory_api.security.auth', 'timestamp': '2025-11-28T17:40:03.029247Z'}
2025-11-28T17:41:05.5002475Z [33mWARNING [0m apps.memory_api.main:main.py:194 {'status_code': 401, 'detail': 'Authentication required to access tenant', 'path': '/v1/memory/query', 'method': 'POST', 'event': 'http_exception', 'level': 'warning', 'logger': 'apps.memory_api.main', 'timestamp': '2025-11-28T17:40:03.029487Z'}
2025-11-28T17:41:05.5003512Z [31m[1m____________________ test_query_memory_with_graph_traversal ____________________[0m
2025-11-28T17:41:05.5004042Z [1m[31mtests/api/v1/test_memory.py[0m:221: in test_query_memory_with_graph_traversal
2025-11-28T17:41:05.5004562Z     [0m[94massert[39;49;00m response.status_code == [94m200[39;49;00m[90m[39;49;00m
2025-11-28T17:41:05.5004931Z [1m[31mE   assert 401 == 200[0m
2025-11-28T17:41:05.5005274Z [1m[31mE    +  where 401 = <Response [401 Unauthorized]>.status_code[0m
2025-11-28T17:41:05.5005642Z ----------------------------- Captured stdout call -----------------------------
2025-11-28T17:41:05.5006287Z {"tenant_id": "test-tenant", "event": "check_tenant_access_no_user_id", "level": "warning", "logger": "apps.memory_api.security.auth", "timestamp": "2025-11-28T17:40:03.062716Z"}
2025-11-28T17:41:05.5007364Z {"status_code": 401, "detail": "Authentication required to access tenant", "path": "/v1/memory/query", "method": "POST", "event": "http_exception", "level": "warning", "logger": "apps.memory_api.main", "timestamp": "2025-11-28T17:40:03.062980Z"}
2025-11-28T17:41:05.5008165Z ------------------------------ Captured log call -------------------------------
2025-11-28T17:41:05.5009209Z [33mWARNING [0m apps.memory_api.security.auth:auth.py:218 {'tenant_id': 'test-tenant', 'event': 'check_tenant_access_no_user_id', 'level': 'warning', 'logger': 'apps.memory_api.security.auth', 'timestamp': '2025-11-28T17:40:03.062716Z'}
2025-11-28T17:41:05.5010740Z [33mWARNING [0m apps.memory_api.main:main.py:194 {'status_code': 401, 'detail': 'Authentication required to access tenant', 'path': '/v1/memory/query', 'method': 'POST', 'event': 'http_exception', 'level': 'warning', 'logger': 'apps.memory_api.main', 'timestamp': '2025-11-28T17:40:03.062980Z'}
2025-11-28T17:41:05.5011756Z [31m[1m_________________________ test_delete_memory_not_found _________________________[0m
2025-11-28T17:41:05.5012368Z [1m[31mtests/api/v1/test_memory.py[0m:238: in test_delete_memory_not_found
2025-11-28T17:41:05.5012869Z     [0m[94massert[39;49;00m response.status_code == [94m200[39;49;00m[90m[39;49;00m
2025-11-28T17:41:05.5013244Z [1m[31mE   assert 401 == 200[0m
2025-11-28T17:41:05.5013580Z [1m[31mE    +  where 401 = <Response [401 Unauthorized]>.status_code[0m
2025-11-28T17:41:05.5013944Z ----------------------------- Captured stdout call -----------------------------
2025-11-28T17:41:05.5014585Z {"tenant_id": "test-tenant", "event": "check_tenant_access_no_user_id", "level": "warning", "logger": "apps.memory_api.security.auth", "timestamp": "2025-11-28T17:40:03.092127Z"}
2025-11-28T17:41:05.5015666Z {"status_code": 401, "detail": "Authentication required to access tenant", "path": "/v1/memory/delete", "method": "DELETE", "event": "http_exception", "level": "warning", "logger": "apps.memory_api.main", "timestamp": "2025-11-28T17:40:03.092393Z"}
2025-11-28T17:41:05.5016478Z ------------------------------ Captured log call -------------------------------
2025-11-28T17:41:05.5017414Z [33mWARNING [0m apps.memory_api.security.auth:auth.py:218 {'tenant_id': 'test-tenant', 'event': 'check_tenant_access_no_user_id', 'level': 'warning', 'logger': 'apps.memory_api.security.auth', 'timestamp': '2025-11-28T17:40:03.092127Z'}
2025-11-28T17:41:05.5019071Z [33mWARNING [0m apps.memory_api.main:main.py:194 {'status_code': 401, 'detail': 'Authentication required to access tenant', 'path': '/v1/memory/delete', 'method': 'DELETE', 'event': 'http_exception', 'level': 'warning', 'logger': 'apps.memory_api.main', 'timestamp': '2025-11-28T17:40:03.092393Z'}
2025-11-28T17:41:05.5020332Z [31m[1m__________________________ test_hybrid_search_success __________________________[0m
2025-11-28T17:41:05.5020834Z [1m[31mtests/api/v1/test_search_hybrid.py[0m:74: in test_hybrid_search_success
2025-11-28T17:41:05.5021354Z     [0m[94massert[39;49;00m response.status_code == [94m200[39;49;00m[90m[39;49;00m
2025-11-28T17:41:05.5021718Z [1m[31mE   assert 500 == 200[0m
2025-11-28T17:41:05.5022084Z [1m[31mE    +  where 500 = <Response [500 Internal Server Error]>.status_code[0m
2025-11-28T17:41:05.5022465Z ----------------------------- Captured stdout call -----------------------------
2025-11-28T17:41:05.5023282Z {"error": "'dict' object has no attribute 'total_results'", "query": "authentication system", "event": "hybrid_search_failed", "level": "error", "logger": "apps.memory_api.routes.hybrid_search", "timestamp": "2025-11-28T17:40:03.127016Z"}
2025-11-28T17:41:05.5024518Z {"status_code": 500, "detail": "'dict' object has no attribute 'total_results'", "path": "/v1/search/hybrid", "method": "POST", "event": "http_exception", "level": "warning", "logger": "apps.memory_api.main", "timestamp": "2025-11-28T17:40:03.127278Z"}
2025-11-28T17:41:05.5025181Z 
2025-11-28T17:41:05.5025418Z DEBUG: Response 500: {'error': {'code': '500', 'message': "'dict' object has no attribute 'total_results'"}}
2025-11-28T17:41:05.5025874Z ------------------------------ Captured log call -------------------------------
2025-11-28T17:41:05.5027058Z [1m[31mERROR   [0m apps.memory_api.routes.hybrid_search:hybrid_search.py:95 {'error': "'dict' object has no attribute 'total_results'", 'query': 'authentication system', 'event': 'hybrid_search_failed', 'level': 'error', 'logger': 'apps.memory_api.routes.hybrid_search', 'timestamp': '2025-11-28T17:40:03.127016Z'}
2025-11-28T17:41:05.5028804Z [33mWARNING [0m apps.memory_api.main:main.py:194 {'status_code': 500, 'detail': "'dict' object has no attribute 'total_results'", 'path': '/v1/search/hybrid', 'method': 'POST', 'event': 'http_exception', 'level': 'warning', 'logger': 'apps.memory_api.main', 'timestamp': '2025-11-28T17:40:03.127278Z'}
2025-11-28T17:41:05.5029943Z [31m[1m______________________ test_hybrid_search_with_reranking _______________________[0m
2025-11-28T17:41:05.5030477Z [1m[31mtests/api/v1/test_search_hybrid.py[0m:137: in test_hybrid_search_with_reranking
2025-11-28T17:41:05.5031138Z     [0m[94massert[39;49;00m response.status_code == [94m200[39;49;00m[90m[39;49;00m
2025-11-28T17:41:05.5031503Z [1m[31mE   assert 500 == 200[0m
2025-11-28T17:41:05.5031871Z [1m[31mE    +  where 500 = <Response [500 Internal Server Error]>.status_code[0m
2025-11-28T17:41:05.5032266Z ----------------------------- Captured stdout call -----------------------------
2025-11-28T17:41:05.5033099Z {"error": "'dict' object has no attribute 'total_results'", "query": "explain the authentication flow", "event": "hybrid_search_failed", "level": "error", "logger": "apps.memory_api.routes.hybrid_search", "timestamp": "2025-11-28T17:40:03.157740Z"}
2025-11-28T17:41:05.5034352Z {"status_code": 500, "detail": "'dict' object has no attribute 'total_results'", "path": "/v1/search/hybrid", "method": "POST", "event": "http_exception", "level": "warning", "logger": "apps.memory_api.main", "timestamp": "2025-11-28T17:40:03.157999Z"}
2025-11-28T17:41:05.5035020Z 
2025-11-28T17:41:05.5035250Z DEBUG: Response 500: {'error': {'code': '500', 'message': "'dict' object has no attribute 'total_results'"}}
2025-11-28T17:41:05.5035702Z ------------------------------ Captured log call -------------------------------
2025-11-28T17:41:05.5036927Z [1m[31mERROR   [0m apps.memory_api.routes.hybrid_search:hybrid_search.py:95 {'error': "'dict' object has no attribute 'total_results'", 'query': 'explain the authentication flow', 'event': 'hybrid_search_failed', 'level': 'error', 'logger': 'apps.memory_api.routes.hybrid_search', 'timestamp': '2025-11-28T17:40:03.157740Z'}
2025-11-28T17:41:05.5038808Z [33mWARNING [0m apps.memory_api.main:main.py:194 {'status_code': 500, 'detail': "'dict' object has no attribute 'total_results'", 'path': '/v1/search/hybrid', 'method': 'POST', 'event': 'http_exception', 'level': 'warning', 'logger': 'apps.memory_api.main', 'timestamp': '2025-11-28T17:40:03.157999Z'}
2025-11-28T17:41:05.5039938Z [31m[1m_______________________ test_hybrid_search_with_filters ________________________[0m
2025-11-28T17:41:05.5040460Z [1m[31mtests/api/v1/test_search_hybrid.py[0m:202: in test_hybrid_search_with_filters
2025-11-28T17:41:05.5040988Z     [0m[94massert[39;49;00m response.status_code == [94m200[39;49;00m[90m[39;49;00m
2025-11-28T17:41:05.5041366Z [1m[31mE   assert 422 == 200[0m
2025-11-28T17:41:05.5041724Z [1m[31mE    +  where 422 = <Response [422 Unprocessable Entity]>.status_code[0m
2025-11-28T17:41:05.5042125Z ----------------------------- Captured stdout call -----------------------------
2025-11-28T17:41:05.5043198Z {"errors": [{"type": "datetime_type", "loc": ["body", "temporal_filter"], "msg": "Input should be a valid datetime", "input": {"start_date": "2025-01-01T00:00:00Z", "end_date": "2025-12-31T23:59:59Z"}}], "path": "/v1/search/hybrid", "method": "POST", "event": "validation_error", "level": "warning", "logger": "apps.memory_api.main", "timestamp": "2025-11-28T17:40:03.188432Z"}
2025-11-28T17:41:05.5044121Z 
2025-11-28T17:41:05.5044748Z DEBUG: Response 422: {'error': {'code': '422', 'message': 'Validation Error', 'details': [{'type': 'datetime_type', 'loc': ['body', 'temporal_filter'], 'msg': 'Input should be a valid datetime', 'input': {'start_date': '2025-01-01T00:00:00Z', 'end_date': '2025-12-31T23:59:59Z'}}]}}
2025-11-28T17:41:05.5045591Z ------------------------------ Captured log call -------------------------------
2025-11-28T17:41:05.5047036Z [33mWARNING [0m apps.memory_api.main:main.py:209 {'errors': [{'type': 'datetime_type', 'loc': ('body', 'temporal_filter'), 'msg': 'Input should be a valid datetime', 'input': {'start_date': '2025-01-01T00:00:00Z', 'end_date': '2025-12-31T23:59:59Z'}}], 'path': '/v1/search/hybrid', 'method': 'POST', 'event': 'validation_error', 'level': 'warning', 'logger': 'apps.memory_api.main', 'timestamp': '2025-11-28T17:40:03.188432Z'}
2025-11-28T17:41:05.5048317Z [31m[1m____________________ test_hybrid_search_with_manual_weights ____________________[0m
2025-11-28T17:41:05.5048996Z [1m[31mtests/api/v1/test_search_hybrid.py[0m:267: in test_hybrid_search_with_manual_weights
2025-11-28T17:41:05.5049744Z     [0m[94massert[39;49;00m response.status_code == [94m200[39;49;00m[90m[39;49;00m
2025-11-28T17:41:05.5050128Z [1m[31mE   assert 500 == 200[0m
2025-11-28T17:41:05.5050509Z [1m[31mE    +  where 500 = <Response [500 Internal Server Error]>.status_code[0m
2025-11-28T17:41:05.5050905Z ----------------------------- Captured stdout call -----------------------------
2025-11-28T17:41:05.5051721Z {"error": "'dict' object has no attribute 'total_results'", "query": "database optimization", "event": "hybrid_search_failed", "level": "error", "logger": "apps.memory_api.routes.hybrid_search", "timestamp": "2025-11-28T17:40:03.218567Z"}
2025-11-28T17:41:05.5052960Z {"status_code": 500, "detail": "'dict' object has no attribute 'total_results'", "path": "/v1/search/hybrid", "method": "POST", "event": "http_exception", "level": "warning", "logger": "apps.memory_api.main", "timestamp": "2025-11-28T17:40:03.218800Z"}
2025-11-28T17:41:05.5053637Z 
2025-11-28T17:41:05.5053871Z DEBUG: Response 500: {'error': {'code': '500', 'message': "'dict' object has no attribute 'total_results'"}}
2025-11-28T17:41:05.5054330Z ------------------------------ Captured log call -------------------------------
2025-11-28T17:41:05.5055653Z [1m[31mERROR   [0m apps.memory_api.routes.hybrid_search:hybrid_search.py:95 {'error': "'dict' object has no attribute 'total_results'", 'query': 'database optimization', 'event': 'hybrid_search_failed', 'level': 'error', 'logger': 'apps.memory_api.routes.hybrid_search', 'timestamp': '2025-11-28T17:40:03.218567Z'}
2025-11-28T17:41:05.5057421Z [33mWARNING [0m apps.memory_api.main:main.py:194 {'status_code': 500, 'detail': "'dict' object has no attribute 'total_results'", 'path': '/v1/search/hybrid', 'method': 'POST', 'event': 'http_exception', 'level': 'warning', 'logger': 'apps.memory_api.main', 'timestamp': '2025-11-28T17:40:03.218800Z'}
2025-11-28T17:41:05.5058461Z [31m[1m_____________________ test_hybrid_search_with_graph_depth ______________________[0m
2025-11-28T17:41:05.5059001Z [1m[31mtests/api/v1/test_search_hybrid.py[0m:327: in test_hybrid_search_with_graph_depth
2025-11-28T17:41:05.5059754Z     [0m[94massert[39;49;00m response.status_code == [94m200[39;49;00m[90m[39;49;00m
2025-11-28T17:41:05.5060136Z [1m[31mE   assert 500 == 200[0m
2025-11-28T17:41:05.5060500Z [1m[31mE    +  where 500 = <Response [500 Internal Server Error]>.status_code[0m
2025-11-28T17:41:05.5060892Z ----------------------------- Captured stdout call -----------------------------
2025-11-28T17:41:05.5061727Z {"error": "'dict' object has no attribute 'total_results'", "query": "knowledge graph relationships", "event": "hybrid_search_failed", "level": "error", "logger": "apps.memory_api.routes.hybrid_search", "timestamp": "2025-11-28T17:40:03.248515Z"}
2025-11-28T17:41:05.5062980Z {"status_code": 500, "detail": "'dict' object has no attribute 'total_results'", "path": "/v1/search/hybrid", "method": "POST", "event": "http_exception", "level": "warning", "logger": "apps.memory_api.main", "timestamp": "2025-11-28T17:40:03.248752Z"}
2025-11-28T17:41:05.5063646Z 
2025-11-28T17:41:05.5063881Z DEBUG: Response 500: {'error': {'code': '500', 'message': "'dict' object has no attribute 'total_results'"}}
2025-11-28T17:41:05.5064340Z ------------------------------ Captured log call -------------------------------
2025-11-28T17:41:05.5065562Z [1m[31mERROR   [0m apps.memory_api.routes.hybrid_search:hybrid_search.py:95 {'error': "'dict' object has no attribute 'total_results'", 'query': 'knowledge graph relationships', 'event': 'hybrid_search_failed', 'level': 'error', 'logger': 'apps.memory_api.routes.hybrid_search', 'timestamp': '2025-11-28T17:40:03.248515Z'}
2025-11-28T17:41:05.5067334Z [33mWARNING [0m apps.memory_api.main:main.py:194 {'status_code': 500, 'detail': "'dict' object has no attribute 'total_results'", 'path': '/v1/search/hybrid', 'method': 'POST', 'event': 'http_exception', 'level': 'warning', 'logger': 'apps.memory_api.main', 'timestamp': '2025-11-28T17:40:03.248752Z'}
2025-11-28T17:41:05.5068583Z [31m[1m_________________ test_hybrid_search_with_conversation_history _________________[0m
2025-11-28T17:41:05.5069283Z [1m[31mtests/api/v1/test_search_hybrid.py[0m:390: in test_hybrid_search_with_conversation_history
2025-11-28T17:41:05.5069860Z     [0m[94massert[39;49;00m response.status_code == [94m200[39;49;00m[90m[39;49;00m
2025-11-28T17:41:05.5070235Z [1m[31mE   assert 422 == 200[0m
2025-11-28T17:41:05.5070603Z [1m[31mE    +  where 422 = <Response [422 Unprocessable Entity]>.status_code[0m
2025-11-28T17:41:05.5071004Z ----------------------------- Captured stdout call -----------------------------
2025-11-28T17:41:05.5072519Z {"errors": [{"type": "string_type", "loc": ["body", "conversation_history", 0], "msg": "Input should be a valid string", "input": {"role": "user", "content": "Tell me about authentication"}}, {"type": "string_type", "loc": ["body", "conversation_history", 1], "msg": "Input should be a valid string", "input": {"role": "assistant", "content": "Authentication uses JWT tokens"}}], "path": "/v1/search/hybrid", "method": "POST", "event": "validation_error", "level": "warning", "logger": "apps.memory_api.main", "timestamp": "2025-11-28T17:40:03.279154Z"}
2025-11-28T17:41:05.5074027Z 
2025-11-28T17:41:05.5075057Z DEBUG: Response 422: {'error': {'code': '422', 'message': 'Validation Error', 'details': [{'type': 'string_type', 'loc': ['body', 'conversation_history', 0], 'msg': 'Input should be a valid string', 'input': {'role': 'user', 'content': 'Tell me about authentication'}}, {'type': 'string_type', 'loc': ['body', 'conversation_history', 1], 'msg': 'Input should be a valid string', 'input': {'role': 'assistant', 'content': 'Authentication uses JWT tokens'}}]}}
2025-11-28T17:41:05.5076310Z ------------------------------ Captured log call -------------------------------
2025-11-28T17:41:05.5078300Z [33mWARNING [0m apps.memory_api.main:main.py:209 {'errors': [{'type': 'string_type', 'loc': ('body', 'conversation_history', 0), 'msg': 'Input should be a valid string', 'input': {'role': 'user', 'content': 'Tell me about authentication'}}, {'type': 'string_type', 'loc': ('body', 'conversation_history', 1), 'msg': 'Input should be a valid string', 'input': {'role': 'assistant', 'content': 'Authentication uses JWT tokens'}}], 'path': '/v1/search/hybrid', 'method': 'POST', 'event': 'validation_error', 'level': 'warning', 'logger': 'apps.memory_api.main', 'timestamp': '2025-11-28T17:40:03.279154Z'}
2025-11-28T17:41:05.5080124Z [31m[1m________________________ test_hybrid_search_empty_query ________________________[0m
2025-11-28T17:41:05.5080643Z [1m[31mtests/api/v1/test_search_hybrid.py[0m:447: in test_hybrid_search_empty_query
2025-11-28T17:41:05.5081273Z     [0m[94massert[39;49;00m response.status_code [95min[39;49;00m [[94m200[39;49;00m, [94m400[39;49;00m][90m[39;49;00m
2025-11-28T17:41:05.5081731Z [1m[31mE   assert 422 in [200, 400][0m
2025-11-28T17:41:05.5082123Z [1m[31mE    +  where 422 = <Response [422 Unprocessable Entity]>.status_code[0m
2025-11-28T17:41:05.5082511Z ----------------------------- Captured stdout call -----------------------------
2025-11-28T17:41:05.5083467Z {"errors": [{"type": "string_too_short", "loc": ["body", "query"], "msg": "String should have at least 1 character", "input": "", "ctx": {"min_length": 1}}], "path": "/v1/search/hybrid", "method": "POST", "event": "validation_error", "level": "warning", "logger": "apps.memory_api.main", "timestamp": "2025-11-28T17:40:03.309826Z"}
2025-11-28T17:41:05.5084409Z ------------------------------ Captured log call -------------------------------
2025-11-28T17:41:05.5085704Z [33mWARNING [0m apps.memory_api.main:main.py:209 {'errors': [{'type': 'string_too_short', 'loc': ('body', 'query'), 'msg': 'String should have at least 1 character', 'input': '', 'ctx': {'min_length': 1}}], 'path': '/v1/search/hybrid', 'method': 'POST', 'event': 'validation_error', 'level': 'warning', 'logger': 'apps.memory_api.main', 'timestamp': '2025-11-28T17:40:03.309826Z'}
2025-11-28T17:41:05.5087543Z [31m[1m__________________ test_hybrid_search_all_strategies_disabled __________________[0m
2025-11-28T17:41:05.5088109Z [1m[31mtests/api/v1/test_search_hybrid.py[0m:533: in test_hybrid_search_all_strategies_disabled
2025-11-28T17:41:05.5088668Z     [0m[94massert[39;49;00m response.status_code == [94m200[39;49;00m[90m[39;49;00m
2025-11-28T17:41:05.5089043Z [1m[31mE   assert 500 == 200[0m
2025-11-28T17:41:05.5089528Z [1m[31mE    +  where 500 = <Response [500 Internal Server Error]>.status_code[0m
2025-11-28T17:41:05.5089921Z ----------------------------- Captured stdout call -----------------------------
2025-11-28T17:41:05.5090684Z {"error": "'dict' object has no attribute 'total_results'", "query": "test query", "event": "hybrid_search_failed", "level": "error", "logger": "apps.memory_api.routes.hybrid_search", "timestamp": "2025-11-28T17:40:03.361762Z"}
2025-11-28T17:41:05.5091898Z {"status_code": 500, "detail": "'dict' object has no attribute 'total_results'", "path": "/v1/search/hybrid", "method": "POST", "event": "http_exception", "level": "warning", "logger": "apps.memory_api.main", "timestamp": "2025-11-28T17:40:03.362017Z"}
2025-11-28T17:41:05.5093065Z 
2025-11-28T17:41:05.5093371Z DEBUG: Response 500: {'error': {'code': '500', 'message': "'dict' object has no attribute 'total_results'"}}
2025-11-28T17:41:05.5093979Z ------------------------------ Captured log call -------------------------------
2025-11-28T17:41:05.5095134Z [1m[31mERROR   [0m apps.memory_api.routes.hybrid_search:hybrid_search.py:95 {'error': "'dict' object has no attribute 'total_results'", 'query': 'test query', 'event': 'hybrid_search_failed', 'level': 'error', 'logger': 'apps.memory_api.routes.hybrid_search', 'timestamp': '2025-11-28T17:40:03.361762Z'}
2025-11-28T17:41:05.5096825Z [33mWARNING [0m apps.memory_api.main:main.py:194 {'status_code': 500, 'detail': "'dict' object has no attribute 'total_results'", 'path': '/v1/search/hybrid', 'method': 'POST', 'event': 'http_exception', 'level': 'warning', 'logger': 'apps.memory_api.main', 'timestamp': '2025-11-28T17:40:03.362017Z'}
2025-11-28T17:41:05.5097852Z [31m[1m____________________________ test_basic_completion _____________________________[0m
2025-11-28T17:41:05.5098316Z [1m[31mapps/llm/providers/openai_provider.py[0m:125: in complete
2025-11-28T17:41:05.5098904Z     [0mresponse = [94mawait[39;49;00m [96mself[39;49;00m.client.chat.completions.create(**params)[90m[39;49;00m
2025-11-28T17:41:05.5099648Z                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5100366Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/openai/resources/chat/completions/completions.py[0m:2672: in create
2025-11-28T17:41:05.5101127Z     [0m[94mreturn[39;49;00m [94mawait[39;49;00m [96mself[39;49;00m._post([90m[39;49;00m
2025-11-28T17:41:05.5101780Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/openai/_base_client.py[0m:1794: in post
2025-11-28T17:41:05.5102592Z     [0m[94mreturn[39;49;00m [94mawait[39;49;00m [96mself[39;49;00m.request(cast_to, opts, stream=stream, stream_cls=stream_cls)[90m[39;49;00m
2025-11-28T17:41:05.5103148Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5103738Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/openai/_base_client.py[0m:1594: in request
2025-11-28T17:41:05.5104609Z     [0m[94mraise[39;49;00m [96mself[39;49;00m._make_status_error_from_response(err.response) [94mfrom[39;49;00m[90m [39;49;00m[94mNone[39;49;00m[90m[39;49;00m
2025-11-28T17:41:05.5105977Z [1m[31mE   openai.AuthenticationError: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-test-key. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'code': 'invalid_api_key', 'param': None}}[0m
2025-11-28T17:41:05.5106996Z 
2025-11-28T17:41:05.5107450Z [33mDuring handling of the above exception, another exception occurred:[0m
2025-11-28T17:41:05.5108239Z [1m[31mtests/llm/test_llm_provider_contract.py[0m:106: in test_basic_completion
2025-11-28T17:41:05.5108777Z     [0mresponse = [94mawait[39;49;00m openai_provider.complete(request)[90m[39;49;00m
2025-11-28T17:41:05.5109325Z                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5109960Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/tenacity/asyncio/__init__.py[0m:189: in async_wrapped
2025-11-28T17:41:05.5110663Z     [0m[94mreturn[39;49;00m [94mawait[39;49;00m copy(fn, *args, **kwargs)[90m[39;49;00m
2025-11-28T17:41:05.5111066Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5111664Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/tenacity/asyncio/__init__.py[0m:111: in __call__
2025-11-28T17:41:05.5112363Z     [0mdo = [94mawait[39;49;00m [96mself[39;49;00m.iter(retry_state=retry_state)[90m[39;49;00m
2025-11-28T17:41:05.5112786Z          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5113369Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/tenacity/asyncio/__init__.py[0m:153: in iter
2025-11-28T17:41:05.5114131Z     [0mresult = [94mawait[39;49;00m action(retry_state)[90m[39;49;00m
2025-11-28T17:41:05.5114490Z              ^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5115029Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/tenacity/_utils.py[0m:99: in inner
2025-11-28T17:41:05.5115602Z     [0m[94mreturn[39;49;00m call(*args, **kwargs)[90m[39;49;00m
2025-11-28T17:41:05.5115939Z            ^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5116489Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/tenacity/__init__.py[0m:420: in exc_check
2025-11-28T17:41:05.5117066Z     [0m[94mraise[39;49;00m retry_exc.reraise()[90m[39;49;00m
2025-11-28T17:41:05.5117389Z           ^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5117931Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/tenacity/__init__.py[0m:187: in reraise
2025-11-28T17:41:05.5118559Z     [0m[94mraise[39;49;00m [96mself[39;49;00m.last_attempt.result()[90m[39;49;00m
2025-11-28T17:41:05.5118937Z           ^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5119569Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/concurrent/futures/_base.py[0m:449: in result
2025-11-28T17:41:05.5120149Z     [0m[94mreturn[39;49;00m [96mself[39;49;00m.__get_result()[90m[39;49;00m
2025-11-28T17:41:05.5120506Z            ^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5121045Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/concurrent/futures/_base.py[0m:401: in __get_result
2025-11-28T17:41:05.5121636Z     [0m[94mraise[39;49;00m [96mself[39;49;00m._exception[90m[39;49;00m
2025-11-28T17:41:05.5122291Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/tenacity/asyncio/__init__.py[0m:114: in __call__
2025-11-28T17:41:05.5122919Z     [0mresult = [94mawait[39;49;00m fn(*args, **kwargs)[90m[39;49;00m
2025-11-28T17:41:05.5123283Z              ^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5123659Z [1m[31mapps/llm/providers/openai_provider.py[0m:162: in complete
2025-11-28T17:41:05.5124068Z     [0m[94mraise[39;49;00m LLMAuthError([90m[39;49;00m
2025-11-28T17:41:05.5125336Z [1m[31mE   apps.llm.models.llm_error.LLMAuthError: OpenAI authentication failed: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-test-key. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'code': 'invalid_api_key', 'param': None}}[0m
2025-11-28T17:41:05.5126660Z [31m[1m________________________________ test_json_mode ________________________________[0m
2025-11-28T17:41:05.5127108Z [1m[31mapps/llm/providers/openai_provider.py[0m:125: in complete
2025-11-28T17:41:05.5127691Z     [0mresponse = [94mawait[39;49;00m [96mself[39;49;00m.client.chat.completions.create(**params)[90m[39;49;00m
2025-11-28T17:41:05.5128200Z                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5128909Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/openai/resources/chat/completions/completions.py[0m:2672: in create
2025-11-28T17:41:05.5129777Z     [0m[94mreturn[39;49;00m [94mawait[39;49;00m [96mself[39;49;00m._post([90m[39;49;00m
2025-11-28T17:41:05.5130437Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/openai/_base_client.py[0m:1794: in post
2025-11-28T17:41:05.5131239Z     [0m[94mreturn[39;49;00m [94mawait[39;49;00m [96mself[39;49;00m.request(cast_to, opts, stream=stream, stream_cls=stream_cls)[90m[39;49;00m
2025-11-28T17:41:05.5131810Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5132397Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/openai/_base_client.py[0m:1594: in request
2025-11-28T17:41:05.5133399Z     [0m[94mraise[39;49;00m [96mself[39;49;00m._make_status_error_from_response(err.response) [94mfrom[39;49;00m[90m [39;49;00m[94mNone[39;49;00m[90m[39;49;00m
2025-11-28T17:41:05.5134746Z [1m[31mE   openai.AuthenticationError: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-test-key. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'code': 'invalid_api_key', 'param': None}}[0m
2025-11-28T17:41:05.5135566Z 
2025-11-28T17:41:05.5135808Z [33mDuring handling of the above exception, another exception occurred:[0m
2025-11-28T17:41:05.5136301Z [1m[31mtests/llm/test_llm_provider_contract.py[0m:134: in test_json_mode
2025-11-28T17:41:05.5136812Z     [0mresponse = [94mawait[39;49;00m openai_provider.complete(request)[90m[39;49;00m
2025-11-28T17:41:05.5137235Z                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5137864Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/tenacity/asyncio/__init__.py[0m:189: in async_wrapped
2025-11-28T17:41:05.5138569Z     [0m[94mreturn[39;49;00m [94mawait[39;49;00m copy(fn, *args, **kwargs)[90m[39;49;00m
2025-11-28T17:41:05.5138965Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5139751Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/tenacity/asyncio/__init__.py[0m:111: in __call__
2025-11-28T17:41:05.5140450Z     [0mdo = [94mawait[39;49;00m [96mself[39;49;00m.iter(retry_state=retry_state)[90m[39;49;00m
2025-11-28T17:41:05.5140875Z          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5141461Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/tenacity/asyncio/__init__.py[0m:153: in iter
2025-11-28T17:41:05.5142076Z     [0mresult = [94mawait[39;49;00m action(retry_state)[90m[39;49;00m
2025-11-28T17:41:05.5142435Z              ^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5142975Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/tenacity/_utils.py[0m:99: in inner
2025-11-28T17:41:05.5143540Z     [0m[94mreturn[39;49;00m call(*args, **kwargs)[90m[39;49;00m
2025-11-28T17:41:05.5143875Z            ^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5144437Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/tenacity/__init__.py[0m:420: in exc_check
2025-11-28T17:41:05.5145004Z     [0m[94mraise[39;49;00m retry_exc.reraise()[90m[39;49;00m
2025-11-28T17:41:05.5145329Z           ^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5146008Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/tenacity/__init__.py[0m:187: in reraise
2025-11-28T17:41:05.5146633Z     [0m[94mraise[39;49;00m [96mself[39;49;00m.last_attempt.result()[90m[39;49;00m
2025-11-28T17:41:05.5147006Z           ^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5147535Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/concurrent/futures/_base.py[0m:449: in result
2025-11-28T17:41:05.5148203Z     [0m[94mreturn[39;49;00m [96mself[39;49;00m.__get_result()[90m[39;49;00m
2025-11-28T17:41:05.5148551Z            ^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5149198Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/concurrent/futures/_base.py[0m:401: in __get_result
2025-11-28T17:41:05.5149790Z     [0m[94mraise[39;49;00m [96mself[39;49;00m._exception[90m[39;49;00m
2025-11-28T17:41:05.5150452Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/tenacity/asyncio/__init__.py[0m:114: in __call__
2025-11-28T17:41:05.5151083Z     [0mresult = [94mawait[39;49;00m fn(*args, **kwargs)[90m[39;49;00m
2025-11-28T17:41:05.5151439Z              ^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5151812Z [1m[31mapps/llm/providers/openai_provider.py[0m:162: in complete
2025-11-28T17:41:05.5152336Z     [0m[94mraise[39;49;00m LLMAuthError([90m[39;49;00m
2025-11-28T17:41:05.5153578Z [1m[31mE   apps.llm.models.llm_error.LLMAuthError: OpenAI authentication failed: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-test-key. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'code': 'invalid_api_key', 'param': None}}[0m
2025-11-28T17:41:05.5154730Z [31m[1m________________________________ test_streaming ________________________________[0m
2025-11-28T17:41:05.5155174Z [1m[31mapps/llm/providers/openai_provider.py[0m:216: in stream
2025-11-28T17:41:05.5155734Z     [0mstream = [94mawait[39;49;00m [96mself[39;49;00m.client.chat.completions.create(**params)[90m[39;49;00m
2025-11-28T17:41:05.5156227Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5156928Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/openai/resources/chat/completions/completions.py[0m:2672: in create
2025-11-28T17:41:05.5157721Z     [0m[94mreturn[39;49;00m [94mawait[39;49;00m [96mself[39;49;00m._post([90m[39;49;00m
2025-11-28T17:41:05.5158374Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/openai/_base_client.py[0m:1794: in post
2025-11-28T17:41:05.5159267Z     [0m[94mreturn[39;49;00m [94mawait[39;49;00m [96mself[39;49;00m.request(cast_to, opts, stream=stream, stream_cls=stream_cls)[90m[39;49;00m
2025-11-28T17:41:05.5159835Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5160418Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/openai/_base_client.py[0m:1594: in request
2025-11-28T17:41:05.5161300Z     [0m[94mraise[39;49;00m [96mself[39;49;00m._make_status_error_from_response(err.response) [94mfrom[39;49;00m[90m [39;49;00m[94mNone[39;49;00m[90m[39;49;00m
2025-11-28T17:41:05.5162626Z [1m[31mE   openai.AuthenticationError: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-test-key. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'code': 'invalid_api_key', 'param': None}}[0m
2025-11-28T17:41:05.5163442Z 
2025-11-28T17:41:05.5163680Z [33mDuring handling of the above exception, another exception occurred:[0m
2025-11-28T17:41:05.5164169Z [1m[31mtests/llm/test_llm_provider_contract.py[0m:158: in test_streaming
2025-11-28T17:41:05.5164748Z     [0m[94masync[39;49;00m [94mfor[39;49;00m chunk [95min[39;49;00m openai_provider.stream(request):[90m[39;49;00m
2025-11-28T17:41:05.5165404Z [1m[31mapps/llm/providers/openai_provider.py[0m:234: in stream
2025-11-28T17:41:05.5165789Z     [0m[94mraise[39;49;00m LLMAuthError([90m[39;49;00m
2025-11-28T17:41:05.5167017Z [1m[31mE   apps.llm.models.llm_error.LLMAuthError: OpenAI authentication failed: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-test-key. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'code': 'invalid_api_key', 'param': None}}[0m
2025-11-28T17:41:05.5168164Z [31m[1m_______________________________ test_token_usage _______________________________[0m
2025-11-28T17:41:05.5168608Z [1m[31mapps/llm/providers/openai_provider.py[0m:125: in complete
2025-11-28T17:41:05.5169287Z     [0mresponse = [94mawait[39;49;00m [96mself[39;49;00m.client.chat.completions.create(**params)[90m[39;49;00m
2025-11-28T17:41:05.5169794Z                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5170498Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/openai/resources/chat/completions/completions.py[0m:2672: in create
2025-11-28T17:41:05.5171261Z     [0m[94mreturn[39;49;00m [94mawait[39;49;00m [96mself[39;49;00m._post([90m[39;49;00m
2025-11-28T17:41:05.5171903Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/openai/_base_client.py[0m:1794: in post
2025-11-28T17:41:05.5172821Z     [0m[94mreturn[39;49;00m [94mawait[39;49;00m [96mself[39;49;00m.request(cast_to, opts, stream=stream, stream_cls=stream_cls)[90m[39;49;00m
2025-11-28T17:41:05.5173380Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5173968Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/openai/_base_client.py[0m:1594: in request
2025-11-28T17:41:05.5174842Z     [0m[94mraise[39;49;00m [96mself[39;49;00m._make_status_error_from_response(err.response) [94mfrom[39;49;00m[90m [39;49;00m[94mNone[39;49;00m[90m[39;49;00m
2025-11-28T17:41:05.5176177Z [1m[31mE   openai.AuthenticationError: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-test-key. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'code': 'invalid_api_key', 'param': None}}[0m
2025-11-28T17:41:05.5176996Z 
2025-11-28T17:41:05.5177235Z [33mDuring handling of the above exception, another exception occurred:[0m
2025-11-28T17:41:05.5177728Z [1m[31mtests/llm/test_llm_provider_contract.py[0m:176: in test_token_usage
2025-11-28T17:41:05.5178245Z     [0mresponse = [94mawait[39;49;00m openai_provider.complete(request)[90m[39;49;00m
2025-11-28T17:41:05.5178663Z                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5179470Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/tenacity/asyncio/__init__.py[0m:189: in async_wrapped
2025-11-28T17:41:05.5180179Z     [0m[94mreturn[39;49;00m [94mawait[39;49;00m copy(fn, *args, **kwargs)[90m[39;49;00m
2025-11-28T17:41:05.5180583Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5181173Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/tenacity/asyncio/__init__.py[0m:111: in __call__
2025-11-28T17:41:05.5181870Z     [0mdo = [94mawait[39;49;00m [96mself[39;49;00m.iter(retry_state=retry_state)[90m[39;49;00m
2025-11-28T17:41:05.5182290Z          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5182870Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/tenacity/asyncio/__init__.py[0m:153: in iter
2025-11-28T17:41:05.5183486Z     [0mresult = [94mawait[39;49;00m action(retry_state)[90m[39;49;00m
2025-11-28T17:41:05.5183847Z              ^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5184383Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/tenacity/_utils.py[0m:99: in inner
2025-11-28T17:41:05.5185076Z     [0m[94mreturn[39;49;00m call(*args, **kwargs)[90m[39;49;00m
2025-11-28T17:41:05.5185409Z            ^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5185965Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/tenacity/__init__.py[0m:420: in exc_check
2025-11-28T17:41:05.5186540Z     [0m[94mraise[39;49;00m retry_exc.reraise()[90m[39;49;00m
2025-11-28T17:41:05.5186861Z           ^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5187405Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/tenacity/__init__.py[0m:187: in reraise
2025-11-28T17:41:05.5188023Z     [0m[94mraise[39;49;00m [96mself[39;49;00m.last_attempt.result()[90m[39;49;00m
2025-11-28T17:41:05.5188395Z           ^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5188919Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/concurrent/futures/_base.py[0m:449: in result
2025-11-28T17:41:05.5189615Z     [0m[94mreturn[39;49;00m [96mself[39;49;00m.__get_result()[90m[39;49;00m
2025-11-28T17:41:05.5189971Z            ^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5190504Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/concurrent/futures/_base.py[0m:401: in __get_result
2025-11-28T17:41:05.5191215Z     [0m[94mraise[39;49;00m [96mself[39;49;00m._exception[90m[39;49;00m
2025-11-28T17:41:05.5191867Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/tenacity/asyncio/__init__.py[0m:114: in __call__
2025-11-28T17:41:05.5192489Z     [0mresult = [94mawait[39;49;00m fn(*args, **kwargs)[90m[39;49;00m
2025-11-28T17:41:05.5192841Z              ^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5193214Z [1m[31mapps/llm/providers/openai_provider.py[0m:162: in complete
2025-11-28T17:41:05.5193612Z     [0m[94mraise[39;49;00m LLMAuthError([90m[39;49;00m
2025-11-28T17:41:05.5194844Z [1m[31mE   apps.llm.models.llm_error.LLMAuthError: OpenAI authentication failed: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-test-key. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'code': 'invalid_api_key', 'param': None}}[0m
2025-11-28T17:41:05.5196011Z [31m[1m___________________________ test_temperature_control ___________________________[0m
2025-11-28T17:41:05.5196474Z [1m[31mapps/llm/providers/openai_provider.py[0m:125: in complete
2025-11-28T17:41:05.5197055Z     [0mresponse = [94mawait[39;49;00m [96mself[39;49;00m.client.chat.completions.create(**params)[90m[39;49;00m
2025-11-28T17:41:05.5197551Z                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5198287Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/openai/resources/chat/completions/completions.py[0m:2672: in create
2025-11-28T17:41:05.5199070Z     [0m[94mreturn[39;49;00m [94mawait[39;49;00m [96mself[39;49;00m._post([90m[39;49;00m
2025-11-28T17:41:05.5199845Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/openai/_base_client.py[0m:1794: in post
2025-11-28T17:41:05.5200642Z     [0m[94mreturn[39;49;00m [94mawait[39;49;00m [96mself[39;49;00m.request(cast_to, opts, stream=stream, stream_cls=stream_cls)[90m[39;49;00m
2025-11-28T17:41:05.5201210Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5201796Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/openai/_base_client.py[0m:1594: in request
2025-11-28T17:41:05.5202685Z     [0m[94mraise[39;49;00m [96mself[39;49;00m._make_status_error_from_response(err.response) [94mfrom[39;49;00m[90m [39;49;00m[94mNone[39;49;00m[90m[39;49;00m
2025-11-28T17:41:05.5204038Z [1m[31mE   openai.AuthenticationError: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-test-key. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'code': 'invalid_api_key', 'param': None}}[0m
2025-11-28T17:41:05.5204971Z 
2025-11-28T17:41:05.5205213Z [33mDuring handling of the above exception, another exception occurred:[0m
2025-11-28T17:41:05.5205739Z [1m[31mtests/llm/test_llm_provider_contract.py[0m:197: in test_temperature_control
2025-11-28T17:41:05.5206313Z     [0mresponse1 = [94mawait[39;49;00m openai_provider.complete(request_zero)[90m[39;49;00m
2025-11-28T17:41:05.5206758Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5207380Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/tenacity/asyncio/__init__.py[0m:189: in async_wrapped
2025-11-28T17:41:05.5208078Z     [0m[94mreturn[39;49;00m [94mawait[39;49;00m copy(fn, *args, **kwargs)[90m[39;49;00m
2025-11-28T17:41:05.5208479Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5209071Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/tenacity/asyncio/__init__.py[0m:111: in __call__
2025-11-28T17:41:05.5209878Z     [0mdo = [94mawait[39;49;00m [96mself[39;49;00m.iter(retry_state=retry_state)[90m[39;49;00m
2025-11-28T17:41:05.5210300Z          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5211004Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/tenacity/asyncio/__init__.py[0m:153: in iter
2025-11-28T17:41:05.5211630Z     [0mresult = [94mawait[39;49;00m action(retry_state)[90m[39;49;00m
2025-11-28T17:41:05.5211985Z              ^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5212520Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/tenacity/_utils.py[0m:99: in inner
2025-11-28T17:41:05.5213082Z     [0m[94mreturn[39;49;00m call(*args, **kwargs)[90m[39;49;00m
2025-11-28T17:41:05.5213414Z            ^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5213976Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/tenacity/__init__.py[0m:420: in exc_check
2025-11-28T17:41:05.5214546Z     [0m[94mraise[39;49;00m retry_exc.reraise()[90m[39;49;00m
2025-11-28T17:41:05.5214868Z           ^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5215407Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/tenacity/__init__.py[0m:187: in reraise
2025-11-28T17:41:05.5216037Z     [0m[94mraise[39;49;00m [96mself[39;49;00m.last_attempt.result()[90m[39;49;00m
2025-11-28T17:41:05.5216414Z           ^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5216939Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/concurrent/futures/_base.py[0m:449: in result
2025-11-28T17:41:05.5217520Z     [0m[94mreturn[39;49;00m [96mself[39;49;00m.__get_result()[90m[39;49;00m
2025-11-28T17:41:05.5217874Z            ^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5218413Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/concurrent/futures/_base.py[0m:401: in __get_result
2025-11-28T17:41:05.5218996Z     [0m[94mraise[39;49;00m [96mself[39;49;00m._exception[90m[39;49;00m
2025-11-28T17:41:05.5219853Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/tenacity/asyncio/__init__.py[0m:114: in __call__
2025-11-28T17:41:05.5220487Z     [0mresult = [94mawait[39;49;00m fn(*args, **kwargs)[90m[39;49;00m
2025-11-28T17:41:05.5220844Z              ^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5221214Z [1m[31mapps/llm/providers/openai_provider.py[0m:162: in complete
2025-11-28T17:41:05.5221611Z     [0m[94mraise[39;49;00m LLMAuthError([90m[39;49;00m
2025-11-28T17:41:05.5222855Z [1m[31mE   apps.llm.models.llm_error.LLMAuthError: OpenAI authentication failed: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-test-key. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'code': 'invalid_api_key', 'param': None}}[0m
2025-11-28T17:41:05.5224140Z [31m[1m_______________________________ test_max_tokens ________________________________[0m
2025-11-28T17:41:05.5224590Z [1m[31mapps/llm/providers/openai_provider.py[0m:125: in complete
2025-11-28T17:41:05.5225175Z     [0mresponse = [94mawait[39;49;00m [96mself[39;49;00m.client.chat.completions.create(**params)[90m[39;49;00m
2025-11-28T17:41:05.5225681Z                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5226389Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/openai/resources/chat/completions/completions.py[0m:2672: in create
2025-11-28T17:41:05.5227143Z     [0m[94mreturn[39;49;00m [94mawait[39;49;00m [96mself[39;49;00m._post([90m[39;49;00m
2025-11-28T17:41:05.5227798Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/openai/_base_client.py[0m:1794: in post
2025-11-28T17:41:05.5228598Z     [0m[94mreturn[39;49;00m [94mawait[39;49;00m [96mself[39;49;00m.request(cast_to, opts, stream=stream, stream_cls=stream_cls)[90m[39;49;00m
2025-11-28T17:41:05.5229275Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5229864Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/openai/_base_client.py[0m:1594: in request
2025-11-28T17:41:05.5230903Z     [0m[94mraise[39;49;00m [96mself[39;49;00m._make_status_error_from_response(err.response) [94mfrom[39;49;00m[90m [39;49;00m[94mNone[39;49;00m[90m[39;49;00m
2025-11-28T17:41:05.5232269Z [1m[31mE   openai.AuthenticationError: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-test-key. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'code': 'invalid_api_key', 'param': None}}[0m
2025-11-28T17:41:05.5233105Z 
2025-11-28T17:41:05.5233344Z [33mDuring handling of the above exception, another exception occurred:[0m
2025-11-28T17:41:05.5233845Z [1m[31mtests/llm/test_llm_provider_contract.py[0m:216: in test_max_tokens
2025-11-28T17:41:05.5234357Z     [0mresponse = [94mawait[39;49;00m openai_provider.complete(request)[90m[39;49;00m
2025-11-28T17:41:05.5234785Z                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5235429Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/tenacity/asyncio/__init__.py[0m:189: in async_wrapped
2025-11-28T17:41:05.5236130Z     [0m[94mreturn[39;49;00m [94mawait[39;49;00m copy(fn, *args, **kwargs)[90m[39;49;00m
2025-11-28T17:41:05.5236530Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5237128Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/tenacity/asyncio/__init__.py[0m:111: in __call__
2025-11-28T17:41:05.5237824Z     [0mdo = [94mawait[39;49;00m [96mself[39;49;00m.iter(retry_state=retry_state)[90m[39;49;00m
2025-11-28T17:41:05.5238249Z          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5238834Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/tenacity/asyncio/__init__.py[0m:153: in iter
2025-11-28T17:41:05.5239562Z     [0mresult = [94mawait[39;49;00m action(retry_state)[90m[39;49;00m
2025-11-28T17:41:05.5239934Z              ^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5240468Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/tenacity/_utils.py[0m:99: in inner
2025-11-28T17:41:05.5241036Z     [0m[94mreturn[39;49;00m call(*args, **kwargs)[90m[39;49;00m
2025-11-28T17:41:05.5241383Z            ^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5241942Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/tenacity/__init__.py[0m:420: in exc_check
2025-11-28T17:41:05.5242510Z     [0m[94mraise[39;49;00m retry_exc.reraise()[90m[39;49;00m
2025-11-28T17:41:05.5242962Z           ^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5243510Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/tenacity/__init__.py[0m:187: in reraise
2025-11-28T17:41:05.5244129Z     [0m[94mraise[39;49;00m [96mself[39;49;00m.last_attempt.result()[90m[39;49;00m
2025-11-28T17:41:05.5244513Z           ^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5245038Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/concurrent/futures/_base.py[0m:449: in result
2025-11-28T17:41:05.5245625Z     [0m[94mreturn[39;49;00m [96mself[39;49;00m.__get_result()[90m[39;49;00m
2025-11-28T17:41:05.5245975Z            ^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5246518Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/concurrent/futures/_base.py[0m:401: in __get_result
2025-11-28T17:41:05.5247110Z     [0m[94mraise[39;49;00m [96mself[39;49;00m._exception[90m[39;49;00m
2025-11-28T17:41:05.5247771Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/tenacity/asyncio/__init__.py[0m:114: in __call__
2025-11-28T17:41:05.5248395Z     [0mresult = [94mawait[39;49;00m fn(*args, **kwargs)[90m[39;49;00m
2025-11-28T17:41:05.5248751Z              ^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5249380Z [1m[31mapps/llm/providers/openai_provider.py[0m:162: in complete
2025-11-28T17:41:05.5249781Z     [0m[94mraise[39;49;00m LLMAuthError([90m[39;49;00m
2025-11-28T17:41:05.5251027Z [1m[31mE   apps.llm.models.llm_error.LLMAuthError: OpenAI authentication failed: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-test-key. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'code': 'invalid_api_key', 'param': None}}[0m
2025-11-28T17:41:05.5252234Z [31m[1m___________ test_provider_contract_hello_world[openai-gpt-3.5-turbo] ___________[0m
2025-11-28T17:41:05.5252728Z [1m[31mapps/llm/providers/openai_provider.py[0m:125: in complete
2025-11-28T17:41:05.5253313Z     [0mresponse = [94mawait[39;49;00m [96mself[39;49;00m.client.chat.completions.create(**params)[90m[39;49;00m
2025-11-28T17:41:05.5253811Z                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5254519Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/openai/resources/chat/completions/completions.py[0m:2672: in create
2025-11-28T17:41:05.5255289Z     [0m[94mreturn[39;49;00m [94mawait[39;49;00m [96mself[39;49;00m._post([90m[39;49;00m
2025-11-28T17:41:05.5255943Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/openai/_base_client.py[0m:1794: in post
2025-11-28T17:41:05.5256742Z     [0m[94mreturn[39;49;00m [94mawait[39;49;00m [96mself[39;49;00m.request(cast_to, opts, stream=stream, stream_cls=stream_cls)[90m[39;49;00m
2025-11-28T17:41:05.5257337Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5257929Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/openai/_base_client.py[0m:1594: in request
2025-11-28T17:41:05.5258805Z     [0m[94mraise[39;49;00m [96mself[39;49;00m._make_status_error_from_response(err.response) [94mfrom[39;49;00m[90m [39;49;00m[94mNone[39;49;00m[90m[39;49;00m
2025-11-28T17:41:05.5260343Z [1m[31mE   openai.AuthenticationError: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-test-key. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'code': 'invalid_api_key', 'param': None}}[0m
2025-11-28T17:41:05.5261165Z 
2025-11-28T17:41:05.5261401Z [33mDuring handling of the above exception, another exception occurred:[0m
2025-11-28T17:41:05.5261961Z [1m[31mtests/llm/test_llm_provider_contract.py[0m:247: in test_provider_contract_hello_world
2025-11-28T17:41:05.5262524Z     [0mresponse = [94mawait[39;49;00m provider.complete(llm_request)[90m[39;49;00m
2025-11-28T17:41:05.5263072Z                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5263719Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/tenacity/asyncio/__init__.py[0m:189: in async_wrapped
2025-11-28T17:41:05.5264424Z     [0m[94mreturn[39;49;00m [94mawait[39;49;00m copy(fn, *args, **kwargs)[90m[39;49;00m
2025-11-28T17:41:05.5264826Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5265417Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/tenacity/asyncio/__init__.py[0m:111: in __call__
2025-11-28T17:41:05.5266113Z     [0mdo = [94mawait[39;49;00m [96mself[39;49;00m.iter(retry_state=retry_state)[90m[39;49;00m
2025-11-28T17:41:05.5266537Z          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5267120Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/tenacity/asyncio/__init__.py[0m:153: in iter
2025-11-28T17:41:05.5267738Z     [0mresult = [94mawait[39;49;00m action(retry_state)[90m[39;49;00m
2025-11-28T17:41:05.5268104Z              ^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5268640Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/tenacity/_utils.py[0m:99: in inner
2025-11-28T17:41:05.5269444Z     [0m[94mreturn[39;49;00m call(*args, **kwargs)[90m[39;49;00m
2025-11-28T17:41:05.5269779Z            ^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5270336Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/tenacity/__init__.py[0m:420: in exc_check
2025-11-28T17:41:05.5270914Z     [0m[94mraise[39;49;00m retry_exc.reraise()[90m[39;49;00m
2025-11-28T17:41:05.5271232Z           ^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5271778Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/tenacity/__init__.py[0m:187: in reraise
2025-11-28T17:41:05.5272409Z     [0m[94mraise[39;49;00m [96mself[39;49;00m.last_attempt.result()[90m[39;49;00m
2025-11-28T17:41:05.5272788Z           ^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5273309Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/concurrent/futures/_base.py[0m:449: in result
2025-11-28T17:41:05.5273899Z     [0m[94mreturn[39;49;00m [96mself[39;49;00m.__get_result()[90m[39;49;00m
2025-11-28T17:41:05.5274256Z            ^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5274788Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/concurrent/futures/_base.py[0m:401: in __get_result
2025-11-28T17:41:05.5275378Z     [0m[94mraise[39;49;00m [96mself[39;49;00m._exception[90m[39;49;00m
2025-11-28T17:41:05.5276032Z [1m[31m/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/tenacity/asyncio/__init__.py[0m:114: in __call__
2025-11-28T17:41:05.5276661Z     [0mresult = [94mawait[39;49;00m fn(*args, **kwargs)[90m[39;49;00m
2025-11-28T17:41:05.5277019Z              ^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5277397Z [1m[31mapps/llm/providers/openai_provider.py[0m:162: in complete
2025-11-28T17:41:05.5277795Z     [0m[94mraise[39;49;00m LLMAuthError([90m[39;49;00m
2025-11-28T17:41:05.5279039Z [1m[31mE   apps.llm.models.llm_error.LLMAuthError: OpenAI authentication failed: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-test-key. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'code': 'invalid_api_key', 'param': None}}[0m
2025-11-28T17:41:05.5280303Z [31m[1m____________________________ test_merge_node_edges _____________________________[0m
2025-11-28T17:41:05.5280819Z [1m[31mtests/repositories/test_graph_repository.py[0m:94: in test_merge_node_edges
2025-11-28T17:41:05.5281516Z     [0mresult = [94mawait[39;49;00m repo.merge_node_edges(source_node_id=[94m1[39;49;00m, target_node_id=[94m2[39;49;00m)[90m[39;49;00m
2025-11-28T17:41:05.5282197Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5282648Z [1m[31mapps/memory_api/repositories/graph_repository.py[0m:683: in merge_node_edges
2025-11-28T17:41:05.5283163Z     [0m[94masync[39;49;00m [94mwith[39;49;00m conn.transaction():[90m[39;49;00m
2025-11-28T17:41:05.5283732Z [1m[31mE   TypeError: 'coroutine' object does not support the asynchronous context manager protocol[0m
2025-11-28T17:41:05.5284293Z [31m[1m___________________________ test_store_graph_triples ___________________________[0m
2025-11-28T17:41:05.5284815Z [1m[31mtests/repositories/test_graph_repository.py[0m:291: in test_store_graph_triples
2025-11-28T17:41:05.5285340Z     [0mstats = [94mawait[39;49;00m repo.store_graph_triples([90m[39;49;00m
2025-11-28T17:41:05.5285864Z [1m[31mapps/memory_api/repositories/graph_repository.py[0m:521: in store_graph_triples
2025-11-28T17:41:05.5286384Z     [0m[94masync[39;49;00m [94mwith[39;49;00m conn.transaction():[90m[39;49;00m
2025-11-28T17:41:05.5286947Z [1m[31mE   TypeError: 'coroutine' object does not support the asynchronous context manager protocol[0m
2025-11-28T17:41:05.5287496Z [31m[1m______________________________ test_check_budget _______________________________[0m
2025-11-28T17:41:05.5288088Z [1m[31mtests/services/test_budget_service.py[0m:20: in test_check_budget
2025-11-28T17:41:05.5299701Z     [0m[94mawait[39;49;00m budget_service.check_budget(mock_pool, [33m"[39;49;00m[33mt1[39;49;00m[33m"[39;49;00m, [33m"[39;49;00m[33mp1[39;49;00m[33m"[39;49;00m, [94m0.1[39;49;00m)[90m[39;49;00m
2025-11-28T17:41:05.5300514Z           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5301000Z [1m[31mE   TypeError: check_budget() missing 1 required positional argument: 'tokens'[0m
2025-11-28T17:41:05.5301538Z [31m[1m____________________________ test_check_budget_fail ____________________________[0m
2025-11-28T17:41:05.5302051Z [1m[31mtests/services/test_budget_service.py[0m:35: in test_check_budget_fail
2025-11-28T17:41:05.5302867Z     [0m[94mawait[39;49;00m budget_service.check_budget(mock_pool, [33m"[39;49;00m[33mt1[39;49;00m[33m"[39;49;00m, [33m"[39;49;00m[33mp1[39;49;00m[33m"[39;49;00m, [94m0.2[39;49;00m)[90m[39;49;00m
2025-11-28T17:41:05.5303493Z           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5303944Z [1m[31mE   TypeError: check_budget() missing 1 required positional argument: 'tokens'[0m
2025-11-28T17:41:05.5304457Z [31m[1m_____________________________ test_reflection_flow _____________________________[0m
2025-11-28T17:41:05.5304951Z [1m[31mtests/services/test_reflection_engine.py[0m:17: in test_reflection_flow
2025-11-28T17:41:05.5305402Z     [0mengine = ReflectionEngine(mock_pool)[90m[39;49;00m
2025-11-28T17:41:05.5305736Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5306130Z [1m[31mapps/memory_api/services/reflection_engine.py[0m:82: in __init__
2025-11-28T17:41:05.5306649Z     [0m[96mself[39;49;00m.graph_extractor = GraphExtractionService(pool)[90m[39;49;00m
2025-11-28T17:41:05.5307085Z                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
2025-11-28T17:41:05.5307622Z [1m[31mE   TypeError: GraphExtractionService.__init__() missing 1 required positional argument: 'graph_repo'[0m
2025-11-28T17:41:05.5308234Z [31m[1m_____________________________ test_pydantic_models _____________________________[0m
2025-11-28T17:41:05.5308694Z [1m[31mtest_enterprise_features.py[0m:124: in test_pydantic_models
2025-11-28T17:41:05.5309402Z     [0m[94massert[39;49;00m graph_triple.source == [33m"[39;49;00m[33mEntity1[39;49;00m[33m"[39;49;00m[90m[39;49;00m
2025-11-28T17:41:05.5309922Z [1m[31mE   AssertionError: assert 'entity1' == 'Entity1'[0m
2025-11-28T17:41:05.5310229Z [1m[31mE     [0m
2025-11-28T17:41:05.5310503Z [1m[31mE     [0m[91m- Entity1[39;49;00m[90m[39;49;00m[0m
2025-11-28T17:41:05.5311001Z [1m[31mE     ? ^[90m[39;49;00m[0m
2025-11-28T17:41:05.5311309Z [1m[31mE     [92m+ entity1[39;49;00m[90m[39;49;00m[0m
2025-11-28T17:41:05.5311599Z [1m[31mE     ? ^[90m[39;49;00m[0m
2025-11-28T17:41:05.5311933Z [33m=============================== warnings summary ===============================[0m
2025-11-28T17:41:05.5312448Z ../../../../../opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/starlette/formparsers.py:12
2025-11-28T17:41:05.5313324Z   /opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/starlette/formparsers.py:12: PendingDeprecationWarning: Please use `import python_multipart` instead.
2025-11-28T17:41:05.5314002Z     import multipart
2025-11-28T17:41:05.5314121Z 
2025-11-28T17:41:05.5314431Z apps/memory_api/tests/test_reflective_flags.py::TestDreamingEnabled::test_dreaming_enabled_runs_dreaming
2025-11-28T17:41:05.5315102Z apps/memory_api/tests/test_reflective_flags.py::TestMaintenanceScheduler::test_maintenance_with_all_flags_enabled
2025-11-28T17:41:05.5316062Z   /home/runner/work/RAE-agentic-memory/RAE-agentic-memory/apps/memory_api/workers/memory_maintenance.py:369: RuntimeWarning: coroutine 'AsyncMockMixin._execute_mock_call' was never awaited
2025-11-28T17:41:05.5316794Z     async with self.pool.acquire() as conn:
2025-11-28T17:41:05.5317247Z   Enable tracemalloc to get traceback where the object was allocated.
2025-11-28T17:41:05.5317759Z   See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.
2025-11-28T17:41:05.5318118Z 
2025-11-28T17:41:05.5318294Z tests/repositories/test_graph_repository.py::test_merge_node_edges
2025-11-28T17:41:05.5319254Z   /home/runner/work/RAE-agentic-memory/RAE-agentic-memory/apps/memory_api/repositories/graph_repository.py:683: RuntimeWarning: coroutine 'test_merge_node_edges.<locals>.mock_transaction' was never awaited
2025-11-28T17:41:05.5320026Z     async with conn.transaction():
2025-11-28T17:41:05.5320338Z   Enable tracemalloc to get traceback where the object was allocated.
2025-11-28T17:41:05.5320837Z   See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.
2025-11-28T17:41:05.5321194Z 
2025-11-28T17:41:05.5321370Z tests/repositories/test_graph_repository.py::test_store_graph_triples
2025-11-28T17:41:05.5322236Z   /home/runner/work/RAE-agentic-memory/RAE-agentic-memory/apps/memory_api/repositories/graph_repository.py:521: RuntimeWarning: coroutine 'test_store_graph_triples.<locals>.mock_transaction' was never awaited
2025-11-28T17:41:05.5322999Z     async with conn.transaction():
2025-11-28T17:41:05.5323299Z   Enable tracemalloc to get traceback where the object was allocated.
2025-11-28T17:41:05.5323792Z   See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.
2025-11-28T17:41:05.5324138Z 
2025-11-28T17:41:05.5324260Z test_enterprise_features.py::test_decorator_import
2025-11-28T17:41:05.5325422Z   /home/runner/work/RAE-agentic-memory/RAE-agentic-memory/sdk/python/rae_memory_sdk/client.py:18: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
2025-11-28T17:41:05.5326558Z     class RAEClientConfig(BaseSettings):
2025-11-28T17:41:05.5326733Z 
2025-11-28T17:41:05.5326864Z test_enterprise_features.py::test_decorator_basic_usage
2025-11-28T17:41:05.5327966Z   /home/runner/work/RAE-agentic-memory/RAE-agentic-memory/sdk/python/rae_memory_sdk/client.py:109: PydanticDeprecatedSince20: The `dict` method is deprecated; use `model_dump` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
2025-11-28T17:41:05.5329070Z     "POST", "/memory/store", json=memory.dict(exclude_none=True)
2025-11-28T17:41:05.5329391Z 
2025-11-28T17:41:05.5329521Z test_enterprise_features.py::test_decorator_basic_usage
2025-11-28T17:41:05.5330735Z   /home/runner/work/RAE-agentic-memory/RAE-agentic-memory/sdk/python/rae_memory_sdk/client.py:420: PydanticDeprecatedSince20: The `dict` method is deprecated; use `model_dump` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
2025-11-28T17:41:05.5331837Z     "POST", "/memory/store", json=memory.dict(exclude_none=True)
2025-11-28T17:41:05.5332047Z 
2025-11-28T17:41:05.5332229Z -- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
2025-11-28T17:41:05.5332593Z ================================ tests coverage ================================
2025-11-28T17:41:05.5332960Z _______________ coverage: platform linux, python 3.11.14-final-0 _______________
2025-11-28T17:41:05.5333212Z 
2025-11-28T17:41:05.5333333Z Name                                                         Stmts   Miss  Cover   Missing
2025-11-28T17:41:05.5333676Z ------------------------------------------------------------------------------------------
2025-11-28T17:41:05.5334035Z apps/__init__.py                                                 0      0   100%
2025-11-28T17:41:05.5334370Z apps/llm/__init__.py                                             4      0   100%
2025-11-28T17:41:05.5334737Z apps/llm/broker/__init__.py                                      2      0   100%
2025-11-28T17:41:05.5335305Z apps/llm/broker/llm_router.py                                  104     90    13%   55-57, 61-74, 78-122, 131-153, 169-216, 228-252
2025-11-28T17:41:05.5335746Z apps/llm/models/__init__.py                                      4      0   100%
2025-11-28T17:41:05.5336137Z apps/llm/models/llm_error.py                                    18      0   100%
2025-11-28T17:41:05.5336542Z apps/llm/models/llm_request.py                                  25      0   100%
2025-11-28T17:41:05.5337000Z apps/llm/models/llm_response.py                                 20      0   100%
2025-11-28T17:41:05.5337408Z apps/llm/providers/__init__.py                                   9      0   100%
2025-11-28T17:41:05.5337896Z apps/llm/providers/anthropic_provider.py                        79     68    14%   42-47, 56-66, 70-73, 103-196, 212-247
2025-11-28T17:41:05.5338378Z apps/llm/providers/base.py                                       9      0   100%
2025-11-28T17:41:05.5338857Z apps/llm/providers/deepseek_provider.py                         78     67    14%   41-46, 50, 61-64, 97-195, 211-255
2025-11-28T17:41:05.5339611Z apps/llm/providers/gemini_provider.py                          103     92    11%   37-42, 51-63, 67-71, 101-208, 224-280
2025-11-28T17:41:05.5340153Z apps/llm/providers/grok_provider.py                             85     73    14%   42-47, 51, 62-65, 84-90, 113-215, 231-281
2025-11-28T17:41:05.5340674Z apps/llm/providers/ollama_provider.py                           69     58    16%   35-41, 50-61, 82-139, 155-201
2025-11-28T17:41:05.5341262Z apps/llm/providers/openai_provider.py                           76     25    67%   61, 111, 114, 117, 120, 123, 127-144, 154, 167-180, 208, 211, 214, 218-220, 228, 240
2025-11-28T17:41:05.5341859Z apps/llm/providers/qwen_provider.py                            100     89    11%   43-50, 65-71, 79-82, 117-236, 252-319
2025-11-28T17:41:05.5342308Z apps/memory_api/__init__.py                                      0      0   100%
2025-11-28T17:41:05.5342698Z apps/memory_api/api/__init__.py                                  0      0   100%
2025-11-28T17:41:05.5343093Z apps/memory_api/api/v1/__init__.py                               0      0   100%
2025-11-28T17:41:05.5343520Z apps/memory_api/api/v1/agent.py                                 86     65    24%   58-239, 266-288
2025-11-28T17:41:05.5343946Z apps/memory_api/api/v1/cache.py                                  7      0   100%
2025-11-28T17:41:05.5344404Z apps/memory_api/api/v1/governance.py                           124     75    40%   111-183, 207-310, 334-434
2025-11-28T17:41:05.5344934Z apps/memory_api/api/v1/graph.py                                193    123    36%   154-194, 223-276, 300-363, 404-516, 545-595, 632-688, 720-822
2025-11-28T17:41:05.5345636Z apps/memory_api/api/v1/health.py                               127     86    32%   59-95, 102-135, 142-174, 189-204, 228-265, 282-287, 303, 322-351
2025-11-28T17:41:05.5346177Z apps/memory_api/api/v1/memory.py                               128     96    25%   54-110, 140-247, 263-286, 310-320, 363-422
2025-11-28T17:41:05.5346635Z apps/memory_api/celery_app.py                                    4      0   100%
2025-11-28T17:41:05.5347203Z apps/memory_api/clients/rae_client.py                          270     32    88%   116-119, 242-244, 298, 374-383, 465, 472, 507-508, 512, 516, 561-562, 589, 604, 715, 741, 747, 796-802
2025-11-28T17:41:05.5347778Z apps/memory_api/config.py                                       89      5    94%   40, 141-144
2025-11-28T17:41:05.5348191Z apps/memory_api/cost_model.py                                    8      6    25%   53-61
2025-11-28T17:41:05.5348648Z apps/memory_api/dependencies.py                                 25     13    48%   64-66, 79-81, 102-109, 125-131
2025-11-28T17:41:05.5349195Z apps/memory_api/logging_config.py                               24      0   100%
2025-11-28T17:41:05.5349624Z apps/memory_api/main.py                                         81     14    83%   51-72, 115, 229-230, 249-250, 290
2025-11-28T17:41:05.5350151Z apps/memory_api/metrics.py                                      33      0   100%
2025-11-28T17:41:05.5350606Z apps/memory_api/middleware/cost_guard.py                       144    124    14%   63-95, 111-128, 166-476
2025-11-28T17:41:05.5351127Z apps/memory_api/middleware/rate_limiter.py                      51     31    39%   55-74, 106-114, 165-177, 200-211
2025-11-28T17:41:05.5351612Z apps/memory_api/middleware/tenant.py                             9      0   100%
2025-11-28T17:41:05.5352017Z apps/memory_api/models.py                                       68      0   100%
2025-11-28T17:41:05.5352409Z apps/memory_api/models/__init__.py                              22      0   100%
2025-11-28T17:41:05.5352841Z apps/memory_api/models/dashboard_models.py                     286      0   100%
2025-11-28T17:41:05.5353295Z apps/memory_api/models/evaluation_models.py                    256      0   100%
2025-11-28T17:41:05.5353739Z apps/memory_api/models/event_models.py                         244      0   100%
2025-11-28T17:41:05.5354161Z apps/memory_api/models/graph.py                                 17      0   100%
2025-11-28T17:41:05.5354590Z apps/memory_api/models/graph_enhanced_models.py                254      0   100%
2025-11-28T17:41:05.5355038Z apps/memory_api/models/hybrid_search_models.py                 164      0   100%
2025-11-28T17:41:05.5355489Z apps/memory_api/models/rbac.py                                  95     17    82%   135, 207-224, 234-239
2025-11-28T17:41:05.5355953Z apps/memory_api/models/reflection_models.py                    169      1    99%   69
2025-11-28T17:41:05.5356466Z apps/memory_api/models/reflection_v2_models.py                 149     14    91%   132-133, 171-180, 243-244
2025-11-28T17:41:05.5356972Z apps/memory_api/models/tenant.py                                94     11    88%   193-200, 212-215
2025-11-28T17:41:05.5357462Z apps/memory_api/observability/__init__.py                        2      0   100%
2025-11-28T17:41:05.5358097Z apps/memory_api/observability/opentelemetry_config.py          104     71    32%   136-191, 215-219, 235-254, 275-278, 292-298, 312-318, 352-363, 368-371, 380-383, 388-391
2025-11-28T17:41:05.5358714Z apps/memory_api/plugins/__init__.py                              2      0   100%
2025-11-28T17:41:05.5359392Z apps/memory_api/plugins/base.py                                190     44    77%   137, 185, 198, 214, 232, 242, 252, 268, 281, 296, 309, 329, 378-379, 421-426, 435-436, 456, 470-471, 501-535, 550-551
2025-11-28T17:41:05.5359975Z apps/memory_api/repositories/__init__.py                         0      0   100%
2025-11-28T17:41:05.5360565Z apps/memory_api/repositories/cost_logs_repository.py           141     60    57%   176-242, 279-357, 374-382, 401-408, 425-433, 452-459, 493-543, 577-634, 657-685
2025-11-28T17:41:05.5361422Z apps/memory_api/repositories/graph_repository.py               131     58    56%   53-139, 162, 180-216, 232-253, 275-293, 319-338, 358-380, 522-584, 685-722
2025-11-28T17:41:05.5362375Z apps/memory_api/repositories/graph_repository_enhanced.py      130     99    24%   60, 90-108, 114-127, 133-146, 162-184, 208-216, 260-297, 303-329, 335-350, 354-366, 372-386, 413-436, 471-534, 563-591, 618-631, 635-642, 648-660, 675-689, 708-740, 778-800, 808, 820, 841
2025-11-28T17:41:05.5363322Z apps/memory_api/repositories/memory_repository.py               77     61    21%   59-104, 122-140, 155-170, 185-196, 211-222, 238-263, 279-299, 315-335, 363-405
2025-11-28T17:41:05.5364102Z apps/memory_api/repositories/reflection_repository.py          158    140    11%   83-157, 174-185, 222-295, 312-333, 374-420, 443-471, 494-569, 591-600, 635-659, 669-689, 720
2025-11-28T17:41:05.5364724Z apps/memory_api/routes/__init__.py                               1      0   100%
2025-11-28T17:41:05.5365379Z apps/memory_api/routes/dashboard.py                            239    202    15%   68, 74-78, 114-163, 182-217, 240-274, 296-351, 368-397, 409-421, 444-466, 479, 490-556, 563-643, 650-720, 731-779, 791-806, 811-832, 837-860, 875
2025-11-28T17:41:05.5366253Z apps/memory_api/routes/evaluation.py                            91     59    35%   40, 64-89, 99, 160-193, 203, 250-280, 293-311, 331-358, 368, 406-418, 428, 454, 477
2025-11-28T17:41:05.5367029Z apps/memory_api/routes/event_triggers.py                       159    114    28%   48, 69-89, 95-109, 126-139, 145-154, 160-171, 177-188, 204-219, 237-267, 277, 312-334, 356-373, 379-391, 399-406, 421, 440-457, 479-512, 523, 555
2025-11-28T17:41:05.5367977Z apps/memory_api/routes/graph_enhanced.py                       225    179    20%   63, 79-94, 106-122, 134-151, 167-203, 211-226, 234-245, 253-264, 272-287, 306-361, 376-417, 432-457, 473-504, 510-526, 534-545, 557-581, 598-617, 632-654, 664-706, 717
2025-11-28T17:41:05.5368802Z apps/memory_api/routes/hybrid_search.py                        104     67    36%   89, 115-137, 148-167, 182-194, 209-228, 238-264, 282-369, 394-426, 437, 461
2025-11-28T17:41:05.5369555Z apps/memory_api/routes/reflections.py                           98     71    28%   45, 83-104, 142-200, 225-247, 270-282, 316-352, 387-420, 447-453, 481-510
2025-11-28T17:41:05.5370100Z apps/memory_api/security/__init__.py                             4      0   100%
2025-11-28T17:41:05.5370601Z apps/memory_api/security/auth.py                               106     80    25%   38-56, 81-128, 145-148, 163-165, 170-184, 189, 225-310, 334-423
2025-11-28T17:41:05.5371156Z apps/memory_api/security/dependencies.py                        48     29    40%   56, 78-84, 128-133, 155-210
2025-11-28T17:41:05.5371699Z apps/memory_api/security/rate_limit.py                          78     63    19%   31-32, 36-48, 63-77, 99-179, 189-191, 208-225
2025-11-28T17:41:05.5372276Z apps/memory_api/security/validation.py                          87     68    22%   40-56, 72-95, 111-150, 166-177, 193-203, 219-236, 252-269, 286-301
2025-11-28T17:41:05.5372793Z apps/memory_api/services/__init__.py                             0      0   100%
2025-11-28T17:41:05.5373257Z apps/memory_api/services/analytics.py                          193      4    98%   339-342, 346
2025-11-28T17:41:05.5373786Z apps/memory_api/services/budget_service.py                      88     52    41%   74, 95-136, 160-297, 323-351, 376-458, 487-521
2025-11-28T17:41:05.5374335Z apps/memory_api/services/community_detection.py                 81     12    85%   55, 83-100
2025-11-28T17:41:05.5374904Z apps/memory_api/services/context_builder.py                    139     74    47%   96, 177-239, 254-269, 283-339, 416, 431-476, 497-521
2025-11-28T17:41:05.5375463Z apps/memory_api/services/context_cache.py                       62     36    42%   21, 39-49, 63-102, 106
2025-11-28T17:41:05.5376204Z apps/memory_api/services/cost_controller.py                     55     43    22%   79-146, 171-174, 194-200, 224-241, 260-261, 277-284, 309, 344-359
2025-11-28T17:41:05.5376955Z apps/memory_api/services/dashboard_websocket.py                182     79    57%   131, 175-177, 201, 205-210, 247-253, 257-271, 296, 307, 346-357, 365-372, 410-425, 439-451, 461-498, 620-622, 638, 662-703
2025-11-28T17:41:05.5377710Z apps/memory_api/services/drift_detector.py                     108     33    69%   102-104, 118-124, 248, 292, 329, 333, 357-373, 423-434, 445
2025-11-28T17:41:05.5378274Z apps/memory_api/services/embedding.py                           28     15    46%   28-29, 36-55, 62-64, 72
2025-11-28T17:41:05.5378790Z apps/memory_api/services/entity_resolution.py                   74     16    78%   80-107, 158-161
2025-11-28T17:41:05.5379559Z apps/memory_api/services/evaluation_service.py                 139     82    41%   74-205, 233-234, 275, 330, 357-385, 408-442, 464-474
2025-11-28T17:41:05.5380337Z apps/memory_api/services/graph_algorithms.py                   298     41    86%   34, 55, 93, 126-127, 135-140, 160-165, 191-193, 231, 308, 329, 350-361, 394, 405, 418-419, 445, 451, 454, 490, 554, 573, 589, 665-671, 685-691
2025-11-28T17:41:05.5381149Z apps/memory_api/services/graph_extraction.py                   132     83    37%   39-47, 115, 192-203, 258-260, 264-265, 299-406, 415-467, 483, 497-515, 534-545
2025-11-28T17:41:05.5381975Z apps/memory_api/services/hybrid_cache.py                        90     71    21%   48-58, 82-105, 126-153, 176-185, 202-216, 225-236, 240-248, 257-260, 269, 283-285, 300-302
2025-11-28T17:41:05.5382637Z apps/memory_api/services/hybrid_search.py                      114     88    23%   81-83, 122-230, 254-308, 318, 341-358, 383-388, 411-470, 482-493
2025-11-28T17:41:05.5383296Z apps/memory_api/services/hybrid_search_service.py              226    207     8%   93-98, 145-336, 353-407, 418-473, 485-624, 636-680, 705-776, 796-850
2025-11-28T17:41:05.5384134Z apps/memory_api/services/importance_scoring.py                 159    111    30%   74, 99-114, 151-196, 204-214, 223-242, 252-263, 271-277, 281-290, 305-319, 343, 356, 417-491, 504, 532-539, 556-573, 589-609, 625, 646-649, 687-709
2025-11-28T17:41:05.5384863Z apps/memory_api/services/llm/__init__.py                        20      5    75%   21, 23, 26-33
2025-11-28T17:41:05.5385370Z apps/memory_api/services/llm/anthropic.py                       30     17    43%   18-21, 30-54, 65-78
2025-11-28T17:41:05.5385850Z apps/memory_api/services/llm/base.py                            14      0   100%
2025-11-28T17:41:05.5386311Z apps/memory_api/services/llm/gemini.py                          33     20    39%   18-22, 31-52, 63-74
2025-11-28T17:41:05.5386828Z apps/memory_api/services/llm/litellm_provider.py                19     10    47%   17-20, 28-43, 62-72
2025-11-28T17:41:05.5387344Z apps/memory_api/services/llm/ollama.py                          43     27    37%   20, 30-62, 73-95
2025-11-28T17:41:05.5387839Z apps/memory_api/services/llm/openai.py                          30     10    67%   20, 51-53, 64-76
2025-11-28T17:41:05.5388363Z apps/memory_api/services/memory_scoring_v2.py                   83     21    75%   46, 235-240, 253, 272, 317-340, 356-368
2025-11-28T17:41:05.5389037Z apps/memory_api/services/ml_service_client.py                  122     99    19%   50-54, 58-59, 63-68, 76-90, 94, 125-130, 138, 159-204, 222-250, 268-294, 312-337, 356-385, 396-409, 418-420
2025-11-28T17:41:05.5389821Z apps/memory_api/services/pii_scrubber.py                        24     17    29%   29-30, 40-45, 51-56, 72-89
2025-11-28T17:41:05.5390387Z apps/memory_api/services/query_analyzer.py                      91     62    32%   128-129, 148-197, 216-241, 257-269, 283-312, 344, 363-383
2025-11-28T17:41:05.5390961Z apps/memory_api/services/rbac_service.py                        35     21    40%   29, 42-56, 90-126, 145-154, 168-179, 224-258
2025-11-28T17:41:05.5391476Z apps/memory_api/services/redis_client.py                         5      2    60%   7-8
2025-11-28T17:41:05.5392194Z apps/memory_api/services/reflection_engine.py                   98     65    34%   89-126, 138-154, 167-178, 207-239, 268-319, 335-361, 373-388, 400-412, 425-441
2025-11-28T17:41:05.5392862Z apps/memory_api/services/reflection_engine_v2.py                75     45    40%   160-219, 234-263, 278-295, 307-318, 342-389, 416-424
2025-11-28T17:41:05.5393562Z apps/memory_api/services/reflection_pipeline.py                194    168    13%   126-128, 132-133, 151-247, 258-290, 306-380, 391-473, 479-559, 571-600, 609-615, 624-633
2025-11-28T17:41:05.5394522Z apps/memory_api/services/rules_engine.py                       202    102    50%   95-108, 137-159, 181-183, 196-197, 226, 232, 238, 245-249, 252-260, 266, 269-272, 277-278, 282, 304, 323, 332-341, 357, 360, 384-412, 486-525, 549-569, 592-600, 606-609, 615-618, 624-629, 639-642, 648-651
2025-11-28T17:41:05.5395334Z apps/memory_api/services/scoring.py                             28     20    29%   15-29, 36, 44-64, 72-79
2025-11-28T17:41:05.5395864Z apps/memory_api/services/temporal_graph.py                     186      9    95%   48, 74, 85, 182, 279, 338-340, 426, 478
2025-11-28T17:41:05.5396390Z apps/memory_api/services/token_estimator.py                      4      3    25%   8-10
2025-11-28T17:41:05.5396882Z apps/memory_api/services/vector_store/__init__.py               16      8    50%   17-28
2025-11-28T17:41:05.5397464Z apps/memory_api/services/vector_store/base.py                    6      0   100%
2025-11-28T17:41:05.5397981Z apps/memory_api/services/vector_store/pgvector_store.py         23     11    52%   17, 25-32, 46-55, 62
2025-11-28T17:41:05.5398585Z apps/memory_api/services/vector_store/qdrant_store.py           64     43    33%   49-66, 70-74, 80-106, 129-160, 170-180, 198-208
2025-11-28T17:41:05.5399203Z apps/memory_api/tasks/__init__.py                                0      0   100%
2025-11-28T17:41:05.5399731Z apps/memory_api/tasks/background_tasks.py                      206    103    50%   18, 47-66, 123-125, 268-278, 289-301, 325-449, 470-498, 509-549
2025-11-28T17:41:05.5400256Z apps/memory_api/tests/__init__.py                                0      0   100%
2025-11-28T17:41:05.5400709Z apps/memory_api/tests/conftest.py                               68     30    56%   16-18, 24, 52-55, 146-163, 183-266, 281
2025-11-28T17:41:05.5401187Z apps/memory_api/tests/test_analytics.py                        121      0   100%
2025-11-28T17:41:05.5401641Z apps/memory_api/tests/test_api_client.py                       155      1    99%   116
2025-11-28T17:41:05.5402103Z apps/memory_api/tests/test_api_e2e.py                           26      4    85%   57, 71, 86, 119
2025-11-28T17:41:05.5402574Z apps/memory_api/tests/test_background_tasks.py                 131      1    99%   334
2025-11-28T17:41:05.5403043Z apps/memory_api/tests/test_dashboard_websocket.py               96      0   100%
2025-11-28T17:41:05.5403491Z apps/memory_api/tests/test_evaluation_suite.py                  79      0   100%
2025-11-28T17:41:05.5403938Z apps/memory_api/tests/test_event_triggers.py                    92      0   100%
2025-11-28T17:41:05.5404381Z apps/memory_api/tests/test_graph_algorithms.py                 178      0   100%
2025-11-28T17:41:05.5404852Z apps/memory_api/tests/test_graph_extraction.py                 136    132     3%   18-418
2025-11-28T17:41:05.5405359Z apps/memory_api/tests/test_graph_extraction_integration.py     132    130     2%   23-441
2025-11-28T17:41:05.5405856Z apps/memory_api/tests/test_hybrid_search.py                    223    220     1%   17-931
2025-11-28T17:41:05.5406306Z apps/memory_api/tests/test_openapi.py                           10      0   100%
2025-11-28T17:41:05.5406755Z apps/memory_api/tests/test_phase2_models.py                    158      1    99%   325
2025-11-28T17:41:05.5407220Z apps/memory_api/tests/test_phase2_plugins.py                   209      1    99%   425
2025-11-28T17:41:05.5407683Z apps/memory_api/tests/test_pii_scrubber.py                      74     72     3%   25-197
2025-11-28T17:41:05.5408284Z apps/memory_api/tests/test_reflection_simple.py                 51     45    12%   20-143
2025-11-28T17:41:05.5408774Z apps/memory_api/tests/test_reflective_flags.py                 152      2    99%   197-198
2025-11-28T17:41:05.5409362Z apps/memory_api/tests/test_semantic_memory.py                   70     65     7%   24-216
2025-11-28T17:41:05.5409830Z apps/memory_api/tests/test_temporal_graph.py                   176      0   100%
2025-11-28T17:41:05.5410282Z apps/memory_api/tests/test_vector_store.py                      75     72     4%   26-212
2025-11-28T17:41:05.5410723Z apps/memory_api/workers/__init__.py                              2      0   100%
2025-11-28T17:41:05.5411303Z apps/memory_api/workers/memory_maintenance.py                  156     69    56%   76-133, 137-141, 207-214, 282-299, 370-453, 526, 539, 562-564, 571-581, 596-619, 623
2025-11-28T17:41:05.5411877Z sdk/python/rae_memory_sdk/__init__.py                            5      0   100%
2025-11-28T17:41:05.5412680Z sdk/python/rae_memory_sdk/client.py                            126     60    52%   48, 70-71, 73-79, 90-91, 93-99, 101-102, 111, 119-123, 129-130, 153-159, 182-189, 201, 222-228, 244-247, 263-268, 294-295, 309, 322, 334, 349-350, 364, 380-383, 391, 395, 422, 438-442, 454-457, 469-475, 486-493, 497, 505-506, 510, 516-517
2025-11-28T17:41:05.5413695Z sdk/python/rae_memory_sdk/decorators.py                         89     18    80%   84-86, 115-116, 133-135, 166-167, 218, 244-246, 250, 286, 337-348, 355
2025-11-28T17:41:05.5414221Z sdk/python/rae_memory_sdk/models.py                             41      0   100%
2025-11-28T17:41:05.5414655Z test_enterprise_features.py                                    107     31    71%   55-56, 125-127, 159, 167-206, 210
2025-11-28T17:41:05.5415051Z tests/__init__.py                                                0      0   100%
2025-11-28T17:41:05.5415391Z tests/api/__init__.py                                            0      0   100%
2025-11-28T17:41:05.5415747Z tests/api/v1/__init__.py                                         0      0   100%
2025-11-28T17:41:05.5416143Z tests/api/v1/test_agent.py                                     108     90    17%   12-53, 65-106, 118-158, 170-206
2025-11-28T17:41:05.5416562Z tests/api/v1/test_cache.py                                      10      0   100%
2025-11-28T17:41:05.5417088Z tests/api/v1/test_governance.py                                130     45    65%   41-47, 73-74, 99-101, 132-139, 164-166, 195-196, 215-221, 241-242, 262-265, 282-284, 331-334
2025-11-28T17:41:05.5417642Z tests/api/v1/test_memory.py                                     98     11    89%   60, 89, 140-142, 191-193, 222-224
2025-11-28T17:41:05.5418140Z tests/api/v1/test_search_hybrid.py                             107     15    86%   75-77, 138-139, 203-204, 268-269, 328-329, 391-392, 534-535
2025-11-28T17:41:05.5418589Z tests/conftest.py                                               53      0   100%
2025-11-28T17:41:05.5419059Z tests/integration/test_graphrag.py                              98     69    30%   41-42, 48, 54, 65-124, 142-168, 182-217, 231-269, 282-324, 338-351, 355
2025-11-28T17:41:05.5419905Z tests/integration/test_lite_profile.py                          86     67    22%   37-72, 80-85, 90-93, 98-116, 122-157, 163-175, 181-187, 192-196, 201-207, 212-224, 230-239, 248-253
2025-11-28T17:41:05.5420571Z tests/integration/test_reflection_flow.py                      107     67    37%   38, 44, 50, 56-61, 67, 73, 94-170, 190-231, 256-298, 361-385, 411-484
2025-11-28T17:41:05.5421218Z tests/llm/test_llm_provider_contract.py                        100     42    58%   30, 39, 47, 52-55, 60-63, 68-71, 84, 108-112, 136-142, 159-163, 178-180, 198-202, 219-220, 249-251, 256
2025-11-28T17:41:05.5421843Z tests/repositories/test_graph_repository.py                    150     17    89%   81-86, 96-98, 258-263, 297-298
2025-11-28T17:41:05.5422309Z tests/services/__init__.py                                       0      0   100%
2025-11-28T17:41:05.5422822Z tests/services/llm/__init__.py                                   0      0   100%
2025-11-28T17:41:05.5423233Z tests/services/llm/test_providers.py                            17      0   100%
2025-11-28T17:41:05.5423681Z tests/services/test_budget_service.py                           19      1    95%   36
2025-11-28T17:41:05.5424135Z tests/services/test_community_detection.py                     106      0   100%
2025-11-28T17:41:05.5424571Z tests/services/test_context_cache.py                            10      0   100%
2025-11-28T17:41:05.5425004Z tests/services/test_entity_resolution.py                        77      0   100%
2025-11-28T17:41:05.5425466Z tests/services/test_reflection_engine.py                        23      9    61%   18-36
2025-11-28T17:41:05.5425887Z ------------------------------------------------------------------------------------------
2025-11-28T17:41:05.5426215Z TOTAL                                                        14237   6062    57%
2025-11-28T17:41:05.5426495Z Coverage HTML written to dir htmlcov
2025-11-28T17:41:05.5426764Z Coverage XML written to file coverage.xml
2025-11-28T17:41:05.5427165Z [32mRequired test coverage of 55% reached. Total coverage: 57.42%
2025-11-28T17:41:05.5427576Z [0m============================= slowest 10 durations =============================
2025-11-28T17:41:05.5428111Z 8.38s call     tests/llm/test_llm_provider_contract.py::test_basic_completion
2025-11-28T17:41:05.5428648Z 8.22s call     tests/llm/test_llm_provider_contract.py::test_provider_contract_hello_world[openai-gpt-3.5-turbo]
2025-11-28T17:41:05.5429272Z 8.22s call     tests/llm/test_llm_provider_contract.py::test_max_tokens
2025-11-28T17:41:05.5429670Z 8.21s call     tests/llm/test_llm_provider_contract.py::test_token_usage
2025-11-28T17:41:05.5430086Z 8.21s call     tests/llm/test_llm_provider_contract.py::test_temperature_control
2025-11-28T17:41:05.5430494Z 8.21s call     tests/llm/test_llm_provider_contract.py::test_json_mode
2025-11-28T17:41:05.5431025Z 1.97s call     apps/memory_api/tests/test_background_tasks.py::TestExtractGraphLazy::test_extract_graph_pool_cleanup
2025-11-28T17:41:05.5431685Z 1.34s call     apps/memory_api/tests/test_background_tasks.py::TestExtractGraphLazy::test_extract_graph_success
2025-11-28T17:41:05.5432220Z 1.20s call     apps/memory_api/tests/test_api_client.py::test_cache_expiration
2025-11-28T17:41:05.5432658Z 0.71s call     apps/memory_api/tests/test_api_client.py::test_retry_exhausted
2025-11-28T17:41:05.5433125Z [36m[1m=========================== short test summary info ============================[0m
2025-11-28T17:41:05.5434586Z [31mFAILED[0m apps/memory_api/tests/test_reflective_flags.py::[1mTestReflectiveMemoryFlags::test_reflective_memory_disabled_no_reflections[0m - AttributeError: 'function' object has no attribute 'assert_not_called'
2025-11-28T17:41:05.5436049Z [31mFAILED[0m apps/memory_api/tests/test_reflective_flags.py::[1mTestDreamingEnabled::test_dreaming_enabled_runs_dreaming[0m - TypeError: 'coroutine' object does not support the asynchronous context manager protocol
2025-11-28T17:41:05.5437716Z [31mFAILED[0m tests/api/v1/test_agent.py::[1mtest_agent_execute_direct[0m - AttributeError: <module 'apps.memory_api.api.v1.agent' from '/home/runner/work/RAE-agentic-memory/RAE-agentic-memory/apps/memory_api/api/v1/agent.py'> does not have the attribute 'get_context_cache'
2025-11-28T17:41:05.5439666Z [31mFAILED[0m tests/api/v1/test_agent.py::[1mtest_agent_execute_with_context[0m - AttributeError: <module 'apps.memory_api.api.v1.agent' from '/home/runner/work/RAE-agentic-memory/RAE-agentic-memory/apps/memory_api/api/v1/agent.py'> does not have the attribute 'get_context_cache'
2025-11-28T17:41:05.5441534Z [31mFAILED[0m tests/api/v1/test_agent.py::[1mtest_agent_execute_with_empty_prompt[0m - AttributeError: <module 'apps.memory_api.api.v1.agent' from '/home/runner/work/RAE-agentic-memory/RAE-agentic-memory/apps/memory_api/api/v1/agent.py'> does not have the attribute 'get_context_cache'
2025-11-28T17:41:05.5443403Z [31mFAILED[0m tests/api/v1/test_agent.py::[1mtest_agent_execute_with_llm_error[0m - AttributeError: <module 'apps.memory_api.api.v1.agent' from '/home/runner/work/RAE-agentic-memory/RAE-agentic-memory/apps/memory_api/api/v1/agent.py'> does not have the attribute 'get_context_cache'
2025-11-28T17:41:05.5444793Z [31mFAILED[0m tests/api/v1/test_governance.py::[1mtest_governance_overview_success[0m - assert 401 == 200
2025-11-28T17:41:05.5445278Z  +  where 401 = <Response [401 Unauthorized]>.status_code
2025-11-28T17:41:05.5445877Z [31mFAILED[0m tests/api/v1/test_governance.py::[1mtest_governance_overview_with_custom_days[0m - assert 401 == 200
2025-11-28T17:41:05.5446365Z  +  where 401 = <Response [401 Unauthorized]>.status_code
2025-11-28T17:41:05.5446915Z [31mFAILED[0m tests/api/v1/test_governance.py::[1mtest_governance_overview_error[0m - assert 401 == 500
2025-11-28T17:41:05.5447366Z  +  where 401 = <Response [401 Unauthorized]>.status_code
2025-11-28T17:41:05.5447937Z [31mFAILED[0m tests/api/v1/test_governance.py::[1mtest_tenant_governance_stats_success[0m - assert 401 == 200
2025-11-28T17:41:05.5448406Z  +  where 401 = <Response [401 Unauthorized]>.status_code
2025-11-28T17:41:05.5448970Z [31mFAILED[0m tests/api/v1/test_governance.py::[1mtest_tenant_governance_stats_no_data[0m - assert 401 == 404
2025-11-28T17:41:05.5449663Z  +  where 401 = <Response [401 Unauthorized]>.status_code
2025-11-28T17:41:05.5450281Z [31mFAILED[0m tests/api/v1/test_governance.py::[1mtest_tenant_governance_stats_with_custom_period[0m - assert 401 == 200
2025-11-28T17:41:05.5450785Z  +  where 401 = <Response [401 Unauthorized]>.status_code
2025-11-28T17:41:05.5451335Z [31mFAILED[0m tests/api/v1/test_governance.py::[1mtest_tenant_budget_status_success[0m - assert 401 == 200
2025-11-28T17:41:05.5451788Z  +  where 401 = <Response [401 Unauthorized]>.status_code
2025-11-28T17:41:05.5452349Z [31mFAILED[0m tests/api/v1/test_governance.py::[1mtest_tenant_budget_status_with_alerts[0m - assert 401 == 200
2025-11-28T17:41:05.5452821Z  +  where 401 = <Response [401 Unauthorized]>.status_code
2025-11-28T17:41:05.5453378Z [31mFAILED[0m tests/api/v1/test_governance.py::[1mtest_tenant_budget_status_zero_usage[0m - assert 401 == 200
2025-11-28T17:41:05.5453837Z  +  where 401 = <Response [401 Unauthorized]>.status_code
2025-11-28T17:41:05.5454375Z [31mFAILED[0m tests/api/v1/test_governance.py::[1mtest_tenant_budget_status_error[0m - assert 401 == 500
2025-11-28T17:41:05.5454823Z  +  where 401 = <Response [401 Unauthorized]>.status_code
2025-11-28T17:41:05.5455392Z [31mFAILED[0m tests/api/v1/test_governance.py::[1mtest_governance_overview_invalid_days[0m - assert 401 == 422
2025-11-28T17:41:05.5455859Z  +  where 401 = <Response [401 Unauthorized]>.status_code
2025-11-28T17:41:05.5456446Z [31mFAILED[0m tests/api/v1/test_governance.py::[1mtest_tenant_governance_stats_invalid_days[0m - assert 401 == 422
2025-11-28T17:41:05.5456929Z  +  where 401 = <Response [401 Unauthorized]>.status_code
2025-11-28T17:41:05.5457543Z [31mFAILED[0m tests/api/v1/test_governance.py::[1mtest_governance_overview_empty_results[0m - assert 401 == 200
2025-11-28T17:41:05.5458043Z  +  where 401 = <Response [401 Unauthorized]>.status_code
2025-11-28T17:41:05.5458565Z [31mFAILED[0m tests/api/v1/test_memory.py::[1mtest_store_memory_success[0m - assert 401 == 200
2025-11-28T17:41:05.5459001Z  +  where 401 = <Response [401 Unauthorized]>.status_code
2025-11-28T17:41:05.5459752Z [31mFAILED[0m tests/api/v1/test_memory.py::[1mtest_query_memory_success[0m - assert 401 == 200
2025-11-28T17:41:05.5460176Z  +  where 401 = <Response [401 Unauthorized]>.status_code
2025-11-28T17:41:05.5460694Z [31mFAILED[0m tests/api/v1/test_memory.py::[1mtest_delete_memory_success[0m - assert 401 == 200
2025-11-28T17:41:05.5461121Z  +  where 401 = <Response [401 Unauthorized]>.status_code
2025-11-28T17:41:05.5461634Z [31mFAILED[0m tests/api/v1/test_memory.py::[1mtest_reflection_stats_success[0m - assert 401 == 200
2025-11-28T17:41:05.5462066Z  +  where 401 = <Response [401 Unauthorized]>.status_code
2025-11-28T17:41:05.5462768Z [31mFAILED[0m tests/api/v1/test_memory.py::[1mtest_store_memory_missing_tenant_header[0m - KeyError: 'detail'
2025-11-28T17:41:05.5463458Z [31mFAILED[0m tests/api/v1/test_memory.py::[1mtest_query_memory_with_filters[0m - assert 401 == 200
2025-11-28T17:41:05.5463888Z  +  where 401 = <Response [401 Unauthorized]>.status_code
2025-11-28T17:41:05.5464437Z [31mFAILED[0m tests/api/v1/test_memory.py::[1mtest_query_memory_with_graph_traversal[0m - assert 401 == 200
2025-11-28T17:41:05.5464891Z  +  where 401 = <Response [401 Unauthorized]>.status_code
2025-11-28T17:41:05.5465406Z [31mFAILED[0m tests/api/v1/test_memory.py::[1mtest_delete_memory_not_found[0m - assert 401 == 200
2025-11-28T17:41:05.5465826Z  +  where 401 = <Response [401 Unauthorized]>.status_code
2025-11-28T17:41:05.5466363Z [31mFAILED[0m tests/api/v1/test_search_hybrid.py::[1mtest_hybrid_search_success[0m - assert 500 == 200
2025-11-28T17:41:05.5466835Z  +  where 500 = <Response [500 Internal Server Error]>.status_code
2025-11-28T17:41:05.5467424Z [31mFAILED[0m tests/api/v1/test_search_hybrid.py::[1mtest_hybrid_search_with_reranking[0m - assert 500 == 200
2025-11-28T17:41:05.5467913Z  +  where 500 = <Response [500 Internal Server Error]>.status_code
2025-11-28T17:41:05.5468489Z [31mFAILED[0m tests/api/v1/test_search_hybrid.py::[1mtest_hybrid_search_with_filters[0m - assert 422 == 200
2025-11-28T17:41:05.5469203Z  +  where 422 = <Response [422 Unprocessable Entity]>.status_code
2025-11-28T17:41:05.5469822Z [31mFAILED[0m tests/api/v1/test_search_hybrid.py::[1mtest_hybrid_search_with_manual_weights[0m - assert 500 == 200
2025-11-28T17:41:05.5470324Z  +  where 500 = <Response [500 Internal Server Error]>.status_code
2025-11-28T17:41:05.5470920Z [31mFAILED[0m tests/api/v1/test_search_hybrid.py::[1mtest_hybrid_search_with_graph_depth[0m - assert 500 == 200
2025-11-28T17:41:05.5471408Z  +  where 500 = <Response [500 Internal Server Error]>.status_code
2025-11-28T17:41:05.5472036Z [31mFAILED[0m tests/api/v1/test_search_hybrid.py::[1mtest_hybrid_search_with_conversation_history[0m - assert 422 == 200
2025-11-28T17:41:05.5472559Z  +  where 422 = <Response [422 Unprocessable Entity]>.status_code
2025-11-28T17:41:05.5473165Z [31mFAILED[0m tests/api/v1/test_search_hybrid.py::[1mtest_hybrid_search_empty_query[0m - assert 422 in [200, 400]
2025-11-28T17:41:05.5473666Z  +  where 422 = <Response [422 Unprocessable Entity]>.status_code
2025-11-28T17:41:05.5474274Z [31mFAILED[0m tests/api/v1/test_search_hybrid.py::[1mtest_hybrid_search_all_strategies_disabled[0m - assert 500 == 200
2025-11-28T17:41:05.5474789Z  +  where 500 = <Response [500 Internal Server Error]>.status_code
2025-11-28T17:41:05.5476336Z [31mFAILED[0m tests/llm/test_llm_provider_contract.py::[1mtest_basic_completion[0m - apps.llm.models.llm_error.LLMAuthError: OpenAI authentication failed: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-test-key. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'code': 'invalid_api_key', 'param': None}}
2025-11-28T17:41:06.3797925Z [31mFAILED[0m tests/llm/test_llm_provider_contract.py::[1mtest_json_mode[0m - apps.llm.models.llm_error.LLMAuthError: OpenAI authentication failed: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-test-key. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'code': 'invalid_api_key', 'param': None}}
2025-11-28T17:41:06.3802247Z [31mFAILED[0m tests/llm/test_llm_provider_contract.py::[1mtest_streaming[0m - apps.llm.models.llm_error.LLMAuthError: OpenAI authentication failed: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-test-key. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'code': 'invalid_api_key', 'param': None}}
2025-11-28T17:41:06.3805951Z [31mFAILED[0m tests/llm/test_llm_provider_contract.py::[1mtest_token_usage[0m - apps.llm.models.llm_error.LLMAuthError: OpenAI authentication failed: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-test-key. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'code': 'invalid_api_key', 'param': None}}
2025-11-28T17:41:06.3810332Z [31mFAILED[0m tests/llm/test_llm_provider_contract.py::[1mtest_temperature_control[0m - apps.llm.models.llm_error.LLMAuthError: OpenAI authentication failed: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-test-key. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'code': 'invalid_api_key', 'param': None}}
2025-11-28T17:41:06.3814077Z [31mFAILED[0m tests/llm/test_llm_provider_contract.py::[1mtest_max_tokens[0m - apps.llm.models.llm_error.LLMAuthError: OpenAI authentication failed: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-test-key. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'code': 'invalid_api_key', 'param': None}}
2025-11-28T17:41:06.3816708Z [31mFAILED[0m tests/llm/test_llm_provider_contract.py::[1mtest_provider_contract_hello_world[openai-gpt-3.5-turbo][0m - apps.llm.models.llm_error.LLMAuthError: OpenAI authentication failed: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-test-key. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'code': 'invalid_api_key', 'param': None}}
2025-11-28T17:41:06.3818722Z [31mFAILED[0m tests/repositories/test_graph_repository.py::[1mtest_merge_node_edges[0m - TypeError: 'coroutine' object does not support the asynchronous context manager protocol
2025-11-28T17:41:06.3820093Z [31mFAILED[0m tests/repositories/test_graph_repository.py::[1mtest_store_graph_triples[0m - TypeError: 'coroutine' object does not support the asynchronous context manager protocol
2025-11-28T17:41:06.3821206Z [31mFAILED[0m tests/services/test_budget_service.py::[1mtest_check_budget[0m - TypeError: check_budget() missing 1 required positional argument: 'tokens'
2025-11-28T17:41:06.3822225Z [31mFAILED[0m tests/services/test_budget_service.py::[1mtest_check_budget_fail[0m - TypeError: check_budget() missing 1 required positional argument: 'tokens'
2025-11-28T17:41:06.3823359Z [31mFAILED[0m tests/services/test_reflection_engine.py::[1mtest_reflection_flow[0m - TypeError: GraphExtractionService.__init__() missing 1 required positional argument: 'graph_repo'
2025-11-28T17:41:06.3824339Z [31mFAILED[0m test_enterprise_features.py::[1mtest_pydantic_models[0m - AssertionError: assert 'entity1' == 'Entity1'
2025-11-28T17:41:06.3824788Z   
2025-11-28T17:41:06.3825015Z   [0m[91m- Entity1[39;49;00m[90m[39;49;00m
2025-11-28T17:41:06.3825299Z   ? ^[90m[39;49;00m
2025-11-28T17:41:06.3825532Z   [92m+ entity1[39;49;00m[90m[39;49;00m
2025-11-28T17:41:06.3825790Z   ? ^[90m[39;49;00m
2025-11-28T17:41:06.3826557Z [31mERROR[0m tests/integration/test_graphrag.py::[1mtest_graph_extraction_basic[0m - asyncpg.exceptions.InvalidPasswordError: password authentication failed for user "memory"
2025-11-28T17:41:06.3827741Z [31mERROR[0m tests/integration/test_graphrag.py::[1mtest_graph_storage[0m - asyncpg.exceptions.InvalidPasswordError: password authentication failed for user "memory"
2025-11-28T17:41:06.3828884Z [31mERROR[0m tests/integration/test_graphrag.py::[1mtest_hybrid_search[0m - asyncpg.exceptions.InvalidPasswordError: password authentication failed for user "memory"
2025-11-28T17:41:06.3830162Z [31mERROR[0m tests/integration/test_graphrag.py::[1mtest_graph_traversal_depth[0m - asyncpg.exceptions.InvalidPasswordError: password authentication failed for user "memory"
2025-11-28T17:41:06.3831371Z [31mERROR[0m tests/integration/test_graphrag.py::[1mtest_hierarchical_reflection[0m - asyncpg.exceptions.InvalidPasswordError: password authentication failed for user "memory"
2025-11-28T17:41:06.3832460Z [31mERROR[0m tests/integration/test_reflection_flow.py::[1mtest_generate_reflection_from_failure[0m
2025-11-28T17:41:06.3833145Z [31mERROR[0m tests/integration/test_reflection_flow.py::[1mtest_generate_reflection_from_success[0m
2025-11-28T17:41:06.3833830Z [31mERROR[0m tests/integration/test_reflection_flow.py::[1mtest_reflection_retrieval_in_context[0m
2025-11-28T17:41:06.3834517Z [31mERROR[0m tests/integration/test_reflection_flow.py::[1mtest_inject_reflections_into_prompt[0m
2025-11-28T17:41:06.3835179Z [31mERROR[0m tests/integration/test_reflection_flow.py::[1mtest_end_to_end_reflection_flow[0m
2025-11-28T17:41:06.3835992Z [31m= [31m[1m48 failed[0m, [32m202 passed[0m, [33m12 skipped[0m, [33m11 deselected[0m, [33m8 warnings[0m, [31m[1m10 errors[0m[31m in 73.02s (0:01:13)[0m[31m =[0m
2025-11-28T17:41:07.1780399Z ##[error]Process completed with exit code 1.
